{"version":3,"sources":["../../../../../../packages/react-virtualizer/src/components/Virtualizer/VirtualizerExample.component-browser-spec.tsx"],"sourcesContent":["import * as React from 'react';\nimport {\n  Combobox,\n  FluentProvider,\n  Option,\n  makeStyles,\n  useId,\n  useMergedRefs,\n  useTimeout,\n  webLightTheme,\n} from '@fluentui/react-components';\nimport { Virtualizer } from './Virtualizer';\nimport { useStaticVirtualizerMeasure } from '../../hooks/useVirtualizerMeasure';\n\nconst useStyles = makeStyles({\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    overflowY: 'auto',\n    width: '100%',\n    height: '500px',\n    border: '1px solid #ccc',\n  },\n  child: {\n    height: '50px',\n    lineHeight: '50px',\n    width: '100%',\n    borderBottom: '1px solid #eee',\n    padding: '0 10px',\n  },\n  keyTestContainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    overflowY: 'auto',\n    width: '100%',\n    height: '400px',\n    border: '1px solid #ccc',\n  },\n  item: {\n    height: '50px',\n    lineHeight: '50px',\n    padding: '0 10px',\n    borderBottom: '1px solid #eee',\n  },\n  button: {\n    marginBottom: '10px',\n    padding: '8px 16px',\n  },\n});\n\ninterface VirtualizerExampleProps {\n  numItems?: number;\n  itemSize?: number;\n}\n\nexport interface VirtualizerItem {\n  id: string;\n  value: number;\n}\n\nexport const VirtualizerExample: React.FC<VirtualizerExampleProps> = ({\n  numItems = 1000,\n  itemSize = 50,\n}) => {\n  const styles = useStyles();\n\n  const [items, setItems] = React.useState<VirtualizerItem[]>(\n    Array.from({ length: numItems }, (_, i) => ({\n      id: `item-${i}`,\n      value: i,\n    }))\n  );\n\n  const handleAddItem = () => {\n    const nextId = items.length;\n    const newItem: VirtualizerItem = {\n      id: `item-${nextId}`,\n      value: nextId,\n    };\n    setItems((prev) => [newItem, ...prev]); // Prepend to beginning\n  };\n\n  const handleAddMultipleItems = () => {\n    const newItems: VirtualizerItem[] = [];\n    const nextId = items.length;\n    for (let i = 0; i < 10; i++) {\n      newItems.push({\n        id: `item-${nextId + i}`,\n        value: nextId + i,\n      });\n    }\n    setItems((prev) => [...newItems, ...prev]); // Prepend multiple items\n  };\n\n  const {\n    virtualizerLength,\n    bufferItems,\n    bufferSize,\n    scrollRef,\n    containerSizeRef,\n  } = useStaticVirtualizerMeasure({\n    defaultItemSize: itemSize,\n  });\n\n  return (\n    <div>\n      <button\n        className={styles.button}\n        onClick={handleAddItem}\n        data-testid=\"add-item-button\"\n      >\n        Add Item\n      </button>\n      <button\n        className={styles.button}\n        onClick={handleAddMultipleItems}\n        data-testid=\"add-multiple-button\"\n      >\n        Add 10 Items\n      </button>\n      <div\n        className={styles.keyTestContainer}\n        role=\"list\"\n        ref={scrollRef}\n        data-testid=\"scroll-container\"\n        aria-label=\"Virtualizer Example\"\n      >\n        <Virtualizer\n          numItems={items.length}\n          virtualizerLength={virtualizerLength}\n          bufferItems={bufferItems}\n          bufferSize={bufferSize}\n          itemSize={50}\n          containerSizeRef={containerSizeRef}\n        >\n          {(index) => {\n            const item = items[index];\n            return (\n              <div\n                key={item.id} // Unique key based on item ID, not index\n                role=\"listitem\"\n                className={styles.item}\n                data-testid={item.id}\n                data-value={item.value}\n                aria-posinset={index + 1}\n                aria-setsize={items.length}\n              >\n                Item {item.value}\n              </div>\n            );\n          }}\n        </Virtualizer>\n      </div>\n    </div>\n  );\n};\n\nconst useComboboxStyles = makeStyles({\n  listbox: {\n    // maxHeight will be applied only positioning autoSize set.\n    maxHeight: '250px',\n  },\n  option: {\n    height: '32px',\n  },\n});\n\nexport const VirtualizerComboboxExample = () => {\n  const comboId = useId('combobox');\n\n  //This should include the item height (32px) and account for rowGap (2px)\n  const itemHeight = 32;\n  const rowGap = 2;\n\n  const [options] = React.useState([\n    { id: 0, name: 'a' },\n    { id: 1, name: 'b' },\n    { id: 2, name: 'c' },\n    { id: 3, name: 'd' },\n    { id: 4, name: 'e' },\n    { id: 5, name: 'f' },\n    { id: 6, name: 'g' },\n    { id: 7, name: 'h' },\n    { id: 8, name: 'i' },\n    { id: 9, name: 'j' },\n    { id: 10, name: 'k' },\n  ]);\n\n  const {\n    virtualizerLength,\n    bufferItems,\n    bufferSize,\n    scrollRef,\n    containerSizeRef,\n  } = useStaticVirtualizerMeasure({\n    defaultItemSize: itemHeight,\n    direction: 'vertical',\n    // We want at least 10 additional items on each side of visible items for page up/down (+ 1 buffer)\n    bufferItems: 4,\n    // We need to recalculate index when at least 10 items (+1px) from the bottom or top for page up/down\n    bufferSize: itemHeight * 3 + 1,\n  });\n  const selectedIndex = React.useRef(0);\n\n  const styles = useComboboxStyles();\n  const mergedRefs = useMergedRefs(scrollRef);\n  // Scroll timer required to post scrollTo on stack post-open state change\n  const [setScrollTimer, clearScrollTimer] = useTimeout();\n\n  return (\n    <FluentProvider theme={webLightTheme}>\n      <label htmlFor={`${comboId}`}>Medium</label>\n      <Combobox\n        id={`${comboId}`}\n        placeholder=\"Select a number\"\n        positioning={{ autoSize: 'width' }}\n        listbox={{ ref: mergedRefs, className: styles.listbox }}\n        onOpenChange={(e, data) => {\n          clearScrollTimer();\n          if (data.open) {\n            setScrollTimer(() => {\n              mergedRefs.current?.scrollTo({\n                top: (itemHeight + rowGap) * selectedIndex.current,\n              });\n            }, 0);\n          }\n        }}\n        onOptionSelect={(_, data) => {\n          if (data.optionValue) {\n            selectedIndex.current = parseInt(data.optionValue, 10);\n          }\n        }}\n        inlinePopup\n      >\n        <Virtualizer\n          numItems={options.length}\n          virtualizerLength={virtualizerLength}\n          bufferItems={bufferItems}\n          bufferSize={bufferSize}\n          itemSize={itemHeight}\n          containerSizeRef={containerSizeRef}\n          gap={rowGap}\n        >\n          {(index: number) => {\n            return (\n              <Option\n                className={styles.option}\n                aria-posinset={index}\n                aria-setsize={options.length}\n                key={`item-${index}`}\n                value={index.toString()}\n                data-testid={`option-${index}`}\n              >\n                {options[index].name}\n              </Option>\n            );\n          }}\n        </Virtualizer>\n      </Combobox>\n    </FluentProvider>\n  );\n};\n"],"names":["VirtualizerComboboxExample","VirtualizerExample","useStyles","makeStyles","container","display","flexDirection","overflowY","width","height","border","child","lineHeight","borderBottom","padding","keyTestContainer","item","button","marginBottom","numItems","itemSize","styles","items","setItems","React","useState","Array","from","length","_","i","id","value","handleAddItem","nextId","newItem","prev","handleAddMultipleItems","newItems","push","virtualizerLength","bufferItems","bufferSize","scrollRef","containerSizeRef","useStaticVirtualizerMeasure","defaultItemSize","div","className","onClick","data-testid","role","ref","aria-label","Virtualizer","index","key","data-value","aria-posinset","aria-setsize","useComboboxStyles","listbox","maxHeight","option","comboId","useId","itemHeight","rowGap","options","name","direction","selectedIndex","useRef","mergedRefs","useMergedRefs","setScrollTimer","clearScrollTimer","useTimeout","FluentProvider","theme","webLightTheme","label","htmlFor","Combobox","placeholder","positioning","autoSize","onOpenChange","e","data","open","current","scrollTo","top","onOptionSelect","optionValue","parseInt","inlinePopup","gap","Option","toString"],"mappings":"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"}