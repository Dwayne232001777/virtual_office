{"version":3,"sources":["../../../../../../packages/react-virtualizer/src/components/Virtualizer/VirtualizerExample.component-browser-spec.tsx"],"sourcesContent":["import * as React from 'react';\nimport {\n  Combobox,\n  FluentProvider,\n  Option,\n  makeStyles,\n  useId,\n  useMergedRefs,\n  useTimeout,\n  webLightTheme,\n} from '@fluentui/react-components';\nimport { Virtualizer } from './Virtualizer';\nimport { useStaticVirtualizerMeasure } from '../../hooks/useVirtualizerMeasure';\n\nconst useStyles = makeStyles({\n  container: {\n    display: 'flex',\n    flexDirection: 'column',\n    overflowY: 'auto',\n    width: '100%',\n    height: '500px',\n    border: '1px solid #ccc',\n  },\n  child: {\n    height: '50px',\n    lineHeight: '50px',\n    width: '100%',\n    borderBottom: '1px solid #eee',\n    padding: '0 10px',\n  },\n  keyTestContainer: {\n    display: 'flex',\n    flexDirection: 'column',\n    overflowY: 'auto',\n    width: '100%',\n    height: '400px',\n    border: '1px solid #ccc',\n  },\n  item: {\n    height: '50px',\n    lineHeight: '50px',\n    padding: '0 10px',\n    borderBottom: '1px solid #eee',\n  },\n  button: {\n    marginBottom: '10px',\n    padding: '8px 16px',\n  },\n});\n\ninterface VirtualizerExampleProps {\n  numItems?: number;\n  itemSize?: number;\n}\n\nexport interface VirtualizerItem {\n  id: string;\n  value: number;\n}\n\nexport const VirtualizerExample: React.FC<VirtualizerExampleProps> = ({\n  numItems = 1000,\n  itemSize = 50,\n}) => {\n  const styles = useStyles();\n\n  const [items, setItems] = React.useState<VirtualizerItem[]>(\n    Array.from({ length: numItems }, (_, i) => ({\n      id: `item-${i}`,\n      value: i,\n    }))\n  );\n\n  const handleAddItem = () => {\n    const nextId = items.length;\n    const newItem: VirtualizerItem = {\n      id: `item-${nextId}`,\n      value: nextId,\n    };\n    setItems((prev) => [newItem, ...prev]); // Prepend to beginning\n  };\n\n  const handleAddMultipleItems = () => {\n    const newItems: VirtualizerItem[] = [];\n    const nextId = items.length;\n    for (let i = 0; i < 10; i++) {\n      newItems.push({\n        id: `item-${nextId + i}`,\n        value: nextId + i,\n      });\n    }\n    setItems((prev) => [...newItems, ...prev]); // Prepend multiple items\n  };\n\n  const {\n    virtualizerLength,\n    bufferItems,\n    bufferSize,\n    scrollRef,\n    containerSizeRef,\n  } = useStaticVirtualizerMeasure({\n    defaultItemSize: itemSize,\n  });\n\n  return (\n    <div>\n      <button\n        className={styles.button}\n        onClick={handleAddItem}\n        data-testid=\"add-item-button\"\n      >\n        Add Item\n      </button>\n      <button\n        className={styles.button}\n        onClick={handleAddMultipleItems}\n        data-testid=\"add-multiple-button\"\n      >\n        Add 10 Items\n      </button>\n      <div\n        className={styles.keyTestContainer}\n        role=\"list\"\n        ref={scrollRef}\n        data-testid=\"scroll-container\"\n        aria-label=\"Virtualizer Example\"\n      >\n        <Virtualizer\n          numItems={items.length}\n          virtualizerLength={virtualizerLength}\n          bufferItems={bufferItems}\n          bufferSize={bufferSize}\n          itemSize={50}\n          containerSizeRef={containerSizeRef}\n        >\n          {(index) => {\n            const item = items[index];\n            return (\n              <div\n                key={item.id} // Unique key based on item ID, not index\n                role=\"listitem\"\n                className={styles.item}\n                data-testid={item.id}\n                data-value={item.value}\n                aria-posinset={index + 1}\n                aria-setsize={items.length}\n              >\n                Item {item.value}\n              </div>\n            );\n          }}\n        </Virtualizer>\n      </div>\n    </div>\n  );\n};\n\nconst useComboboxStyles = makeStyles({\n  listbox: {\n    // maxHeight will be applied only positioning autoSize set.\n    maxHeight: '250px',\n  },\n  option: {\n    height: '32px',\n  },\n});\n\nexport const VirtualizerComboboxExample = () => {\n  const comboId = useId('combobox');\n\n  //This should include the item height (32px) and account for rowGap (2px)\n  const itemHeight = 32;\n  const rowGap = 2;\n\n  const [options] = React.useState([\n    { id: 0, name: 'a' },\n    { id: 1, name: 'b' },\n    { id: 2, name: 'c' },\n    { id: 3, name: 'd' },\n    { id: 4, name: 'e' },\n    { id: 5, name: 'f' },\n    { id: 6, name: 'g' },\n    { id: 7, name: 'h' },\n    { id: 8, name: 'i' },\n    { id: 9, name: 'j' },\n    { id: 10, name: 'k' },\n  ]);\n\n  const {\n    virtualizerLength,\n    bufferItems,\n    bufferSize,\n    scrollRef,\n    containerSizeRef,\n  } = useStaticVirtualizerMeasure({\n    defaultItemSize: itemHeight,\n    direction: 'vertical',\n    // We want at least 10 additional items on each side of visible items for page up/down (+ 1 buffer)\n    bufferItems: 4,\n    // We need to recalculate index when at least 10 items (+1px) from the bottom or top for page up/down\n    bufferSize: itemHeight * 3 + 1,\n  });\n  const selectedIndex = React.useRef(0);\n\n  const styles = useComboboxStyles();\n  const mergedRefs = useMergedRefs(scrollRef);\n  // Scroll timer required to post scrollTo on stack post-open state change\n  const [setScrollTimer, clearScrollTimer] = useTimeout();\n\n  return (\n    <FluentProvider theme={webLightTheme}>\n      <label htmlFor={`${comboId}`}>Medium</label>\n      <Combobox\n        id={`${comboId}`}\n        placeholder=\"Select a number\"\n        positioning={{ autoSize: 'width' }}\n        listbox={{ ref: mergedRefs, className: styles.listbox }}\n        onOpenChange={(e, data) => {\n          clearScrollTimer();\n          if (data.open) {\n            setScrollTimer(() => {\n              mergedRefs.current?.scrollTo({\n                top: (itemHeight + rowGap) * selectedIndex.current,\n              });\n            }, 0);\n          }\n        }}\n        onOptionSelect={(_, data) => {\n          if (data.optionValue) {\n            selectedIndex.current = parseInt(data.optionValue, 10);\n          }\n        }}\n        inlinePopup\n      >\n        <Virtualizer\n          numItems={options.length}\n          virtualizerLength={virtualizerLength}\n          bufferItems={bufferItems}\n          bufferSize={bufferSize}\n          itemSize={itemHeight}\n          containerSizeRef={containerSizeRef}\n          gap={rowGap}\n        >\n          {(index: number) => {\n            return (\n              <Option\n                className={styles.option}\n                aria-posinset={index}\n                aria-setsize={options.length}\n                key={`item-${index}`}\n                value={index.toString()}\n                data-testid={`option-${index}`}\n              >\n                {options[index].name}\n              </Option>\n            );\n          }}\n        </Virtualizer>\n      </Combobox>\n    </FluentProvider>\n  );\n};\n"],"names":["React","Combobox","FluentProvider","Option","makeStyles","useId","useMergedRefs","useTimeout","webLightTheme","Virtualizer","useStaticVirtualizerMeasure","useStyles","container","display","flexDirection","overflowY","width","height","border","child","lineHeight","borderBottom","padding","keyTestContainer","item","button","marginBottom","VirtualizerExample","numItems","itemSize","styles","items","setItems","useState","Array","from","length","_","i","id","value","handleAddItem","nextId","newItem","prev","handleAddMultipleItems","newItems","push","virtualizerLength","bufferItems","bufferSize","scrollRef","containerSizeRef","defaultItemSize","div","className","onClick","data-testid","role","ref","aria-label","index","key","data-value","aria-posinset","aria-setsize","useComboboxStyles","listbox","maxHeight","option","VirtualizerComboboxExample","comboId","itemHeight","rowGap","options","name","direction","selectedIndex","useRef","mergedRefs","setScrollTimer","clearScrollTimer","theme","label","htmlFor","placeholder","positioning","autoSize","onOpenChange","e","data","open","current","scrollTo","top","onOptionSelect","optionValue","parseInt","inlinePopup","gap","toString"],"mappings":"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"}