{
  "version": 3,
  "sources": ["../../../dev/core/src/FlowGraph/Blocks/Execution/ControlFlow/flowGraphCancelDelayBlock.ts"],
  "sourcesContent": ["import { RegisterClass } from \"core/Misc/typeStore\";\nimport type { AdvancedTimer } from \"../../../../Misc/timer\";\nimport type { IFlowGraphBlockConfiguration } from \"../../../flowGraphBlock\";\nimport type { FlowGraphContext } from \"../../../flowGraphContext\";\nimport type { FlowGraphDataConnection } from \"../../../flowGraphDataConnection\";\nimport { FlowGraphExecutionBlockWithOutSignal } from \"../../../flowGraphExecutionBlockWithOutSignal\";\nimport { RichTypeFlowGraphInteger } from \"../../../flowGraphRichTypes\";\nimport type { FlowGraphSignalConnection } from \"../../../flowGraphSignalConnection\";\nimport { FlowGraphBlockNames } from \"../../flowGraphBlockNames\";\nimport type { FlowGraphInteger } from \"core/FlowGraph/CustomTypes/flowGraphInteger\";\nimport { getNumericValue } from \"core/FlowGraph/utils\";\n\n/**\n * This block cancels a delay that was previously scheduled.\n */\nexport class FlowGraphCancelDelayBlock extends FlowGraphExecutionBlockWithOutSignal {\n    /**\n     * Input connection: The index value of the scheduled activation to be cancelled.\n     */\n    public readonly delayIndex: FlowGraphDataConnection<FlowGraphInteger>;\n\n    constructor(config?: IFlowGraphBlockConfiguration) {\n        super(config);\n        this.delayIndex = this.registerDataInput(\"delayIndex\", RichTypeFlowGraphInteger);\n    }\n\n    public _execute(context: FlowGraphContext, _callingSignal: FlowGraphSignalConnection): void {\n        const delayIndex = getNumericValue(this.delayIndex.getValue(context));\n        if (delayIndex <= 0 || isNaN(delayIndex) || !isFinite(delayIndex)) {\n            return this._reportError(context, \"Invalid delay index\");\n        }\n        const timers = context._getGlobalContextVariable(\"pendingDelays\", [] as AdvancedTimer[]);\n        const timer = timers[delayIndex];\n        if (timer) {\n            timer.dispose();\n            // not removing it from the array. Disposing it will clear all of its resources\n        }\n        // activate the out output flow\n        this.out._activateSignal(context);\n    }\n\n    public override getClassName(): string {\n        return FlowGraphBlockNames.CancelDelay;\n    }\n}\n\nRegisterClass(FlowGraphBlockNames.CancelDelay, FlowGraphCancelDelayBlock);\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;AAAA,IAea;AAfb;;;AAKA;AACA;AAIA;AAKM,IAAO,4BAAP,cAAyC,qCAAoC;MAM/E,YAAY,QAAqC;AAC7C,cAAM,MAAM;AACZ,aAAK,aAAa,KAAK,kBAAkB,cAAc,wBAAwB;MACnF;MAEO,SAAS,SAA2B,gBAAyC;AAChF,cAAM,aAAa,gBAAgB,KAAK,WAAW,SAAS,OAAO,CAAC;AACpE,YAAI,cAAc,KAAK,MAAM,UAAU,KAAK,CAAC,SAAS,UAAU,GAAG;AAC/D,iBAAO,KAAK,aAAa,SAAS,qBAAqB;QAC3D;AACA,cAAM,SAAS,QAAQ,0BAA0B,iBAAiB,CAAA,CAAqB;AACvF,cAAM,QAAQ,OAAO,UAAU;AAC/B,YAAI,OAAO;AACP,gBAAM,QAAO;QAEjB;AAEA,aAAK,IAAI,gBAAgB,OAAO;MACpC;MAEgB,eAAY;AACxB,eAAA;MACJ;;AAGJ,kBAAa,6BAAkC,yBAAyB;;;",
  "names": []
}
