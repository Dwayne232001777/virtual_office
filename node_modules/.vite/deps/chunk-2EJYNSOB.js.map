{
  "version": 3,
  "sources": ["../../../dev/core/src/Gamepads/gamepad.ts", "../../../dev/core/src/Cameras/Inputs/arcRotateCameraGamepadInput.ts", "../../../dev/core/src/Cameras/Inputs/flyCameraKeyboardInput.ts", "../../../dev/core/src/Cameras/Inputs/flyCameraMouseInput.ts", "../../../dev/core/src/Cameras/Inputs/freeCameraGamepadInput.ts", "../../../dev/core/src/Cameras/touchCamera.ts", "../../../dev/core/src/Cameras/flyCameraInputsManager.ts", "../../../dev/core/src/Cameras/flyCamera.ts", "../../../dev/core/src/Gamepads/xboxGamepad.ts", "../../../dev/core/src/Gamepads/dualShockGamepad.ts", "../../../dev/core/src/Gamepads/gamepadManager.ts", "../../../dev/core/src/Gamepads/gamepadSceneComponent.ts", "../../../dev/core/src/Cameras/universalCamera.ts", "../../../dev/core/src/FrameGraph/Node/Types/nodeRenderGraphTypes.ts", "../../../dev/core/src/FrameGraph/Node/nodeRenderGraphBlockConnectionPoint.ts", "../../../dev/core/src/FrameGraph/Node/nodeRenderGraphBlock.ts", "../../../dev/core/src/FrameGraph/Tasks/Texture/copyToBackbufferColorTask.ts", "../../../dev/core/src/FrameGraph/Node/Blocks/outputBlock.ts", "../../../dev/core/src/FrameGraph/Node/Blocks/inputBlock.ts", "../../../dev/core/src/FrameGraph/Tasks/Texture/clearTextureTask.ts", "../../../dev/core/src/FrameGraph/Node/Blocks/Textures/clearBlock.ts", "../../../dev/core/src/FrameGraph/Node/nodeRenderGraphConnectionPointCustomObject.ts", "../../../dev/core/src/FrameGraph/Node/Blocks/Rendering/baseObjectRendererBlock.ts", "../../../dev/core/src/FrameGraph/Node/Blocks/Rendering/objectRendererBlock.ts", "../../../dev/core/src/FrameGraph/Node/nodeRenderGraphBuildState.ts", "../../../dev/core/src/FrameGraph/Tasks/Misc/cullObjectsTask.ts", "../../../dev/core/src/FrameGraph/Node/Blocks/cullObjectsBlock.ts", "../../../dev/core/src/FrameGraph/Node/nodeRenderGraph.ts", "../../../dev/core/src/Materials/PBR/pbrMaterial.ts", "../../../dev/core/src/Materials/uniformBufferEffectCommonAccessor.ts", "../../../dev/core/src/Shaders/gpuUpdateParticles.fragment.ts", "../../../dev/core/src/Shaders/gpuUpdateParticles.vertex.ts", "../../../dev/core/src/Particles/webgl2ParticleSystem.ts"],
  "sourcesContent": ["import { Observable } from \"../Misc/observable\";\r\n\r\n/**\r\n * Represents a gamepad control stick position\r\n */\r\nexport class StickValues {\r\n    /**\r\n     * Initializes the gamepad x and y control stick values\r\n     * @param x The x component of the gamepad control stick value\r\n     * @param y The y component of the gamepad control stick value\r\n     */\r\n    constructor(\r\n        /**\r\n         * The x component of the control stick\r\n         */\r\n        public x: number,\r\n        /**\r\n         * The y component of the control stick\r\n         */\r\n        public y: number\r\n    ) {}\r\n}\r\n\r\n/**\r\n * An interface which manages callbacks for gamepad button changes\r\n */\r\n// eslint-disable-next-line @typescript-eslint/naming-convention\r\nexport interface GamepadButtonChanges {\r\n    /**\r\n     * Called when a gamepad has been changed\r\n     */\r\n    changed: boolean;\r\n    /**\r\n     * Called when a gamepad press event has been triggered\r\n     */\r\n    pressChanged: boolean;\r\n    /**\r\n     * Called when a touch event has been triggered\r\n     */\r\n    touchChanged: boolean;\r\n    /**\r\n     * Called when a value has changed\r\n     */\r\n    valueChanged: boolean;\r\n}\r\n\r\n/**\r\n * Represents a gamepad\r\n */\r\nexport class Gamepad {\r\n    /**\r\n     * Specifies what type of gamepad this represents\r\n     */\r\n    public type: number;\r\n\r\n    private _leftStick: StickValues = { x: 0, y: 0 };\r\n    private _rightStick: StickValues = { x: 0, y: 0 };\r\n\r\n    /** @internal */\r\n    public _isConnected = true;\r\n\r\n    private _leftStickAxisX: number;\r\n    private _leftStickAxisY: number;\r\n    private _rightStickAxisX: number;\r\n    private _rightStickAxisY: number;\r\n\r\n    /**\r\n     * Triggered when the left control stick has been changed\r\n     */\r\n    private _onleftstickchanged: (values: StickValues) => void;\r\n\r\n    /**\r\n     * Triggered when the right control stick has been changed\r\n     */\r\n    private _onrightstickchanged: (values: StickValues) => void;\r\n\r\n    /**\r\n     * Represents a gamepad controller\r\n     */\r\n    public static GAMEPAD = 0;\r\n    /**\r\n     * Represents a generic controller\r\n     */\r\n    public static GENERIC = 1;\r\n    /**\r\n     * Represents an XBox controller\r\n     */\r\n    public static XBOX = 2;\r\n    /**\r\n     * Represents a pose-enabled controller\r\n     */\r\n    public static POSE_ENABLED = 3;\r\n    /**\r\n     * Represents an Dual Shock controller\r\n     */\r\n    public static DUALSHOCK = 4;\r\n\r\n    /**\r\n     * Specifies whether the left control stick should be Y-inverted\r\n     */\r\n    protected _invertLeftStickY: boolean = false;\r\n\r\n    /**\r\n     * Specifies if the gamepad has been connected\r\n     */\r\n    public get isConnected(): boolean {\r\n        return this._isConnected;\r\n    }\r\n\r\n    /**\r\n     * Initializes the gamepad\r\n     * @param id The id of the gamepad\r\n     * @param index The index of the gamepad\r\n     * @param browserGamepad The browser gamepad\r\n     * @param leftStickX The x component of the left joystick\r\n     * @param leftStickY The y component of the left joystick\r\n     * @param rightStickX The x component of the right joystick\r\n     * @param rightStickY The y component of the right joystick\r\n     */\r\n    constructor(\r\n        /**\r\n         * The id of the gamepad\r\n         */\r\n        public id: string,\r\n        /**\r\n         * The index of the gamepad\r\n         */\r\n        public index: number,\r\n        /**\r\n         * The browser gamepad\r\n         */\r\n        public browserGamepad: any,\r\n        leftStickX: number = 0,\r\n        leftStickY: number = 1,\r\n        rightStickX: number = 2,\r\n        rightStickY: number = 3\r\n    ) {\r\n        this.type = Gamepad.GAMEPAD;\r\n        this._leftStickAxisX = leftStickX;\r\n        this._leftStickAxisY = leftStickY;\r\n        this._rightStickAxisX = rightStickX;\r\n        this._rightStickAxisY = rightStickY;\r\n        if (this.browserGamepad.axes.length >= 2) {\r\n            this._leftStick = { x: this.browserGamepad.axes[this._leftStickAxisX], y: this.browserGamepad.axes[this._leftStickAxisY] };\r\n        }\r\n        if (this.browserGamepad.axes.length >= 4) {\r\n            this._rightStick = { x: this.browserGamepad.axes[this._rightStickAxisX], y: this.browserGamepad.axes[this._rightStickAxisY] };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Callback triggered when the left joystick has changed\r\n     * @param callback callback to trigger\r\n     */\r\n    public onleftstickchanged(callback: (values: StickValues) => void) {\r\n        this._onleftstickchanged = callback;\r\n    }\r\n\r\n    /**\r\n     * Callback triggered when the right joystick has changed\r\n     * @param callback callback to trigger\r\n     */\r\n    public onrightstickchanged(callback: (values: StickValues) => void) {\r\n        this._onrightstickchanged = callback;\r\n    }\r\n\r\n    /**\r\n     * Gets the left joystick\r\n     */\r\n    public get leftStick(): StickValues {\r\n        return this._leftStick;\r\n    }\r\n    /**\r\n     * Sets the left joystick values\r\n     */\r\n    public set leftStick(newValues: StickValues) {\r\n        if (this._onleftstickchanged && (this._leftStick.x !== newValues.x || this._leftStick.y !== newValues.y)) {\r\n            this._onleftstickchanged(newValues);\r\n        }\r\n        this._leftStick = newValues;\r\n    }\r\n    /**\r\n     * Gets the right joystick\r\n     */\r\n    public get rightStick(): StickValues {\r\n        return this._rightStick;\r\n    }\r\n    /**\r\n     * Sets the right joystick value\r\n     */\r\n    public set rightStick(newValues: StickValues) {\r\n        if (this._onrightstickchanged && (this._rightStick.x !== newValues.x || this._rightStick.y !== newValues.y)) {\r\n            this._onrightstickchanged(newValues);\r\n        }\r\n        this._rightStick = newValues;\r\n    }\r\n\r\n    /**\r\n     * Updates the gamepad joystick positions\r\n     */\r\n\r\n    public update() {\r\n        if (this._leftStick) {\r\n            this.leftStick = { x: this.browserGamepad.axes[this._leftStickAxisX], y: this.browserGamepad.axes[this._leftStickAxisY] };\r\n            if (this._invertLeftStickY) {\r\n                this.leftStick.y *= -1;\r\n            }\r\n        }\r\n        if (this._rightStick) {\r\n            this.rightStick = { x: this.browserGamepad.axes[this._rightStickAxisX], y: this.browserGamepad.axes[this._rightStickAxisY] };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Disposes the gamepad\r\n     */\r\n    public dispose() {}\r\n}\r\n\r\n/**\r\n * Represents a generic gamepad\r\n */\r\nexport class GenericPad extends Gamepad {\r\n    private _buttons: Array<number>;\r\n    private _onbuttondown: (buttonPressed: number) => void;\r\n    private _onbuttonup: (buttonReleased: number) => void;\r\n\r\n    /**\r\n     * Observable triggered when a button has been pressed\r\n     */\r\n    public onButtonDownObservable = new Observable<number>();\r\n    /**\r\n     * Observable triggered when a button has been released\r\n     */\r\n    public onButtonUpObservable = new Observable<number>();\r\n\r\n    /**\r\n     * Callback triggered when a button has been pressed\r\n     * @param callback Called when a button has been pressed\r\n     */\r\n    public onbuttondown(callback: (buttonPressed: number) => void) {\r\n        this._onbuttondown = callback;\r\n    }\r\n    /**\r\n     * Callback triggered when a button has been released\r\n     * @param callback Called when a button has been released\r\n     */\r\n    public onbuttonup(callback: (buttonReleased: number) => void) {\r\n        this._onbuttonup = callback;\r\n    }\r\n\r\n    /**\r\n     * Initializes the generic gamepad\r\n     * @param id The id of the generic gamepad\r\n     * @param index The index of the generic gamepad\r\n     * @param browserGamepad The browser gamepad\r\n     */\r\n    constructor(id: string, index: number, browserGamepad: any) {\r\n        super(id, index, browserGamepad);\r\n        this.type = Gamepad.GENERIC;\r\n        this._buttons = new Array(browserGamepad.buttons.length);\r\n    }\r\n\r\n    private _setButtonValue(newValue: number, currentValue: number, buttonIndex: number): number {\r\n        if (newValue !== currentValue) {\r\n            if (newValue === 1) {\r\n                if (this._onbuttondown) {\r\n                    this._onbuttondown(buttonIndex);\r\n                }\r\n\r\n                this.onButtonDownObservable.notifyObservers(buttonIndex);\r\n            }\r\n            if (newValue === 0) {\r\n                if (this._onbuttonup) {\r\n                    this._onbuttonup(buttonIndex);\r\n                }\r\n\r\n                this.onButtonUpObservable.notifyObservers(buttonIndex);\r\n            }\r\n        }\r\n        return newValue;\r\n    }\r\n\r\n    /**\r\n     * Updates the generic gamepad\r\n     */\r\n    public override update() {\r\n        super.update();\r\n        for (let index = 0; index < this._buttons.length; index++) {\r\n            this._buttons[index] = this._setButtonValue(this.browserGamepad.buttons[index].value, this._buttons[index], index);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Disposes the generic gamepad\r\n     */\r\n    public override dispose() {\r\n        super.dispose();\r\n        this.onButtonDownObservable.clear();\r\n        this.onButtonUpObservable.clear();\r\n    }\r\n}\r\n", "import type { Nullable } from \"../../types\";\r\nimport { serialize } from \"../../Misc/decorators\";\r\nimport type { Observer } from \"../../Misc/observable\";\r\nimport type { ArcRotateCamera } from \"../../Cameras/arcRotateCamera\";\r\nimport type { ICameraInput } from \"../../Cameras/cameraInputsManager\";\r\nimport { CameraInputTypes } from \"../../Cameras/cameraInputsManager\";\r\nimport { Gamepad } from \"../../Gamepads/gamepad\";\r\n/**\r\n * Manage the gamepad inputs to control an arc rotate camera.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/cameras/customizingCameraInputs\r\n */\r\nexport class ArcRotateCameraGamepadInput implements ICameraInput<ArcRotateCamera> {\r\n    /**\r\n     * Defines the camera the input is attached to.\r\n     */\r\n    public camera: ArcRotateCamera;\r\n\r\n    /**\r\n     * Defines the gamepad the input is gathering event from.\r\n     */\r\n    public gamepad: Nullable<Gamepad>;\r\n\r\n    /**\r\n     * Defines the gamepad rotation sensibility.\r\n     * This is the threshold from when rotation starts to be accounted for to prevent jittering.\r\n     */\r\n    @serialize()\r\n    public gamepadRotationSensibility = 80;\r\n\r\n    /**\r\n     * Defines the gamepad move sensibility.\r\n     * This is the threshold from when moving starts to be accounted for for to prevent jittering.\r\n     */\r\n    @serialize()\r\n    public gamepadMoveSensibility = 40;\r\n\r\n    private _yAxisScale = 1.0;\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that Yaxis (for right stick) should be inverted\r\n     */\r\n    public get invertYAxis() {\r\n        return this._yAxisScale !== 1.0;\r\n    }\r\n\r\n    public set invertYAxis(value: boolean) {\r\n        this._yAxisScale = value ? -1.0 : 1.0;\r\n    }\r\n\r\n    private _onGamepadConnectedObserver: Nullable<Observer<Gamepad>>;\r\n    private _onGamepadDisconnectedObserver: Nullable<Observer<Gamepad>>;\r\n\r\n    /**\r\n     * Attach the input controls to a specific dom element to get the input from.\r\n     */\r\n    public attachControl(): void {\r\n        const manager = this.camera.getScene().gamepadManager;\r\n        this._onGamepadConnectedObserver = manager.onGamepadConnectedObservable.add((gamepad) => {\r\n            if (gamepad.type !== Gamepad.POSE_ENABLED) {\r\n                // prioritize XBOX gamepads.\r\n                if (!this.gamepad || gamepad.type === Gamepad.XBOX) {\r\n                    this.gamepad = gamepad;\r\n                }\r\n            }\r\n        });\r\n\r\n        this._onGamepadDisconnectedObserver = manager.onGamepadDisconnectedObservable.add((gamepad) => {\r\n            if (this.gamepad === gamepad) {\r\n                this.gamepad = null;\r\n            }\r\n        });\r\n\r\n        this.gamepad = manager.getGamepadByType(Gamepad.XBOX);\r\n        // if no xbox controller was found, but there are gamepad controllers, take the first one\r\n        if (!this.gamepad && manager.gamepads.length) {\r\n            this.gamepad = manager.gamepads[0];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Detach the current controls from the specified dom element.\r\n     */\r\n    public detachControl(): void {\r\n        this.camera.getScene().gamepadManager.onGamepadConnectedObservable.remove(this._onGamepadConnectedObserver);\r\n        this.camera.getScene().gamepadManager.onGamepadDisconnectedObservable.remove(this._onGamepadDisconnectedObserver);\r\n        this.gamepad = null;\r\n    }\r\n\r\n    /**\r\n     * Update the current camera state depending on the inputs that have been used this frame.\r\n     * This is a dynamically created lambda to avoid the performance penalty of looping for inputs in the render loop.\r\n     */\r\n    public checkInputs(): void {\r\n        if (this.gamepad) {\r\n            const camera = this.camera;\r\n            const rsValues = this.gamepad.rightStick;\r\n\r\n            if (rsValues) {\r\n                if (rsValues.x != 0) {\r\n                    const normalizedRX = rsValues.x / this.gamepadRotationSensibility;\r\n                    if (normalizedRX != 0 && Math.abs(normalizedRX) > 0.005) {\r\n                        camera.inertialAlphaOffset += normalizedRX;\r\n                    }\r\n                }\r\n\r\n                if (rsValues.y != 0) {\r\n                    const normalizedRY = (rsValues.y / this.gamepadRotationSensibility) * this._yAxisScale;\r\n                    if (normalizedRY != 0 && Math.abs(normalizedRY) > 0.005) {\r\n                        camera.inertialBetaOffset += normalizedRY;\r\n                    }\r\n                }\r\n            }\r\n\r\n            const lsValues = this.gamepad.leftStick;\r\n            if (lsValues && lsValues.y != 0) {\r\n                const normalizedLY = lsValues.y / this.gamepadMoveSensibility;\r\n                if (normalizedLY != 0 && Math.abs(normalizedLY) > 0.005) {\r\n                    this.camera.inertialRadiusOffset -= normalizedLY;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the class name of the current intput.\r\n     * @returns the class name\r\n     */\r\n    public getClassName(): string {\r\n        return \"ArcRotateCameraGamepadInput\";\r\n    }\r\n\r\n    /**\r\n     * Get the friendly name associated with the input class.\r\n     * @returns the input friendly name\r\n     */\r\n    public getSimpleName(): string {\r\n        return \"gamepad\";\r\n    }\r\n}\r\n\r\n(<any>CameraInputTypes)[\"ArcRotateCameraGamepadInput\"] = ArcRotateCameraGamepadInput;\r\n", "import type { Nullable } from \"../../types\";\r\nimport { serialize } from \"../../Misc/decorators\";\r\nimport type { Observer } from \"../../Misc/observable\";\r\nimport type { ICameraInput } from \"../../Cameras/cameraInputsManager\";\r\nimport { CameraInputTypes } from \"../../Cameras/cameraInputsManager\";\r\nimport type { FlyCamera } from \"../../Cameras/flyCamera\";\r\nimport type { KeyboardInfo } from \"../../Events/keyboardEvents\";\r\nimport { KeyboardEventTypes } from \"../../Events/keyboardEvents\";\r\nimport type { Scene } from \"../../scene\";\r\nimport { Vector3 } from \"../../Maths/math.vector\";\r\nimport { Tools } from \"../../Misc/tools\";\r\nimport type { AbstractEngine } from \"../../Engines/abstractEngine\";\r\n\r\n/**\r\n * Listen to keyboard events to control the camera.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/cameras/customizingCameraInputs\r\n */\r\nexport class FlyCameraKeyboardInput implements ICameraInput<FlyCamera> {\r\n    /**\r\n     * Defines the camera the input is attached to.\r\n     */\r\n    public camera: FlyCamera;\r\n\r\n    /**\r\n     * The list of keyboard keys used to control the forward move of the camera.\r\n     */\r\n    @serialize()\r\n    public keysForward = [87];\r\n\r\n    /**\r\n     * The list of keyboard keys used to control the backward move of the camera.\r\n     */\r\n    @serialize()\r\n    public keysBackward = [83];\r\n\r\n    /**\r\n     * The list of keyboard keys used to control the forward move of the camera.\r\n     */\r\n    @serialize()\r\n    public keysUp = [69];\r\n\r\n    /**\r\n     * The list of keyboard keys used to control the backward move of the camera.\r\n     */\r\n    @serialize()\r\n    public keysDown = [81];\r\n\r\n    /**\r\n     * The list of keyboard keys used to control the right strafe move of the camera.\r\n     */\r\n    @serialize()\r\n    public keysRight = [68];\r\n\r\n    /**\r\n     * The list of keyboard keys used to control the left strafe move of the camera.\r\n     */\r\n    @serialize()\r\n    public keysLeft = [65];\r\n\r\n    private _keys = new Array<number>();\r\n    private _onCanvasBlurObserver: Nullable<Observer<AbstractEngine>>;\r\n    private _onKeyboardObserver: Nullable<Observer<KeyboardInfo>>;\r\n    private _engine: AbstractEngine;\r\n    private _scene: Scene;\r\n\r\n    /**\r\n     * Attach the input controls to a specific dom element to get the input from.\r\n     * @param noPreventDefault Defines whether event caught by the controls should call preventdefault() (https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault)\r\n     */\r\n    public attachControl(noPreventDefault?: boolean): void {\r\n        noPreventDefault = Tools.BackCompatCameraNoPreventDefault(arguments);\r\n        if (this._onCanvasBlurObserver) {\r\n            return;\r\n        }\r\n\r\n        this._scene = this.camera.getScene();\r\n        this._engine = this._scene.getEngine();\r\n\r\n        this._onCanvasBlurObserver = this._engine.onCanvasBlurObservable.add(() => {\r\n            this._keys.length = 0;\r\n        });\r\n\r\n        this._onKeyboardObserver = this._scene.onKeyboardObservable.add((info) => {\r\n            const evt = info.event;\r\n\r\n            if (info.type === KeyboardEventTypes.KEYDOWN) {\r\n                if (\r\n                    this.keysForward.indexOf(evt.keyCode) !== -1 ||\r\n                    this.keysBackward.indexOf(evt.keyCode) !== -1 ||\r\n                    this.keysUp.indexOf(evt.keyCode) !== -1 ||\r\n                    this.keysDown.indexOf(evt.keyCode) !== -1 ||\r\n                    this.keysLeft.indexOf(evt.keyCode) !== -1 ||\r\n                    this.keysRight.indexOf(evt.keyCode) !== -1\r\n                ) {\r\n                    const index = this._keys.indexOf(evt.keyCode);\r\n\r\n                    if (index === -1) {\r\n                        this._keys.push(evt.keyCode);\r\n                    }\r\n                    if (!noPreventDefault) {\r\n                        evt.preventDefault();\r\n                    }\r\n                }\r\n            } else {\r\n                if (\r\n                    this.keysForward.indexOf(evt.keyCode) !== -1 ||\r\n                    this.keysBackward.indexOf(evt.keyCode) !== -1 ||\r\n                    this.keysUp.indexOf(evt.keyCode) !== -1 ||\r\n                    this.keysDown.indexOf(evt.keyCode) !== -1 ||\r\n                    this.keysLeft.indexOf(evt.keyCode) !== -1 ||\r\n                    this.keysRight.indexOf(evt.keyCode) !== -1\r\n                ) {\r\n                    const index = this._keys.indexOf(evt.keyCode);\r\n\r\n                    if (index >= 0) {\r\n                        this._keys.splice(index, 1);\r\n                    }\r\n                    if (!noPreventDefault) {\r\n                        evt.preventDefault();\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Detach the current controls from the specified dom element.\r\n     */\r\n    public detachControl(): void {\r\n        if (this._scene) {\r\n            if (this._onKeyboardObserver) {\r\n                this._scene.onKeyboardObservable.remove(this._onKeyboardObserver);\r\n            }\r\n\r\n            if (this._onCanvasBlurObserver) {\r\n                this._engine.onCanvasBlurObservable.remove(this._onCanvasBlurObserver);\r\n            }\r\n            this._onKeyboardObserver = null;\r\n            this._onCanvasBlurObserver = null;\r\n        }\r\n        this._keys.length = 0;\r\n    }\r\n\r\n    /**\r\n     * Gets the class name of the current input.\r\n     * @returns the class name\r\n     */\r\n    public getClassName(): string {\r\n        return \"FlyCameraKeyboardInput\";\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _onLostFocus(): void {\r\n        this._keys.length = 0;\r\n    }\r\n\r\n    /**\r\n     * Get the friendly name associated with the input class.\r\n     * @returns the input friendly name\r\n     */\r\n    public getSimpleName(): string {\r\n        return \"keyboard\";\r\n    }\r\n\r\n    /**\r\n     * Update the current camera state depending on the inputs that have been used this frame.\r\n     * This is a dynamically created lambda to avoid the performance penalty of looping for inputs in the render loop.\r\n     */\r\n    public checkInputs(): void {\r\n        if (this._onKeyboardObserver) {\r\n            const camera = this.camera;\r\n            // Keyboard\r\n            for (let index = 0; index < this._keys.length; index++) {\r\n                const keyCode = this._keys[index];\r\n                const speed = camera._computeLocalCameraSpeed();\r\n\r\n                if (this.keysForward.indexOf(keyCode) !== -1) {\r\n                    camera._localDirection.copyFromFloats(0, 0, speed);\r\n                } else if (this.keysBackward.indexOf(keyCode) !== -1) {\r\n                    camera._localDirection.copyFromFloats(0, 0, -speed);\r\n                } else if (this.keysUp.indexOf(keyCode) !== -1) {\r\n                    camera._localDirection.copyFromFloats(0, speed, 0);\r\n                } else if (this.keysDown.indexOf(keyCode) !== -1) {\r\n                    camera._localDirection.copyFromFloats(0, -speed, 0);\r\n                } else if (this.keysRight.indexOf(keyCode) !== -1) {\r\n                    camera._localDirection.copyFromFloats(speed, 0, 0);\r\n                } else if (this.keysLeft.indexOf(keyCode) !== -1) {\r\n                    camera._localDirection.copyFromFloats(-speed, 0, 0);\r\n                }\r\n\r\n                if (camera.getScene().useRightHandedSystem) {\r\n                    camera._localDirection.z *= -1;\r\n                }\r\n\r\n                camera.getViewMatrix().invertToRef(camera._cameraTransformMatrix);\r\n                Vector3.TransformNormalToRef(camera._localDirection, camera._cameraTransformMatrix, camera._transformedDirection);\r\n                camera.cameraDirection.addInPlace(camera._transformedDirection);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n(<any>CameraInputTypes)[\"FlyCameraKeyboardInput\"] = FlyCameraKeyboardInput;\r\n", "import type { Nullable } from \"../../types\";\r\nimport { serialize } from \"../../Misc/decorators\";\r\nimport type { Observer } from \"../../Misc/observable\";\r\nimport type { ICameraInput } from \"../../Cameras/cameraInputsManager\";\r\nimport { CameraInputTypes } from \"../../Cameras/cameraInputsManager\";\r\nimport type { FlyCamera } from \"../../Cameras/flyCamera\";\r\nimport type { PointerInfo } from \"../../Events/pointerEvents\";\r\nimport { PointerEventTypes } from \"../../Events/pointerEvents\";\r\nimport type { Scene } from \"../../scene\";\r\nimport { Quaternion } from \"../../Maths/math.vector\";\r\nimport { Axis } from \"../../Maths/math.axis\";\r\nimport { Tools } from \"../../Misc/tools\";\r\nimport type { IPointerEvent } from \"../../Events/deviceInputEvents\";\r\n/**\r\n * Listen to mouse events to control the camera.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/cameras/customizingCameraInputs\r\n */\r\nexport class FlyCameraMouseInput implements ICameraInput<FlyCamera> {\r\n    /**\r\n     * Defines the camera the input is attached to.\r\n     */\r\n    public camera: FlyCamera;\r\n\r\n    /**\r\n     * Defines if touch is enabled. (Default is true.)\r\n     */\r\n    public touchEnabled: boolean;\r\n\r\n    /**\r\n     * Defines the buttons associated with the input to handle camera rotation.\r\n     */\r\n    @serialize()\r\n    public buttons = [0, 1, 2];\r\n\r\n    /**\r\n     * Assign buttons for Yaw control.\r\n     */\r\n    public buttonsYaw: number[] = [-1, 0, 1];\r\n\r\n    /**\r\n     * Assign buttons for Pitch control.\r\n     */\r\n    public buttonsPitch: number[] = [-1, 0, 1];\r\n\r\n    /**\r\n     * Assign buttons for Roll control.\r\n     */\r\n    public buttonsRoll: number[] = [2];\r\n\r\n    /**\r\n     * Detect if any button is being pressed while mouse is moved.\r\n     * -1 = Mouse locked.\r\n     * 0 = Left button.\r\n     * 1 = Middle Button.\r\n     * 2 = Right Button.\r\n     */\r\n    public activeButton: number = -1;\r\n\r\n    /**\r\n     * Defines the pointer's angular sensibility, to control the camera rotation speed.\r\n     * Higher values reduce its sensitivity.\r\n     */\r\n    @serialize()\r\n    public angularSensibility = 1000.0;\r\n\r\n    private _observer: Nullable<Observer<PointerInfo>>;\r\n    private _rollObserver: Nullable<Observer<Scene>>;\r\n    private _previousPosition: Nullable<{ x: number; y: number }> = null;\r\n    private _noPreventDefault: boolean | undefined;\r\n\r\n    /**\r\n     * Listen to mouse events to control the camera.\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/cameras/customizingCameraInputs\r\n     */\r\n    constructor() {}\r\n\r\n    /**\r\n     * Attach the mouse control to the HTML DOM element.\r\n     * @param noPreventDefault Defines whether events caught by the controls should call preventdefault().\r\n     */\r\n    public attachControl(noPreventDefault?: boolean): void {\r\n        noPreventDefault = Tools.BackCompatCameraNoPreventDefault(arguments);\r\n        this._noPreventDefault = noPreventDefault;\r\n\r\n        this._observer = this.camera.getScene()._inputManager._addCameraPointerObserver(\r\n            (p: any) => {\r\n                this._pointerInput(p);\r\n            },\r\n            PointerEventTypes.POINTERDOWN | PointerEventTypes.POINTERUP | PointerEventTypes.POINTERMOVE\r\n        );\r\n\r\n        // Correct Roll by rate, if enabled.\r\n        this._rollObserver = this.camera.getScene().onBeforeRenderObservable.add(() => {\r\n            if (this.camera.rollCorrect) {\r\n                this.camera.restoreRoll(this.camera.rollCorrect);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Detach the current controls from the specified dom element.\r\n     */\r\n    public detachControl(): void {\r\n        if (this._observer) {\r\n            this.camera.getScene()._inputManager._removeCameraPointerObserver(this._observer);\r\n\r\n            this.camera.getScene().onBeforeRenderObservable.remove(this._rollObserver);\r\n\r\n            this._observer = null;\r\n            this._rollObserver = null;\r\n            this._previousPosition = null;\r\n            this._noPreventDefault = undefined;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the class name of the current input.\r\n     * @returns the class name.\r\n     */\r\n    public getClassName(): string {\r\n        return \"FlyCameraMouseInput\";\r\n    }\r\n\r\n    /**\r\n     * Get the friendly name associated with the input class.\r\n     * @returns the input's friendly name.\r\n     */\r\n    public getSimpleName(): string {\r\n        return \"mouse\";\r\n    }\r\n\r\n    // Track mouse movement, when the pointer is not locked.\r\n    private _pointerInput(p: any): void {\r\n        const e = <IPointerEvent>p.event;\r\n\r\n        const camera = this.camera;\r\n        const engine = camera.getEngine();\r\n\r\n        if (!this.touchEnabled && e.pointerType === \"touch\") {\r\n            return;\r\n        }\r\n\r\n        // Mouse is moved but an unknown mouse button is pressed.\r\n        if (p.type !== PointerEventTypes.POINTERMOVE && this.buttons.indexOf(e.button) === -1) {\r\n            return;\r\n        }\r\n\r\n        const srcElement = <HTMLElement>e.target;\r\n\r\n        // Mouse down.\r\n        if (p.type === PointerEventTypes.POINTERDOWN) {\r\n            try {\r\n                srcElement?.setPointerCapture(e.pointerId);\r\n            } catch (e) {\r\n                // Nothing to do with the error. Execution continues.\r\n            }\r\n\r\n            this._previousPosition = {\r\n                x: e.clientX,\r\n                y: e.clientY,\r\n            };\r\n\r\n            this.activeButton = e.button;\r\n\r\n            if (!this._noPreventDefault) {\r\n                e.preventDefault();\r\n            }\r\n\r\n            // This is required to move while pointer button is down\r\n            if (engine.isPointerLock) {\r\n                this._onMouseMove(p.event);\r\n            }\r\n        }\r\n        // Mouse up.\r\n        else if (p.type === PointerEventTypes.POINTERUP) {\r\n            try {\r\n                srcElement?.releasePointerCapture(e.pointerId);\r\n            } catch (e) {\r\n                // Nothing to do with the error. Execution continues.\r\n            }\r\n\r\n            this.activeButton = -1;\r\n\r\n            this._previousPosition = null;\r\n            if (!this._noPreventDefault) {\r\n                e.preventDefault();\r\n            }\r\n        }\r\n        // Mouse move.\r\n        else if (p.type === PointerEventTypes.POINTERMOVE) {\r\n            if (!this._previousPosition) {\r\n                if (engine.isPointerLock) {\r\n                    this._onMouseMove(p.event);\r\n                }\r\n\r\n                return;\r\n            }\r\n\r\n            const offsetX = e.clientX - this._previousPosition.x;\r\n            const offsetY = e.clientY - this._previousPosition.y;\r\n\r\n            this._rotateCamera(offsetX, offsetY);\r\n\r\n            this._previousPosition = {\r\n                x: e.clientX,\r\n                y: e.clientY,\r\n            };\r\n\r\n            if (!this._noPreventDefault) {\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    }\r\n\r\n    // Track mouse movement, when pointer is locked.\r\n    private _onMouseMove(e: any): void {\r\n        const camera = this.camera;\r\n        const engine = camera.getEngine();\r\n\r\n        if (!engine.isPointerLock) {\r\n            return;\r\n        }\r\n\r\n        const offsetX = e.movementX;\r\n        const offsetY = e.movementY;\r\n\r\n        this._rotateCamera(offsetX, offsetY);\r\n\r\n        this._previousPosition = null;\r\n\r\n        if (!this._noPreventDefault) {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Rotate camera by mouse offset.\r\n     * @param offsetX\r\n     * @param offsetY\r\n     */\r\n    private _rotateCamera(offsetX: number, offsetY: number): void {\r\n        const camera = this.camera;\r\n\r\n        const handednessMultiplier = camera._calculateHandednessMultiplier();\r\n        const x = (offsetX * handednessMultiplier) / this.angularSensibility;\r\n        const y = (offsetY * handednessMultiplier) / this.angularSensibility;\r\n\r\n        // Initialize to current rotation.\r\n        const currentRotation = Quaternion.RotationYawPitchRoll(camera.rotation.y, camera.rotation.x, camera.rotation.z);\r\n        let rotationChange: Quaternion;\r\n\r\n        // Pitch.\r\n        if (\r\n            this.buttonsPitch.some((v) => {\r\n                return v === this.activeButton;\r\n            })\r\n        ) {\r\n            // Apply change in Radians to vector Angle.\r\n            rotationChange = Quaternion.RotationAxis(Axis.X, y);\r\n            // Apply Pitch to quaternion.\r\n            currentRotation.multiplyInPlace(rotationChange);\r\n        }\r\n\r\n        // Yaw.\r\n        if (\r\n            this.buttonsYaw.some((v) => {\r\n                return v === this.activeButton;\r\n            })\r\n        ) {\r\n            // Apply change in Radians to vector Angle.\r\n            rotationChange = Quaternion.RotationAxis(Axis.Y, x);\r\n            // Apply Yaw to quaternion.\r\n            currentRotation.multiplyInPlace(rotationChange);\r\n\r\n            // Add Roll, if banked turning is enabled, within Roll limit.\r\n            const limit = camera.bankedTurnLimit + camera._trackRoll; // Defaults to 90Â° plus manual roll.\r\n            if (camera.bankedTurn && -limit < camera.rotation.z && camera.rotation.z < limit) {\r\n                const bankingDelta = camera.bankedTurnMultiplier * -x;\r\n                // Apply change in Radians to vector Angle.\r\n                rotationChange = Quaternion.RotationAxis(Axis.Z, bankingDelta);\r\n                // Apply Yaw to quaternion.\r\n                currentRotation.multiplyInPlace(rotationChange);\r\n            }\r\n        }\r\n\r\n        // Roll.\r\n        if (\r\n            this.buttonsRoll.some((v) => {\r\n                return v === this.activeButton;\r\n            })\r\n        ) {\r\n            // Apply change in Radians to vector Angle.\r\n            rotationChange = Quaternion.RotationAxis(Axis.Z, -x);\r\n            // Track Rolling.\r\n            camera._trackRoll -= x;\r\n            // Apply Pitch to quaternion.\r\n            currentRotation.multiplyInPlace(rotationChange);\r\n        }\r\n\r\n        // Apply rotationQuaternion to Euler camera.rotation.\r\n        currentRotation.toEulerAnglesToRef(camera.rotation);\r\n    }\r\n}\r\n\r\n(<any>CameraInputTypes)[\"FlyCameraMouseInput\"] = FlyCameraMouseInput;\r\n", "import { serialize } from \"../../Misc/decorators\";\r\nimport type { Observer } from \"../../Misc/observable\";\r\nimport type { Nullable } from \"../../types\";\r\nimport type { ICameraInput } from \"../../Cameras/cameraInputsManager\";\r\nimport { CameraInputTypes } from \"../../Cameras/cameraInputsManager\";\r\nimport type { FreeCamera } from \"../../Cameras/freeCamera\";\r\nimport { Matrix, Vector3, Vector2 } from \"../../Maths/math.vector\";\r\nimport { Gamepad } from \"../../Gamepads/gamepad\";\r\n\r\n/**\r\n * Manage the gamepad inputs to control a free camera.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/cameras/customizingCameraInputs\r\n */\r\nexport class FreeCameraGamepadInput implements ICameraInput<FreeCamera> {\r\n    /**\r\n     * Define the camera the input is attached to.\r\n     */\r\n    public camera: FreeCamera;\r\n\r\n    /**\r\n     * Define the Gamepad controlling the input\r\n     */\r\n    public gamepad: Nullable<Gamepad>;\r\n\r\n    /**\r\n     * Defines the gamepad rotation sensibility.\r\n     * This is the threshold from when rotation starts to be accounted for to prevent jittering.\r\n     */\r\n    @serialize()\r\n    public gamepadAngularSensibility = 200;\r\n\r\n    /**\r\n     * Defines the gamepad move sensibility.\r\n     * This is the threshold from when moving starts to be accounted for for to prevent jittering.\r\n     */\r\n    @serialize()\r\n    public gamepadMoveSensibility = 40;\r\n\r\n    /**\r\n     * Defines the minimum value at which any analog stick input is ignored.\r\n     * Note: This value should only be a value between 0 and 1.\r\n     */\r\n    public deadzoneDelta = 0.1;\r\n\r\n    private _yAxisScale = 1.0;\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that Yaxis (for right stick) should be inverted\r\n     */\r\n    public get invertYAxis() {\r\n        return this._yAxisScale !== 1.0;\r\n    }\r\n\r\n    public set invertYAxis(value: boolean) {\r\n        this._yAxisScale = value ? -1.0 : 1.0;\r\n    }\r\n\r\n    // private members\r\n    private _onGamepadConnectedObserver: Nullable<Observer<Gamepad>>;\r\n    private _onGamepadDisconnectedObserver: Nullable<Observer<Gamepad>>;\r\n    private _cameraTransform: Matrix = Matrix.Identity();\r\n    private _deltaTransform: Vector3 = Vector3.Zero();\r\n    private _vector3: Vector3 = Vector3.Zero();\r\n    private _vector2: Vector2 = Vector2.Zero();\r\n\r\n    /**\r\n     * Attach the input controls to a specific dom element to get the input from.\r\n     */\r\n    public attachControl(): void {\r\n        const manager = this.camera.getScene().gamepadManager;\r\n        this._onGamepadConnectedObserver = manager.onGamepadConnectedObservable.add((gamepad) => {\r\n            if (gamepad.type !== Gamepad.POSE_ENABLED) {\r\n                // prioritize XBOX gamepads.\r\n                if (!this.gamepad || gamepad.type === Gamepad.XBOX) {\r\n                    this.gamepad = gamepad;\r\n                }\r\n            }\r\n        });\r\n\r\n        this._onGamepadDisconnectedObserver = manager.onGamepadDisconnectedObservable.add((gamepad) => {\r\n            if (this.gamepad === gamepad) {\r\n                this.gamepad = null;\r\n            }\r\n        });\r\n\r\n        // check if there are already other controllers connected\r\n        this.gamepad = manager.getGamepadByType(Gamepad.XBOX);\r\n        // if no xbox controller was found, but there are gamepad controllers, take the first one\r\n        if (!this.gamepad && manager.gamepads.length) {\r\n            this.gamepad = manager.gamepads[0];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Detach the current controls from the specified dom element.\r\n     */\r\n    public detachControl(): void {\r\n        this.camera.getScene().gamepadManager.onGamepadConnectedObservable.remove(this._onGamepadConnectedObserver);\r\n        this.camera.getScene().gamepadManager.onGamepadDisconnectedObservable.remove(this._onGamepadDisconnectedObserver);\r\n        this.gamepad = null;\r\n    }\r\n\r\n    /**\r\n     * Update the current camera state depending on the inputs that have been used this frame.\r\n     * This is a dynamically created lambda to avoid the performance penalty of looping for inputs in the render loop.\r\n     */\r\n    public checkInputs(): void {\r\n        if (this.gamepad && this.gamepad.leftStick) {\r\n            const camera = this.camera;\r\n            const lsValues = this.gamepad.leftStick;\r\n            if (this.gamepadMoveSensibility !== 0) {\r\n                lsValues.x = Math.abs(lsValues.x) > this.deadzoneDelta ? lsValues.x / this.gamepadMoveSensibility : 0;\r\n                lsValues.y = Math.abs(lsValues.y) > this.deadzoneDelta ? lsValues.y / this.gamepadMoveSensibility : 0;\r\n            }\r\n\r\n            let rsValues = this.gamepad.rightStick;\r\n            if (rsValues && this.gamepadAngularSensibility !== 0) {\r\n                rsValues.x = Math.abs(rsValues.x) > this.deadzoneDelta ? rsValues.x / this.gamepadAngularSensibility : 0;\r\n                rsValues.y = (Math.abs(rsValues.y) > this.deadzoneDelta ? rsValues.y / this.gamepadAngularSensibility : 0) * this._yAxisScale;\r\n            } else {\r\n                rsValues = { x: 0, y: 0 };\r\n            }\r\n\r\n            if (!camera.rotationQuaternion) {\r\n                Matrix.RotationYawPitchRollToRef(camera.rotation.y, camera.rotation.x, 0, this._cameraTransform);\r\n            } else {\r\n                camera.rotationQuaternion.toRotationMatrix(this._cameraTransform);\r\n            }\r\n\r\n            const speed = camera._computeLocalCameraSpeed() * 50.0;\r\n            this._vector3.copyFromFloats(lsValues.x * speed, 0, -lsValues.y * speed);\r\n\r\n            Vector3.TransformCoordinatesToRef(this._vector3, this._cameraTransform, this._deltaTransform);\r\n            camera.cameraDirection.addInPlace(this._deltaTransform);\r\n            this._vector2.copyFromFloats(rsValues.y, rsValues.x);\r\n            camera.cameraRotation.addInPlace(this._vector2);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the class name of the current input.\r\n     * @returns the class name\r\n     */\r\n    public getClassName(): string {\r\n        return \"FreeCameraGamepadInput\";\r\n    }\r\n\r\n    /**\r\n     * Get the friendly name associated with the input class.\r\n     * @returns the input friendly name\r\n     */\r\n    public getSimpleName(): string {\r\n        return \"gamepad\";\r\n    }\r\n}\r\n\r\n(<any>CameraInputTypes)[\"FreeCameraGamepadInput\"] = FreeCameraGamepadInput;\r\n", "import { FreeCamera } from \"./freeCamera\";\r\nimport type { FreeCameraTouchInput } from \"../Cameras/Inputs/freeCameraTouchInput\";\r\nimport type { FreeCameraMouseInput } from \"../Cameras/Inputs/freeCameraMouseInput\";\r\nimport type { Scene } from \"../scene\";\r\nimport { Vector3 } from \"../Maths/math.vector\";\r\nimport { Node } from \"../node\";\r\n\r\nNode.AddNodeConstructor(\"TouchCamera\", (name, scene) => {\r\n    return () => new TouchCamera(name, Vector3.Zero(), scene);\r\n});\r\n\r\n/**\r\n * This represents a FPS type of camera controlled by touch.\r\n * This is like a universal camera minus the Gamepad controls.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/cameras/camera_introduction#universal-camera\r\n */\r\nexport class TouchCamera extends FreeCamera {\r\n    /**\r\n     * Defines the touch sensibility for rotation.\r\n     * The higher the faster.\r\n     */\r\n    public get touchAngularSensibility(): number {\r\n        const touch = <FreeCameraTouchInput>this.inputs.attached[\"touch\"];\r\n        if (touch) {\r\n            return touch.touchAngularSensibility;\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    public set touchAngularSensibility(value: number) {\r\n        const touch = <FreeCameraTouchInput>this.inputs.attached[\"touch\"];\r\n        if (touch) {\r\n            touch.touchAngularSensibility = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Defines the touch sensibility for move.\r\n     * The higher the faster.\r\n     */\r\n    public get touchMoveSensibility(): number {\r\n        const touch = <FreeCameraTouchInput>this.inputs.attached[\"touch\"];\r\n        if (touch) {\r\n            return touch.touchMoveSensibility;\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    public set touchMoveSensibility(value: number) {\r\n        const touch = <FreeCameraTouchInput>this.inputs.attached[\"touch\"];\r\n        if (touch) {\r\n            touch.touchMoveSensibility = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Instantiates a new touch camera.\r\n     * This represents a FPS type of camera controlled by touch.\r\n     * This is like a universal camera minus the Gamepad controls.\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/cameras/camera_introduction#universal-camera\r\n     * @param name Define the name of the camera in the scene\r\n     * @param position Define the start position of the camera in the scene\r\n     * @param scene Define the scene the camera belongs to\r\n     */\r\n    constructor(name: string, position: Vector3, scene?: Scene) {\r\n        super(name, position, scene);\r\n        this.inputs.addTouch();\r\n\r\n        this._setupInputs();\r\n    }\r\n\r\n    /**\r\n     * Gets the current object class name.\r\n     * @returns the class name\r\n     */\r\n    public override getClassName(): string {\r\n        return \"TouchCamera\";\r\n    }\r\n\r\n    /** @internal */\r\n    public override _setupInputs() {\r\n        const touch = this.inputs.attached[\"touch\"] as FreeCameraTouchInput | undefined;\r\n        const mouse = this.inputs.attached[\"mouse\"] as FreeCameraMouseInput | undefined;\r\n        if (mouse) {\r\n            // enable touch in mouse input if touch module is not enabled\r\n            mouse.touchEnabled = !touch;\r\n        } else if (touch) {\r\n            // allow mouse in touch input if mouse module is not available\r\n            touch.allowMouse = !mouse;\r\n        }\r\n    }\r\n}\r\n", "import type { FlyCamera } from \"./flyCamera\";\r\nimport { CameraInputsManager } from \"./cameraInputsManager\";\r\nimport { FlyCameraMouseInput } from \"../Cameras/Inputs/flyCameraMouseInput\";\r\nimport { FlyCameraKeyboardInput } from \"../Cameras/Inputs/flyCameraKeyboardInput\";\r\n\r\n/**\r\n * Default Inputs manager for the FlyCamera.\r\n * It groups all the default supported inputs for ease of use.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/cameras/customizingCameraInputs\r\n */\r\nexport class FlyCameraInputsManager extends CameraInputsManager<FlyCamera> {\r\n    /**\r\n     * Instantiates a new FlyCameraInputsManager.\r\n     * @param camera Defines the camera the inputs belong to.\r\n     */\r\n    constructor(camera: FlyCamera) {\r\n        super(camera);\r\n    }\r\n\r\n    /**\r\n     * Add keyboard input support to the input manager.\r\n     * @returns the new FlyCameraKeyboardMoveInput().\r\n     */\r\n    addKeyboard(): FlyCameraInputsManager {\r\n        this.add(new FlyCameraKeyboardInput());\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Add mouse input support to the input manager.\r\n     * @returns the new FlyCameraMouseInput().\r\n     */\r\n    addMouse(): FlyCameraInputsManager {\r\n        this.add(new FlyCameraMouseInput());\r\n        return this;\r\n    }\r\n}\r\n", "import { serialize, serializeAsVector3 } from \"../Misc/decorators\";\r\nimport type { Nullable } from \"../types\";\r\nimport type { Scene } from \"../scene\";\r\nimport type { Quaternion } from \"../Maths/math.vector\";\r\nimport { Vector3 } from \"../Maths/math.vector\";\r\nimport type { AbstractMesh } from \"../Meshes/abstractMesh\";\r\nimport { TargetCamera } from \"./targetCamera\";\r\nimport { FlyCameraInputsManager } from \"./flyCameraInputsManager\";\r\nimport type { FlyCameraMouseInput } from \"../Cameras/Inputs/flyCameraMouseInput\";\r\nimport type { FlyCameraKeyboardInput } from \"../Cameras/Inputs/flyCameraKeyboardInput\";\r\nimport { Tools } from \"../Misc/tools\";\r\nimport { RegisterClass } from \"../Misc/typeStore\";\r\n\r\nimport type { Collider } from \"../Collisions/collider\";\r\nimport { AbstractEngine } from \"core/Engines/abstractEngine\";\r\n\r\n/**\r\n * This is a flying camera, designed for 3D movement and rotation in all directions,\r\n * such as in a 3D Space Shooter or a Flight Simulator.\r\n */\r\nexport class FlyCamera extends TargetCamera {\r\n    /**\r\n     * Define the collision ellipsoid of the camera.\r\n     * This is helpful for simulating a camera body, like a player's body.\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/cameras/camera_collisions#arcrotatecamera\r\n     */\r\n    @serializeAsVector3()\r\n    public ellipsoid = new Vector3(1, 1, 1);\r\n\r\n    /**\r\n     * Define an offset for the position of the ellipsoid around the camera.\r\n     * This can be helpful if the camera is attached away from the player's body center,\r\n     * such as at its head.\r\n     */\r\n    @serializeAsVector3()\r\n    public ellipsoidOffset = new Vector3(0, 0, 0);\r\n\r\n    /**\r\n     * Enable or disable collisions of the camera with the rest of the scene objects.\r\n     */\r\n    @serialize()\r\n    public checkCollisions = false;\r\n\r\n    /**\r\n     * Enable or disable gravity on the camera.\r\n     */\r\n    @serialize()\r\n    public applyGravity = false;\r\n\r\n    /**\r\n     * Define the current direction the camera is moving to.\r\n     */\r\n    public override cameraDirection = Vector3.Zero();\r\n\r\n    /**\r\n     * Define the current local rotation of the camera as a quaternion to prevent Gimbal lock.\r\n     * This overrides and empties cameraRotation.\r\n     */\r\n    public override rotationQuaternion: Nullable<Quaternion>;\r\n\r\n    /**\r\n     * Track Roll to maintain the wanted Rolling when looking around.\r\n     */\r\n    public _trackRoll: number = 0;\r\n\r\n    /**\r\n     * Slowly correct the Roll to its original value after a Pitch+Yaw rotation.\r\n     */\r\n    public rollCorrect: number = 100;\r\n\r\n    /**\r\n     * Mimic a banked turn, Rolling the camera when Yawing.\r\n     * It's recommended to use rollCorrect = 10 for faster banking correction.\r\n     */\r\n    public bankedTurn: boolean = false;\r\n\r\n    /**\r\n     * Limit in radians for how much Roll banking will add. (Default: 90Â°)\r\n     */\r\n    public bankedTurnLimit: number = Math.PI / 2;\r\n\r\n    /**\r\n     * Value of 0 disables the banked Roll.\r\n     * Value of 1 is equal to the Yaw angle in radians.\r\n     */\r\n    public bankedTurnMultiplier: number = 1;\r\n\r\n    /**\r\n     * The inputs manager loads all the input sources, such as keyboard and mouse.\r\n     */\r\n    public override inputs: FlyCameraInputsManager;\r\n\r\n    /**\r\n     * Gets the input sensibility for mouse input.\r\n     * Higher values reduce sensitivity.\r\n     */\r\n    public get angularSensibility(): number {\r\n        const mouse = <FlyCameraMouseInput>this.inputs.attached[\"mouse\"];\r\n        if (mouse) {\r\n            return mouse.angularSensibility;\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    /**\r\n     * Sets the input sensibility for a mouse input.\r\n     * Higher values reduce sensitivity.\r\n     */\r\n    public set angularSensibility(value: number) {\r\n        const mouse = <FlyCameraMouseInput>this.inputs.attached[\"mouse\"];\r\n        if (mouse) {\r\n            mouse.angularSensibility = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the keys for camera movement forward.\r\n     */\r\n    public get keysForward(): number[] {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            return keyboard.keysForward;\r\n        }\r\n\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Set the keys for camera movement forward.\r\n     */\r\n    public set keysForward(value: number[]) {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            keyboard.keysForward = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the keys for camera movement backward.\r\n     */\r\n    public get keysBackward(): number[] {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            return keyboard.keysBackward;\r\n        }\r\n\r\n        return [];\r\n    }\r\n\r\n    public set keysBackward(value: number[]) {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            keyboard.keysBackward = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the keys for camera movement up.\r\n     */\r\n    public get keysUp(): number[] {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            return keyboard.keysUp;\r\n        }\r\n\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Set the keys for camera movement up.\r\n     */\r\n    public set keysUp(value: number[]) {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            keyboard.keysUp = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the keys for camera movement down.\r\n     */\r\n    public get keysDown(): number[] {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            return keyboard.keysDown;\r\n        }\r\n\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Set the keys for camera movement down.\r\n     */\r\n    public set keysDown(value: number[]) {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            keyboard.keysDown = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the keys for camera movement left.\r\n     */\r\n    public get keysLeft(): number[] {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            return keyboard.keysLeft;\r\n        }\r\n\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Set the keys for camera movement left.\r\n     */\r\n    public set keysLeft(value: number[]) {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            keyboard.keysLeft = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the keys for camera movement right.\r\n     */\r\n    public get keysRight(): number[] {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            return keyboard.keysRight;\r\n        }\r\n\r\n        return [];\r\n    }\r\n\r\n    /**\r\n     * Set the keys for camera movement right.\r\n     */\r\n    public set keysRight(value: number[]) {\r\n        const keyboard = <FlyCameraKeyboardInput>this.inputs.attached[\"keyboard\"];\r\n        if (keyboard) {\r\n            keyboard.keysRight = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Event raised when the camera collides with a mesh in the scene.\r\n     */\r\n    public onCollide: (collidedMesh: AbstractMesh) => void;\r\n\r\n    private _collider: Collider;\r\n    private _needMoveForGravity = false;\r\n    private _oldPosition = Vector3.Zero();\r\n    private _diffPosition = Vector3.Zero();\r\n    private _newPosition = Vector3.Zero();\r\n\r\n    /** @internal */\r\n    public _localDirection: Vector3;\r\n    /** @internal */\r\n    public _transformedDirection: Vector3;\r\n\r\n    /**\r\n     * Instantiates a FlyCamera.\r\n     * This is a flying camera, designed for 3D movement and rotation in all directions,\r\n     * such as in a 3D Space Shooter or a Flight Simulator.\r\n     * @param name Define the name of the camera in the scene.\r\n     * @param position Define the starting position of the camera in the scene.\r\n     * @param scene Define the scene the camera belongs to.\r\n     * @param setActiveOnSceneIfNoneActive Defines whether the camera should be marked as active, if no other camera has been defined as active.\r\n     */\r\n    constructor(name: string, position: Vector3, scene?: Scene, setActiveOnSceneIfNoneActive = true) {\r\n        super(name, position, scene, setActiveOnSceneIfNoneActive);\r\n        this.inputs = new FlyCameraInputsManager(this);\r\n        this.inputs.addKeyboard().addMouse();\r\n    }\r\n\r\n    /**\r\n     * Attach the input controls to a specific dom element to get the input from.\r\n     * @param noPreventDefault Defines whether event caught by the controls should call preventdefault() (https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault)\r\n     */\r\n    public override attachControl(noPreventDefault?: boolean): void;\r\n    /**\r\n     * Attached controls to the current camera.\r\n     * @param ignored defines an ignored parameter kept for backward compatibility.\r\n     * @param noPreventDefault Defines whether event caught by the controls should call preventdefault() (https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault)\r\n     */\r\n    public override attachControl(ignored: any, noPreventDefault?: boolean): void {\r\n        noPreventDefault = Tools.BackCompatCameraNoPreventDefault(arguments);\r\n        this.inputs.attachElement(noPreventDefault);\r\n    }\r\n\r\n    /**\r\n     * Detach a control from the HTML DOM element.\r\n     * The camera will stop reacting to that input.\r\n     */\r\n    public override detachControl(): void {\r\n        this.inputs.detachElement();\r\n\r\n        this.cameraDirection = new Vector3(0, 0, 0);\r\n    }\r\n\r\n    // Collisions.\r\n    private _collisionMask = -1;\r\n\r\n    /**\r\n     * Get the mask that the camera ignores in collision events.\r\n     */\r\n    public get collisionMask(): number {\r\n        return this._collisionMask;\r\n    }\r\n\r\n    /**\r\n     * Set the mask that the camera ignores in collision events.\r\n     */\r\n    public set collisionMask(mask: number) {\r\n        this._collisionMask = !isNaN(mask) ? mask : -1;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _collideWithWorld(displacement: Vector3): void {\r\n        let globalPosition: Vector3;\r\n\r\n        if (this.parent) {\r\n            globalPosition = Vector3.TransformCoordinates(this.position, this.parent.getWorldMatrix());\r\n        } else {\r\n            globalPosition = this.position;\r\n        }\r\n\r\n        globalPosition.subtractFromFloatsToRef(0, this.ellipsoid.y, 0, this._oldPosition);\r\n        this._oldPosition.addInPlace(this.ellipsoidOffset);\r\n        const coordinator = this.getScene().collisionCoordinator;\r\n\r\n        if (!this._collider) {\r\n            this._collider = coordinator.createCollider();\r\n        }\r\n\r\n        this._collider._radius = this.ellipsoid;\r\n        this._collider.collisionMask = this._collisionMask;\r\n\r\n        // No need for clone, as long as gravity is not on.\r\n        let actualDisplacement = displacement;\r\n\r\n        // Add gravity to direction to prevent dual-collision checking.\r\n        if (this.applyGravity) {\r\n            // This prevents mending with cameraDirection, a global variable of the fly camera class.\r\n            actualDisplacement = displacement.add(this.getScene().gravity);\r\n        }\r\n\r\n        coordinator.getNewPosition(this._oldPosition, actualDisplacement, this._collider, 3, null, this._onCollisionPositionChange, this.uniqueId);\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    private _onCollisionPositionChange = (collisionId: number, newPosition: Vector3, collidedMesh: Nullable<AbstractMesh> = null) => {\r\n        const updatePosition = (newPos: Vector3) => {\r\n            this._newPosition.copyFrom(newPos);\r\n\r\n            this._newPosition.subtractToRef(this._oldPosition, this._diffPosition);\r\n\r\n            if (this._diffPosition.length() > AbstractEngine.CollisionsEpsilon) {\r\n                this.position.addInPlace(this._diffPosition);\r\n                if (this.onCollide && collidedMesh) {\r\n                    this.onCollide(collidedMesh);\r\n                }\r\n            }\r\n        };\r\n\r\n        updatePosition(newPosition);\r\n    };\r\n\r\n    /** @internal */\r\n    public override _checkInputs(): void {\r\n        if (!this._localDirection) {\r\n            this._localDirection = Vector3.Zero();\r\n            this._transformedDirection = Vector3.Zero();\r\n        }\r\n\r\n        this.inputs.checkInputs();\r\n\r\n        super._checkInputs();\r\n    }\r\n\r\n    /**\r\n     * Enable movement without a user input. This allows gravity to always be applied.\r\n     */\r\n    public set needMoveForGravity(value: boolean) {\r\n        this._needMoveForGravity = value;\r\n    }\r\n\r\n    /**\r\n     * When true, gravity is applied whether there is user input or not.\r\n     */\r\n    public get needMoveForGravity(): boolean {\r\n        return this._needMoveForGravity;\r\n    }\r\n\r\n    /** @internal */\r\n    public override _decideIfNeedsToMove(): boolean {\r\n        return this._needMoveForGravity || Math.abs(this.cameraDirection.x) > 0 || Math.abs(this.cameraDirection.y) > 0 || Math.abs(this.cameraDirection.z) > 0;\r\n    }\r\n\r\n    /** @internal */\r\n    public override _updatePosition(): void {\r\n        if (this.checkCollisions && this.getScene().collisionsEnabled) {\r\n            this._collideWithWorld(this.cameraDirection);\r\n        } else {\r\n            super._updatePosition();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Restore the Roll to its target value at the rate specified.\r\n     * @param rate - Higher means slower restoring.\r\n     * @internal\r\n     */\r\n    public restoreRoll(rate: number): void {\r\n        const limit = this._trackRoll; // Target Roll.\r\n        const z = this.rotation.z; // Current Roll.\r\n        const delta = limit - z; // Difference in Roll.\r\n\r\n        const minRad = 0.001; // Tenth of a radian is a barely noticable difference.\r\n\r\n        // If the difference is noticable, restore the Roll.\r\n        if (Math.abs(delta) >= minRad) {\r\n            // Change Z rotation towards the target Roll.\r\n            this.rotation.z += delta / rate;\r\n\r\n            // Match when near enough.\r\n            if (Math.abs(limit - this.rotation.z) <= minRad) {\r\n                this.rotation.z = limit;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Destroy the camera and release the current resources held by it.\r\n     */\r\n    public override dispose(): void {\r\n        this.inputs.clear();\r\n        super.dispose();\r\n    }\r\n\r\n    /**\r\n     * Get the current object class name.\r\n     * @returns the class name.\r\n     */\r\n    public override getClassName(): string {\r\n        return \"FlyCamera\";\r\n    }\r\n}\r\n\r\n// Register Class Name\r\nRegisterClass(\"BABYLON.FlyCamera\", FlyCamera);\r\n", "import { Observable } from \"../Misc/observable\";\r\nimport { Gamepad } from \"../Gamepads/gamepad\";\r\n/**\r\n * Defines supported buttons for XBox360 compatible gamepads\r\n */\r\nexport const enum Xbox360Button {\r\n    /** A */\r\n    A = 0,\r\n    /** B */\r\n    B = 1,\r\n    /** X */\r\n    X = 2,\r\n    /** Y */\r\n    Y = 3,\r\n    /** Left button */\r\n    LB = 4,\r\n    /** Right button */\r\n    RB = 5,\r\n    /** Back */\r\n    Back = 8,\r\n    /** Start */\r\n    Start = 9,\r\n    /** Left stick */\r\n    LeftStick = 10,\r\n    /** Right stick */\r\n    RightStick = 11,\r\n}\r\n\r\n/** Defines values for XBox360 DPad  */\r\nexport const enum Xbox360Dpad {\r\n    /** Up */\r\n    Up = 12,\r\n    /** Down */\r\n    Down = 13,\r\n    /** Left */\r\n    Left = 14,\r\n    /** Right */\r\n    Right = 15,\r\n}\r\n\r\n/**\r\n * Defines a XBox360 gamepad\r\n */\r\nexport class Xbox360Pad extends Gamepad {\r\n    private _leftTrigger: number = 0;\r\n    private _rightTrigger: number = 0;\r\n\r\n    private _onlefttriggerchanged: (value: number) => void;\r\n    private _onrighttriggerchanged: (value: number) => void;\r\n\r\n    private _onbuttondown: (buttonPressed: Xbox360Button) => void;\r\n    private _onbuttonup: (buttonReleased: Xbox360Button) => void;\r\n    private _ondpaddown: (dPadPressed: Xbox360Dpad) => void;\r\n    private _ondpadup: (dPadReleased: Xbox360Dpad) => void;\r\n\r\n    /** Observable raised when a button is pressed */\r\n    public onButtonDownObservable = new Observable<Xbox360Button>();\r\n    /** Observable raised when a button is released */\r\n    public onButtonUpObservable = new Observable<Xbox360Button>();\r\n    /** Observable raised when a pad is pressed */\r\n    public onPadDownObservable = new Observable<Xbox360Dpad>();\r\n    /** Observable raised when a pad is released */\r\n    public onPadUpObservable = new Observable<Xbox360Dpad>();\r\n\r\n    private _buttonA: number = 0;\r\n    private _buttonB: number = 0;\r\n    private _buttonX: number = 0;\r\n    private _buttonY: number = 0;\r\n    private _buttonBack: number = 0;\r\n    private _buttonStart: number = 0;\r\n    private _buttonLb: number = 0;\r\n    private _buttonRb: number = 0;\r\n\r\n    private _buttonLeftStick: number = 0;\r\n    private _buttonRightStick: number = 0;\r\n    private _dPadUp: number = 0;\r\n    private _dPadDown: number = 0;\r\n    private _dPadLeft: number = 0;\r\n    private _dPadRight: number = 0;\r\n\r\n    private _isXboxOnePad: boolean = false;\r\n\r\n    /**\r\n     * Creates a new XBox360 gamepad object\r\n     * @param id defines the id of this gamepad\r\n     * @param index defines its index\r\n     * @param gamepad defines the internal HTML gamepad object\r\n     * @param xboxOne defines if it is a XBox One gamepad\r\n     */\r\n    constructor(id: string, index: number, gamepad: any, xboxOne: boolean = false) {\r\n        super(id, index, gamepad, 0, 1, 2, 3);\r\n        this.type = Gamepad.XBOX;\r\n        this._isXboxOnePad = xboxOne;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when left trigger is pressed\r\n     * @param callback defines the callback to use\r\n     */\r\n    public onlefttriggerchanged(callback: (value: number) => void) {\r\n        this._onlefttriggerchanged = callback;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when right trigger is pressed\r\n     * @param callback defines the callback to use\r\n     */\r\n    public onrighttriggerchanged(callback: (value: number) => void) {\r\n        this._onrighttriggerchanged = callback;\r\n    }\r\n\r\n    /**\r\n     * Gets the left trigger value\r\n     */\r\n    public get leftTrigger(): number {\r\n        return this._leftTrigger;\r\n    }\r\n    /**\r\n     * Sets the left trigger value\r\n     */\r\n    public set leftTrigger(newValue: number) {\r\n        if (this._onlefttriggerchanged && this._leftTrigger !== newValue) {\r\n            this._onlefttriggerchanged(newValue);\r\n        }\r\n        this._leftTrigger = newValue;\r\n    }\r\n\r\n    /**\r\n     * Gets the right trigger value\r\n     */\r\n    public get rightTrigger(): number {\r\n        return this._rightTrigger;\r\n    }\r\n    /**\r\n     * Sets the right trigger value\r\n     */\r\n    public set rightTrigger(newValue: number) {\r\n        if (this._onrighttriggerchanged && this._rightTrigger !== newValue) {\r\n            this._onrighttriggerchanged(newValue);\r\n        }\r\n        this._rightTrigger = newValue;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when a button is pressed\r\n     * @param callback defines the callback to use\r\n     */\r\n    public onbuttondown(callback: (buttonPressed: Xbox360Button) => void) {\r\n        this._onbuttondown = callback;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when a button is released\r\n     * @param callback defines the callback to use\r\n     */\r\n    public onbuttonup(callback: (buttonReleased: Xbox360Button) => void) {\r\n        this._onbuttonup = callback;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when a pad is pressed\r\n     * @param callback defines the callback to use\r\n     */\r\n    public ondpaddown(callback: (dPadPressed: Xbox360Dpad) => void) {\r\n        this._ondpaddown = callback;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when a pad is released\r\n     * @param callback defines the callback to use\r\n     */\r\n    public ondpadup(callback: (dPadReleased: Xbox360Dpad) => void) {\r\n        this._ondpadup = callback;\r\n    }\r\n\r\n    private _setButtonValue(newValue: number, currentValue: number, buttonType: Xbox360Button): number {\r\n        if (newValue !== currentValue) {\r\n            if (newValue === 1) {\r\n                if (this._onbuttondown) {\r\n                    this._onbuttondown(buttonType);\r\n                }\r\n\r\n                this.onButtonDownObservable.notifyObservers(buttonType);\r\n            }\r\n            if (newValue === 0) {\r\n                if (this._onbuttonup) {\r\n                    this._onbuttonup(buttonType);\r\n                }\r\n\r\n                this.onButtonUpObservable.notifyObservers(buttonType);\r\n            }\r\n        }\r\n        return newValue;\r\n    }\r\n\r\n    private _setDpadValue(newValue: number, currentValue: number, buttonType: Xbox360Dpad): number {\r\n        if (newValue !== currentValue) {\r\n            if (newValue === 1) {\r\n                if (this._ondpaddown) {\r\n                    this._ondpaddown(buttonType);\r\n                }\r\n\r\n                this.onPadDownObservable.notifyObservers(buttonType);\r\n            }\r\n            if (newValue === 0) {\r\n                if (this._ondpadup) {\r\n                    this._ondpadup(buttonType);\r\n                }\r\n\r\n                this.onPadUpObservable.notifyObservers(buttonType);\r\n            }\r\n        }\r\n        return newValue;\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `A` button\r\n     */\r\n    public get buttonA(): number {\r\n        return this._buttonA;\r\n    }\r\n    /**\r\n     * Sets the value of the `A` button\r\n     */\r\n    public set buttonA(value) {\r\n        this._buttonA = this._setButtonValue(value, this._buttonA, Xbox360Button.A);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `B` button\r\n     */\r\n    public get buttonB(): number {\r\n        return this._buttonB;\r\n    }\r\n    /**\r\n     * Sets the value of the `B` button\r\n     */\r\n    public set buttonB(value) {\r\n        this._buttonB = this._setButtonValue(value, this._buttonB, Xbox360Button.B);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `X` button\r\n     */\r\n    public get buttonX(): number {\r\n        return this._buttonX;\r\n    }\r\n    /**\r\n     * Sets the value of the `X` button\r\n     */\r\n    public set buttonX(value) {\r\n        this._buttonX = this._setButtonValue(value, this._buttonX, Xbox360Button.X);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `Y` button\r\n     */\r\n    public get buttonY(): number {\r\n        return this._buttonY;\r\n    }\r\n    /**\r\n     * Sets the value of the `Y` button\r\n     */\r\n    public set buttonY(value) {\r\n        this._buttonY = this._setButtonValue(value, this._buttonY, Xbox360Button.Y);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `Start` button\r\n     */\r\n    public get buttonStart(): number {\r\n        return this._buttonStart;\r\n    }\r\n    /**\r\n     * Sets the value of the `Start` button\r\n     */\r\n    public set buttonStart(value) {\r\n        this._buttonStart = this._setButtonValue(value, this._buttonStart, Xbox360Button.Start);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `Back` button\r\n     */\r\n    public get buttonBack(): number {\r\n        return this._buttonBack;\r\n    }\r\n    /**\r\n     * Sets the value of the `Back` button\r\n     */\r\n    public set buttonBack(value) {\r\n        this._buttonBack = this._setButtonValue(value, this._buttonBack, Xbox360Button.Back);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `Left` button\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    public get buttonLB(): number {\r\n        return this._buttonLb;\r\n    }\r\n    /**\r\n     * Sets the value of the `Left` button\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    public set buttonLB(value) {\r\n        this._buttonLb = this._setButtonValue(value, this._buttonLb, Xbox360Button.LB);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `Right` button\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    public get buttonRB(): number {\r\n        return this._buttonRb;\r\n    }\r\n    /**\r\n     * Sets the value of the `Right` button\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    public set buttonRB(value) {\r\n        this._buttonRb = this._setButtonValue(value, this._buttonRb, Xbox360Button.RB);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the Left joystick\r\n     */\r\n    public get buttonLeftStick(): number {\r\n        return this._buttonLeftStick;\r\n    }\r\n    /**\r\n     * Sets the value of the Left joystick\r\n     */\r\n    public set buttonLeftStick(value) {\r\n        this._buttonLeftStick = this._setButtonValue(value, this._buttonLeftStick, Xbox360Button.LeftStick);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the Right joystick\r\n     */\r\n    public get buttonRightStick(): number {\r\n        return this._buttonRightStick;\r\n    }\r\n    /**\r\n     * Sets the value of the Right joystick\r\n     */\r\n    public set buttonRightStick(value) {\r\n        this._buttonRightStick = this._setButtonValue(value, this._buttonRightStick, Xbox360Button.RightStick);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of D-pad up\r\n     */\r\n    public get dPadUp(): number {\r\n        return this._dPadUp;\r\n    }\r\n    /**\r\n     * Sets the value of D-pad up\r\n     */\r\n    public set dPadUp(value) {\r\n        this._dPadUp = this._setDpadValue(value, this._dPadUp, Xbox360Dpad.Up);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of D-pad down\r\n     */\r\n    public get dPadDown(): number {\r\n        return this._dPadDown;\r\n    }\r\n    /**\r\n     * Sets the value of D-pad down\r\n     */\r\n    public set dPadDown(value) {\r\n        this._dPadDown = this._setDpadValue(value, this._dPadDown, Xbox360Dpad.Down);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of D-pad left\r\n     */\r\n    public get dPadLeft(): number {\r\n        return this._dPadLeft;\r\n    }\r\n    /**\r\n     * Sets the value of D-pad left\r\n     */\r\n    public set dPadLeft(value) {\r\n        this._dPadLeft = this._setDpadValue(value, this._dPadLeft, Xbox360Dpad.Left);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of D-pad right\r\n     */\r\n    public get dPadRight(): number {\r\n        return this._dPadRight;\r\n    }\r\n    /**\r\n     * Sets the value of D-pad right\r\n     */\r\n    public set dPadRight(value) {\r\n        this._dPadRight = this._setDpadValue(value, this._dPadRight, Xbox360Dpad.Right);\r\n    }\r\n\r\n    /**\r\n     * Force the gamepad to synchronize with device values\r\n     */\r\n    public override update() {\r\n        super.update();\r\n        if (this._isXboxOnePad) {\r\n            this.buttonA = this.browserGamepad.buttons[0].value;\r\n            this.buttonB = this.browserGamepad.buttons[1].value;\r\n            this.buttonX = this.browserGamepad.buttons[2].value;\r\n            this.buttonY = this.browserGamepad.buttons[3].value;\r\n            this.buttonLB = this.browserGamepad.buttons[4].value;\r\n            this.buttonRB = this.browserGamepad.buttons[5].value;\r\n            this.leftTrigger = this.browserGamepad.buttons[6].value;\r\n            this.rightTrigger = this.browserGamepad.buttons[7].value;\r\n            this.buttonBack = this.browserGamepad.buttons[8].value;\r\n            this.buttonStart = this.browserGamepad.buttons[9].value;\r\n            this.buttonLeftStick = this.browserGamepad.buttons[10].value;\r\n            this.buttonRightStick = this.browserGamepad.buttons[11].value;\r\n            this.dPadUp = this.browserGamepad.buttons[12].value;\r\n            this.dPadDown = this.browserGamepad.buttons[13].value;\r\n            this.dPadLeft = this.browserGamepad.buttons[14].value;\r\n            this.dPadRight = this.browserGamepad.buttons[15].value;\r\n        } else {\r\n            this.buttonA = this.browserGamepad.buttons[0].value;\r\n            this.buttonB = this.browserGamepad.buttons[1].value;\r\n            this.buttonX = this.browserGamepad.buttons[2].value;\r\n            this.buttonY = this.browserGamepad.buttons[3].value;\r\n            this.buttonLB = this.browserGamepad.buttons[4].value;\r\n            this.buttonRB = this.browserGamepad.buttons[5].value;\r\n            this.leftTrigger = this.browserGamepad.buttons[6].value;\r\n            this.rightTrigger = this.browserGamepad.buttons[7].value;\r\n            this.buttonBack = this.browserGamepad.buttons[8].value;\r\n            this.buttonStart = this.browserGamepad.buttons[9].value;\r\n            this.buttonLeftStick = this.browserGamepad.buttons[10].value;\r\n            this.buttonRightStick = this.browserGamepad.buttons[11].value;\r\n            this.dPadUp = this.browserGamepad.buttons[12].value;\r\n            this.dPadDown = this.browserGamepad.buttons[13].value;\r\n            this.dPadLeft = this.browserGamepad.buttons[14].value;\r\n            this.dPadRight = this.browserGamepad.buttons[15].value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Disposes the gamepad\r\n     */\r\n    public override dispose() {\r\n        super.dispose();\r\n        this.onButtonDownObservable.clear();\r\n        this.onButtonUpObservable.clear();\r\n        this.onPadDownObservable.clear();\r\n        this.onPadUpObservable.clear();\r\n    }\r\n}\r\n", "import { Observable } from \"../Misc/observable\";\r\nimport { Gamepad } from \"./gamepad\";\r\n\r\n/**\r\n * Defines supported buttons for DualShock compatible gamepads\r\n */\r\nexport const enum DualShockButton {\r\n    /** Cross */\r\n    Cross = 0,\r\n    /** Circle */\r\n    Circle = 1,\r\n    /** Square */\r\n    Square = 2,\r\n    /** Triangle */\r\n    Triangle = 3,\r\n    /** L1 */\r\n    L1 = 4,\r\n    /** R1 */\r\n    R1 = 5,\r\n    /** Share */\r\n    Share = 8,\r\n    /** Options */\r\n    Options = 9,\r\n    /** Left stick */\r\n    LeftStick = 10,\r\n    /** Right stick */\r\n    RightStick = 11,\r\n}\r\n\r\n/** Defines values for DualShock DPad  */\r\nexport const enum DualShockDpad {\r\n    /** Up */\r\n    Up = 12,\r\n    /** Down */\r\n    Down = 13,\r\n    /** Left */\r\n    Left = 14,\r\n    /** Right */\r\n    Right = 15,\r\n}\r\n\r\n/**\r\n * Defines a DualShock gamepad\r\n */\r\nexport class DualShockPad extends Gamepad {\r\n    private _leftTrigger: number = 0;\r\n    private _rightTrigger: number = 0;\r\n\r\n    private _onlefttriggerchanged: (value: number) => void;\r\n    private _onrighttriggerchanged: (value: number) => void;\r\n\r\n    private _onbuttondown: (buttonPressed: DualShockButton) => void;\r\n    private _onbuttonup: (buttonReleased: DualShockButton) => void;\r\n    private _ondpaddown: (dPadPressed: DualShockDpad) => void;\r\n    private _ondpadup: (dPadReleased: DualShockDpad) => void;\r\n\r\n    /** Observable raised when a button is pressed */\r\n    public onButtonDownObservable = new Observable<DualShockButton>();\r\n    /** Observable raised when a button is released */\r\n    public onButtonUpObservable = new Observable<DualShockButton>();\r\n    /** Observable raised when a pad is pressed */\r\n    public onPadDownObservable = new Observable<DualShockDpad>();\r\n    /** Observable raised when a pad is released */\r\n    public onPadUpObservable = new Observable<DualShockDpad>();\r\n\r\n    private _buttonCross: number = 0;\r\n    private _buttonCircle: number = 0;\r\n    private _buttonSquare: number = 0;\r\n    private _buttonTriangle: number = 0;\r\n    private _buttonShare: number = 0;\r\n    private _buttonOptions: number = 0;\r\n    private _buttonL1: number = 0;\r\n    private _buttonR1: number = 0;\r\n\r\n    private _buttonLeftStick: number = 0;\r\n    private _buttonRightStick: number = 0;\r\n    private _dPadUp: number = 0;\r\n    private _dPadDown: number = 0;\r\n    private _dPadLeft: number = 0;\r\n    private _dPadRight: number = 0;\r\n\r\n    /**\r\n     * Creates a new DualShock gamepad object\r\n     * @param id defines the id of this gamepad\r\n     * @param index defines its index\r\n     * @param gamepad defines the internal HTML gamepad object\r\n     */\r\n    constructor(id: string, index: number, gamepad: any) {\r\n        super(id.replace(\"STANDARD GAMEPAD\", \"SONY PLAYSTATION DUALSHOCK\"), index, gamepad, 0, 1, 2, 3);\r\n        this.type = Gamepad.DUALSHOCK;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when left trigger is pressed\r\n     * @param callback defines the callback to use\r\n     */\r\n    public onlefttriggerchanged(callback: (value: number) => void) {\r\n        this._onlefttriggerchanged = callback;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when right trigger is pressed\r\n     * @param callback defines the callback to use\r\n     */\r\n    public onrighttriggerchanged(callback: (value: number) => void) {\r\n        this._onrighttriggerchanged = callback;\r\n    }\r\n\r\n    /**\r\n     * Gets the left trigger value\r\n     */\r\n    public get leftTrigger(): number {\r\n        return this._leftTrigger;\r\n    }\r\n    /**\r\n     * Sets the left trigger value\r\n     */\r\n    public set leftTrigger(newValue: number) {\r\n        if (this._onlefttriggerchanged && this._leftTrigger !== newValue) {\r\n            this._onlefttriggerchanged(newValue);\r\n        }\r\n        this._leftTrigger = newValue;\r\n    }\r\n\r\n    /**\r\n     * Gets the right trigger value\r\n     */\r\n    public get rightTrigger(): number {\r\n        return this._rightTrigger;\r\n    }\r\n    /**\r\n     * Sets the right trigger value\r\n     */\r\n    public set rightTrigger(newValue: number) {\r\n        if (this._onrighttriggerchanged && this._rightTrigger !== newValue) {\r\n            this._onrighttriggerchanged(newValue);\r\n        }\r\n        this._rightTrigger = newValue;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when a button is pressed\r\n     * @param callback defines the callback to use\r\n     */\r\n    public onbuttondown(callback: (buttonPressed: DualShockButton) => void) {\r\n        this._onbuttondown = callback;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when a button is released\r\n     * @param callback defines the callback to use\r\n     */\r\n    public onbuttonup(callback: (buttonReleased: DualShockButton) => void) {\r\n        this._onbuttonup = callback;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when a pad is pressed\r\n     * @param callback defines the callback to use\r\n     */\r\n    public ondpaddown(callback: (dPadPressed: DualShockDpad) => void) {\r\n        this._ondpaddown = callback;\r\n    }\r\n\r\n    /**\r\n     * Defines the callback to call when a pad is released\r\n     * @param callback defines the callback to use\r\n     */\r\n    public ondpadup(callback: (dPadReleased: DualShockDpad) => void) {\r\n        this._ondpadup = callback;\r\n    }\r\n\r\n    private _setButtonValue(newValue: number, currentValue: number, buttonType: DualShockButton): number {\r\n        if (newValue !== currentValue) {\r\n            if (newValue === 1) {\r\n                if (this._onbuttondown) {\r\n                    this._onbuttondown(buttonType);\r\n                }\r\n\r\n                this.onButtonDownObservable.notifyObservers(buttonType);\r\n            }\r\n            if (newValue === 0) {\r\n                if (this._onbuttonup) {\r\n                    this._onbuttonup(buttonType);\r\n                }\r\n\r\n                this.onButtonUpObservable.notifyObservers(buttonType);\r\n            }\r\n        }\r\n        return newValue;\r\n    }\r\n\r\n    private _setDpadValue(newValue: number, currentValue: number, buttonType: DualShockDpad): number {\r\n        if (newValue !== currentValue) {\r\n            if (newValue === 1) {\r\n                if (this._ondpaddown) {\r\n                    this._ondpaddown(buttonType);\r\n                }\r\n\r\n                this.onPadDownObservable.notifyObservers(buttonType);\r\n            }\r\n            if (newValue === 0) {\r\n                if (this._ondpadup) {\r\n                    this._ondpadup(buttonType);\r\n                }\r\n\r\n                this.onPadUpObservable.notifyObservers(buttonType);\r\n            }\r\n        }\r\n        return newValue;\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `Cross` button\r\n     */\r\n    public get buttonCross(): number {\r\n        return this._buttonCross;\r\n    }\r\n    /**\r\n     * Sets the value of the `Cross` button\r\n     */\r\n    public set buttonCross(value) {\r\n        this._buttonCross = this._setButtonValue(value, this._buttonCross, DualShockButton.Cross);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `Circle` button\r\n     */\r\n    public get buttonCircle(): number {\r\n        return this._buttonCircle;\r\n    }\r\n    /**\r\n     * Sets the value of the `Circle` button\r\n     */\r\n    public set buttonCircle(value) {\r\n        this._buttonCircle = this._setButtonValue(value, this._buttonCircle, DualShockButton.Circle);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `Square` button\r\n     */\r\n    public get buttonSquare(): number {\r\n        return this._buttonSquare;\r\n    }\r\n    /**\r\n     * Sets the value of the `Square` button\r\n     */\r\n    public set buttonSquare(value) {\r\n        this._buttonSquare = this._setButtonValue(value, this._buttonSquare, DualShockButton.Square);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `Triangle` button\r\n     */\r\n    public get buttonTriangle(): number {\r\n        return this._buttonTriangle;\r\n    }\r\n    /**\r\n     * Sets the value of the `Triangle` button\r\n     */\r\n    public set buttonTriangle(value) {\r\n        this._buttonTriangle = this._setButtonValue(value, this._buttonTriangle, DualShockButton.Triangle);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `Options` button\r\n     */\r\n    public get buttonOptions(): number {\r\n        return this._buttonOptions;\r\n    }\r\n    /**\r\n     * Sets the value of the `Options` button\r\n     */\r\n    public set buttonOptions(value) {\r\n        this._buttonOptions = this._setButtonValue(value, this._buttonOptions, DualShockButton.Options);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `Share` button\r\n     */\r\n    public get buttonShare(): number {\r\n        return this._buttonShare;\r\n    }\r\n    /**\r\n     * Sets the value of the `Share` button\r\n     */\r\n    public set buttonShare(value) {\r\n        this._buttonShare = this._setButtonValue(value, this._buttonShare, DualShockButton.Share);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `L1` button\r\n     */\r\n    public get buttonL1(): number {\r\n        return this._buttonL1;\r\n    }\r\n    /**\r\n     * Sets the value of the `L1` button\r\n     */\r\n    public set buttonL1(value) {\r\n        this._buttonL1 = this._setButtonValue(value, this._buttonL1, DualShockButton.L1);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the `R1` button\r\n     */\r\n    public get buttonR1(): number {\r\n        return this._buttonR1;\r\n    }\r\n    /**\r\n     * Sets the value of the `R1` button\r\n     */\r\n    public set buttonR1(value) {\r\n        this._buttonR1 = this._setButtonValue(value, this._buttonR1, DualShockButton.R1);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the Left joystick\r\n     */\r\n    public get buttonLeftStick(): number {\r\n        return this._buttonLeftStick;\r\n    }\r\n    /**\r\n     * Sets the value of the Left joystick\r\n     */\r\n    public set buttonLeftStick(value) {\r\n        this._buttonLeftStick = this._setButtonValue(value, this._buttonLeftStick, DualShockButton.LeftStick);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of the Right joystick\r\n     */\r\n    public get buttonRightStick(): number {\r\n        return this._buttonRightStick;\r\n    }\r\n    /**\r\n     * Sets the value of the Right joystick\r\n     */\r\n    public set buttonRightStick(value) {\r\n        this._buttonRightStick = this._setButtonValue(value, this._buttonRightStick, DualShockButton.RightStick);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of D-pad up\r\n     */\r\n    public get dPadUp(): number {\r\n        return this._dPadUp;\r\n    }\r\n    /**\r\n     * Sets the value of D-pad up\r\n     */\r\n    public set dPadUp(value) {\r\n        this._dPadUp = this._setDpadValue(value, this._dPadUp, DualShockDpad.Up);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of D-pad down\r\n     */\r\n    public get dPadDown(): number {\r\n        return this._dPadDown;\r\n    }\r\n    /**\r\n     * Sets the value of D-pad down\r\n     */\r\n    public set dPadDown(value) {\r\n        this._dPadDown = this._setDpadValue(value, this._dPadDown, DualShockDpad.Down);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of D-pad left\r\n     */\r\n    public get dPadLeft(): number {\r\n        return this._dPadLeft;\r\n    }\r\n    /**\r\n     * Sets the value of D-pad left\r\n     */\r\n    public set dPadLeft(value) {\r\n        this._dPadLeft = this._setDpadValue(value, this._dPadLeft, DualShockDpad.Left);\r\n    }\r\n\r\n    /**\r\n     * Gets the value of D-pad right\r\n     */\r\n    public get dPadRight(): number {\r\n        return this._dPadRight;\r\n    }\r\n    /**\r\n     * Sets the value of D-pad right\r\n     */\r\n    public set dPadRight(value) {\r\n        this._dPadRight = this._setDpadValue(value, this._dPadRight, DualShockDpad.Right);\r\n    }\r\n\r\n    /**\r\n     * Force the gamepad to synchronize with device values\r\n     */\r\n    public override update() {\r\n        super.update();\r\n        this.buttonCross = this.browserGamepad.buttons[0].value;\r\n        this.buttonCircle = this.browserGamepad.buttons[1].value;\r\n        this.buttonSquare = this.browserGamepad.buttons[2].value;\r\n        this.buttonTriangle = this.browserGamepad.buttons[3].value;\r\n        this.buttonL1 = this.browserGamepad.buttons[4].value;\r\n        this.buttonR1 = this.browserGamepad.buttons[5].value;\r\n        this.leftTrigger = this.browserGamepad.buttons[6].value;\r\n        this.rightTrigger = this.browserGamepad.buttons[7].value;\r\n        this.buttonShare = this.browserGamepad.buttons[8].value;\r\n        this.buttonOptions = this.browserGamepad.buttons[9].value;\r\n        this.buttonLeftStick = this.browserGamepad.buttons[10].value;\r\n        this.buttonRightStick = this.browserGamepad.buttons[11].value;\r\n        this.dPadUp = this.browserGamepad.buttons[12].value;\r\n        this.dPadDown = this.browserGamepad.buttons[13].value;\r\n        this.dPadLeft = this.browserGamepad.buttons[14].value;\r\n        this.dPadRight = this.browserGamepad.buttons[15].value;\r\n    }\r\n\r\n    /**\r\n     * Disposes the gamepad\r\n     */\r\n    public override dispose() {\r\n        super.dispose();\r\n        this.onButtonDownObservable.clear();\r\n        this.onButtonUpObservable.clear();\r\n        this.onPadDownObservable.clear();\r\n        this.onPadUpObservable.clear();\r\n    }\r\n}\r\n", "import { Observable } from \"../Misc/observable\";\r\nimport { IsWindowObjectExist } from \"../Misc/domManagement\";\r\nimport type { Nullable } from \"../types\";\r\nimport type { Scene } from \"../scene\";\r\nimport { Xbox360Pad } from \"./xboxGamepad\";\r\nimport { Gamepad, GenericPad } from \"./gamepad\";\r\nimport { DualShockPad } from \"./dualShockGamepad\";\r\nimport { Tools } from \"../Misc/tools\";\r\nimport { AbstractEngine } from \"core/Engines/abstractEngine\";\r\n/**\r\n * Manager for handling gamepads\r\n */\r\nexport class GamepadManager {\r\n    private _babylonGamepads: Array<Gamepad> = [];\r\n    private _oneGamepadConnected: boolean = false;\r\n\r\n    /** @internal */\r\n    public _isMonitoring: boolean = false;\r\n    private _gamepadEventSupported: boolean;\r\n    private _gamepadSupport?: () => Array<any>;\r\n\r\n    /**\r\n     * observable to be triggered when the gamepad controller has been connected\r\n     */\r\n    public onGamepadConnectedObservable: Observable<Gamepad>;\r\n\r\n    /**\r\n     * observable to be triggered when the gamepad controller has been disconnected\r\n     */\r\n    public onGamepadDisconnectedObservable = new Observable<Gamepad>();\r\n\r\n    private _onGamepadConnectedEvent: Nullable<(evt: any) => void>;\r\n    private _onGamepadDisconnectedEvent: Nullable<(evt: any) => void>;\r\n\r\n    /**\r\n     * Initializes the gamepad manager\r\n     * @param _scene BabylonJS scene\r\n     */\r\n    constructor(private _scene?: Scene) {\r\n        if (!IsWindowObjectExist()) {\r\n            this._gamepadEventSupported = false;\r\n        } else {\r\n            this._gamepadEventSupported = \"GamepadEvent\" in window;\r\n            this._gamepadSupport = navigator && navigator.getGamepads;\r\n        }\r\n\r\n        this.onGamepadConnectedObservable = new Observable<Gamepad>((observer) => {\r\n            // This will be used to raise the onGamepadConnected for all gamepads ALREADY connected\r\n            for (const i in this._babylonGamepads) {\r\n                const gamepad = this._babylonGamepads[i];\r\n                if (gamepad && gamepad._isConnected) {\r\n                    this.onGamepadConnectedObservable.notifyObserver(observer, gamepad);\r\n                }\r\n            }\r\n        });\r\n\r\n        this._onGamepadConnectedEvent = (evt) => {\r\n            const gamepad = evt.gamepad;\r\n\r\n            if (gamepad.index in this._babylonGamepads) {\r\n                if (this._babylonGamepads[gamepad.index].isConnected) {\r\n                    return;\r\n                }\r\n            }\r\n\r\n            let newGamepad: Gamepad;\r\n\r\n            if (this._babylonGamepads[gamepad.index]) {\r\n                newGamepad = this._babylonGamepads[gamepad.index];\r\n                newGamepad.browserGamepad = gamepad;\r\n                newGamepad._isConnected = true;\r\n            } else {\r\n                newGamepad = this._addNewGamepad(gamepad);\r\n            }\r\n            this.onGamepadConnectedObservable.notifyObservers(newGamepad);\r\n            this._startMonitoringGamepads();\r\n        };\r\n\r\n        this._onGamepadDisconnectedEvent = (evt) => {\r\n            const gamepad = evt.gamepad;\r\n\r\n            // Remove the gamepad from the list of gamepads to monitor.\r\n            for (const i in this._babylonGamepads) {\r\n                if (this._babylonGamepads[i].index === gamepad.index) {\r\n                    const disconnectedGamepad = this._babylonGamepads[i];\r\n                    disconnectedGamepad._isConnected = false;\r\n\r\n                    this.onGamepadDisconnectedObservable.notifyObservers(disconnectedGamepad);\r\n                    if (disconnectedGamepad.dispose) {\r\n                        disconnectedGamepad.dispose();\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        };\r\n\r\n        if (this._gamepadSupport) {\r\n            //first add already-connected gamepads\r\n            this._updateGamepadObjects();\r\n            if (this._babylonGamepads.length) {\r\n                this._startMonitoringGamepads();\r\n            }\r\n            // Checking if the gamepad connected event is supported (like in Firefox)\r\n            if (this._gamepadEventSupported) {\r\n                const hostWindow = this._scene ? this._scene.getEngine().getHostWindow() : window;\r\n\r\n                if (hostWindow) {\r\n                    hostWindow.addEventListener(\"gamepadconnected\", this._onGamepadConnectedEvent, false);\r\n                    hostWindow.addEventListener(\"gamepaddisconnected\", this._onGamepadDisconnectedEvent, false);\r\n                }\r\n            } else {\r\n                this._startMonitoringGamepads();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * The gamepads in the game pad manager\r\n     */\r\n    public get gamepads(): Gamepad[] {\r\n        return this._babylonGamepads;\r\n    }\r\n\r\n    /**\r\n     * Get the gamepad controllers based on type\r\n     * @param type The type of gamepad controller\r\n     * @returns Nullable gamepad\r\n     */\r\n    public getGamepadByType(type: number = Gamepad.XBOX): Nullable<Gamepad> {\r\n        for (const gamepad of this._babylonGamepads) {\r\n            if (gamepad && gamepad.type === type) {\r\n                return gamepad;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Disposes the gamepad manager\r\n     */\r\n    public dispose() {\r\n        if (this._gamepadEventSupported) {\r\n            if (this._onGamepadConnectedEvent) {\r\n                window.removeEventListener(\"gamepadconnected\", this._onGamepadConnectedEvent);\r\n            }\r\n\r\n            if (this._onGamepadDisconnectedEvent) {\r\n                window.removeEventListener(\"gamepaddisconnected\", this._onGamepadDisconnectedEvent);\r\n            }\r\n            this._onGamepadConnectedEvent = null;\r\n            this._onGamepadDisconnectedEvent = null;\r\n        }\r\n\r\n        for (const gamepad of this._babylonGamepads) {\r\n            gamepad.dispose();\r\n        }\r\n\r\n        this.onGamepadConnectedObservable.clear();\r\n        this.onGamepadDisconnectedObservable.clear();\r\n\r\n        this._oneGamepadConnected = false;\r\n        this._stopMonitoringGamepads();\r\n        this._babylonGamepads = [];\r\n    }\r\n\r\n    private _addNewGamepad(gamepad: any): Gamepad {\r\n        if (!this._oneGamepadConnected) {\r\n            this._oneGamepadConnected = true;\r\n        }\r\n\r\n        let newGamepad;\r\n        const dualShock: boolean = (<string>gamepad.id).search(\"054c\") !== -1 && (<string>gamepad.id).search(\"0ce6\") === -1;\r\n        const xboxOne: boolean = (<string>gamepad.id).search(\"Xbox One\") !== -1;\r\n        if (\r\n            xboxOne ||\r\n            (<string>gamepad.id).search(\"Xbox 360\") !== -1 ||\r\n            (<string>gamepad.id).search(\"xinput\") !== -1 ||\r\n            ((<string>gamepad.id).search(\"045e\") !== -1 && (<string>gamepad.id).search(\"Surface Dock\") === -1)\r\n        ) {\r\n            // make sure the Surface Dock Extender is not detected as an xbox controller\r\n            newGamepad = new Xbox360Pad(gamepad.id, gamepad.index, gamepad, xboxOne);\r\n        } else if (dualShock) {\r\n            newGamepad = new DualShockPad(gamepad.id, gamepad.index, gamepad);\r\n        } else {\r\n            newGamepad = new GenericPad(gamepad.id, gamepad.index, gamepad);\r\n        }\r\n        this._babylonGamepads[newGamepad.index] = newGamepad;\r\n        return newGamepad;\r\n    }\r\n\r\n    private _startMonitoringGamepads() {\r\n        if (!this._isMonitoring) {\r\n            this._isMonitoring = true;\r\n            //back-comp\r\n            this._checkGamepadsStatus();\r\n        }\r\n    }\r\n\r\n    private _stopMonitoringGamepads() {\r\n        this._isMonitoring = false;\r\n    }\r\n\r\n    private _loggedErrors: number[];\r\n\r\n    /** @internal */\r\n    public _checkGamepadsStatus() {\r\n        // Hack to be compatible Chrome\r\n        this._updateGamepadObjects();\r\n\r\n        for (const i in this._babylonGamepads) {\r\n            const gamepad = this._babylonGamepads[i];\r\n            if (!gamepad || !gamepad.isConnected) {\r\n                continue;\r\n            }\r\n            try {\r\n                gamepad.update();\r\n            } catch {\r\n                if (this._loggedErrors.indexOf(gamepad.index) === -1) {\r\n                    Tools.Warn(`Error updating gamepad ${gamepad.id}`);\r\n                    this._loggedErrors.push(gamepad.index);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this._isMonitoring) {\r\n            AbstractEngine.QueueNewFrame(() => {\r\n                this._checkGamepadsStatus();\r\n            });\r\n        }\r\n    }\r\n\r\n    // This function is called only on Chrome, which does not properly support\r\n    // connection/disconnection events and forces you to recopy again the gamepad object\r\n    private _updateGamepadObjects() {\r\n        const gamepads = navigator.getGamepads ? navigator.getGamepads() : [];\r\n        for (let i = 0; i < gamepads.length; i++) {\r\n            const gamepad = gamepads[i];\r\n            if (gamepad) {\r\n                if (!this._babylonGamepads[gamepad.index]) {\r\n                    const newGamepad = this._addNewGamepad(gamepad);\r\n                    this.onGamepadConnectedObservable.notifyObservers(newGamepad);\r\n                } else {\r\n                    // Forced to copy again this object for Chrome for unknown reason\r\n                    this._babylonGamepads[i].browserGamepad = gamepad;\r\n\r\n                    if (!this._babylonGamepads[i].isConnected) {\r\n                        this._babylonGamepads[i]._isConnected = true;\r\n                        this.onGamepadConnectedObservable.notifyObservers(this._babylonGamepads[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n", "import type { Nullable } from \"../types\";\r\nimport { Scene } from \"../scene\";\r\nimport type { ISceneComponent } from \"../sceneComponent\";\r\nimport { SceneComponentConstants } from \"../sceneComponent\";\r\nimport { GamepadManager } from \"./gamepadManager\";\r\n\r\nimport { FreeCameraInputsManager } from \"../Cameras/freeCameraInputsManager\";\r\nimport { FreeCameraGamepadInput } from \"../Cameras/Inputs/freeCameraGamepadInput\";\r\nimport { ArcRotateCameraInputsManager } from \"../Cameras/arcRotateCameraInputsManager\";\r\nimport { ArcRotateCameraGamepadInput } from \"../Cameras/Inputs/arcRotateCameraGamepadInput\";\r\n\r\ndeclare module \"../scene\" {\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    export interface Scene {\r\n        /** @internal */\r\n        _gamepadManager: Nullable<GamepadManager>;\r\n\r\n        /**\r\n         * Gets the gamepad manager associated with the scene\r\n         * @see https://doc.babylonjs.com/features/featuresDeepDive/input/gamepads\r\n         */\r\n        gamepadManager: GamepadManager;\r\n    }\r\n}\r\n\r\nObject.defineProperty(Scene.prototype, \"gamepadManager\", {\r\n    get: function (this: Scene) {\r\n        if (!this._gamepadManager) {\r\n            this._gamepadManager = new GamepadManager(this);\r\n            let component = this._getComponent(SceneComponentConstants.NAME_GAMEPAD) as GamepadSystemSceneComponent;\r\n            if (!component) {\r\n                component = new GamepadSystemSceneComponent(this);\r\n                this._addComponent(component);\r\n            }\r\n        }\r\n\r\n        return this._gamepadManager;\r\n    },\r\n    enumerable: true,\r\n    configurable: true,\r\n});\r\n\r\ndeclare module \"../Cameras/freeCameraInputsManager\" {\r\n    /**\r\n     * Interface representing a free camera inputs manager\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    export interface FreeCameraInputsManager {\r\n        /**\r\n         * Adds gamepad input support to the FreeCameraInputsManager.\r\n         * @returns the FreeCameraInputsManager\r\n         */\r\n        addGamepad(): FreeCameraInputsManager;\r\n    }\r\n}\r\n\r\n/**\r\n * Adds a gamepad to the free camera inputs manager\r\n * @returns the FreeCameraInputsManager\r\n */\r\nFreeCameraInputsManager.prototype.addGamepad = function (): FreeCameraInputsManager {\r\n    this.add(new FreeCameraGamepadInput());\r\n    return this;\r\n};\r\n\r\ndeclare module \"../Cameras/arcRotateCameraInputsManager\" {\r\n    /**\r\n     * Interface representing an arc rotate camera inputs manager\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    export interface ArcRotateCameraInputsManager {\r\n        /**\r\n         * Adds gamepad input support to the ArcRotateCamera InputManager.\r\n         * @returns the camera inputs manager\r\n         */\r\n        addGamepad(): ArcRotateCameraInputsManager;\r\n    }\r\n}\r\n\r\n/**\r\n * Adds a gamepad to the arc rotate camera inputs manager\r\n * @returns the camera inputs manager\r\n */\r\nArcRotateCameraInputsManager.prototype.addGamepad = function (): ArcRotateCameraInputsManager {\r\n    this.add(new ArcRotateCameraGamepadInput());\r\n    return this;\r\n};\r\n\r\n/**\r\n * Defines the gamepad scene component responsible to manage gamepads in a given scene\r\n */\r\nexport class GamepadSystemSceneComponent implements ISceneComponent {\r\n    /**\r\n     * The component name helpfull to identify the component in the list of scene components.\r\n     */\r\n    public readonly name = SceneComponentConstants.NAME_GAMEPAD;\r\n\r\n    /**\r\n     * The scene the component belongs to.\r\n     */\r\n    public scene: Scene;\r\n\r\n    /**\r\n     * Creates a new instance of the component for the given scene\r\n     * @param scene Defines the scene to register the component in\r\n     */\r\n    constructor(scene: Scene) {\r\n        this.scene = scene;\r\n    }\r\n\r\n    /**\r\n     * Registers the component in a given scene\r\n     */\r\n    public register(): void {\r\n        // Nothing to do for gamepads\r\n    }\r\n\r\n    /**\r\n     * Rebuilds the elements related to this component in case of\r\n     * context lost for instance.\r\n     */\r\n    public rebuild(): void {\r\n        // Nothing to do for gamepads\r\n    }\r\n\r\n    /**\r\n     * Disposes the component and the associated resources\r\n     */\r\n    public dispose(): void {\r\n        const gamepadManager = this.scene._gamepadManager;\r\n        if (gamepadManager) {\r\n            gamepadManager.dispose();\r\n            this.scene._gamepadManager = null;\r\n        }\r\n    }\r\n}\r\n", "import { TouchCamera } from \"./touchCamera\";\r\nimport { Node } from \"../node\";\r\nimport type { FreeCameraGamepadInput } from \"../Cameras/Inputs/freeCameraGamepadInput\";\r\nimport type { Scene } from \"../scene\";\r\nimport { Vector3 } from \"../Maths/math.vector\";\r\nimport { Camera } from \"./camera\";\r\n\r\nimport \"../Gamepads/gamepadSceneComponent\";\r\n\r\nNode.AddNodeConstructor(\"FreeCamera\", (name, scene) => {\r\n    // Forcing to use the Universal camera\r\n    return () => new UniversalCamera(name, Vector3.Zero(), scene);\r\n});\r\n\r\n/**\r\n * The Universal Camera is the one to choose for first person shooter type games, and works with all the keyboard, mouse, touch and gamepads. This replaces the earlier Free Camera,\r\n * which still works and will still be found in many Playgrounds.\r\n * @see https://doc.babylonjs.com/features/featuresDeepDive/cameras/camera_introduction#universal-camera\r\n */\r\nexport class UniversalCamera extends TouchCamera {\r\n    /**\r\n     * Defines the gamepad rotation sensibility.\r\n     * This is the threshold from when rotation starts to be accounted for to prevent jittering.\r\n     */\r\n    public get gamepadAngularSensibility(): number {\r\n        const gamepad = <FreeCameraGamepadInput>this.inputs.attached[\"gamepad\"];\r\n        if (gamepad) {\r\n            return gamepad.gamepadAngularSensibility;\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    public set gamepadAngularSensibility(value: number) {\r\n        const gamepad = <FreeCameraGamepadInput>this.inputs.attached[\"gamepad\"];\r\n        if (gamepad) {\r\n            gamepad.gamepadAngularSensibility = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Defines the gamepad move sensibility.\r\n     * This is the threshold from when moving starts to be accounted for to prevent jittering.\r\n     */\r\n    public get gamepadMoveSensibility(): number {\r\n        const gamepad = <FreeCameraGamepadInput>this.inputs.attached[\"gamepad\"];\r\n        if (gamepad) {\r\n            return gamepad.gamepadMoveSensibility;\r\n        }\r\n\r\n        return 0;\r\n    }\r\n\r\n    public set gamepadMoveSensibility(value: number) {\r\n        const gamepad = <FreeCameraGamepadInput>this.inputs.attached[\"gamepad\"];\r\n        if (gamepad) {\r\n            gamepad.gamepadMoveSensibility = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * The Universal Camera is the one to choose for first person shooter type games, and works with all the keyboard, mouse, touch and gamepads. This replaces the earlier Free Camera,\r\n     * which still works and will still be found in many Playgrounds.\r\n     * @see https://doc.babylonjs.com/features/featuresDeepDive/cameras/camera_introduction#universal-camera\r\n     * @param name Define the name of the camera in the scene\r\n     * @param position Define the start position of the camera in the scene\r\n     * @param scene Define the scene the camera belongs to\r\n     */\r\n    constructor(name: string, position: Vector3, scene?: Scene) {\r\n        super(name, position, scene);\r\n        this.inputs.addGamepad();\r\n    }\r\n\r\n    /**\r\n     * Gets the current object class name.\r\n     * @returns the class name\r\n     */\r\n    public override getClassName(): string {\r\n        return \"UniversalCamera\";\r\n    }\r\n}\r\n\r\nCamera._CreateDefaultParsedCamera = (name: string, scene: Scene) => {\r\n    return new UniversalCamera(name, Vector3.Zero(), scene);\r\n};\r\n", "import type {\r\n    Color4,\r\n    Scene,\r\n    FrameGraphTextureHandle,\r\n    Camera,\r\n    FrameGraphObjectList,\r\n    IShadowLight,\r\n    FrameGraphShadowGeneratorTask,\r\n    FrameGraphObjectRendererTask,\r\n    FrameGraph,\r\n    NodeRenderGraphBlock,\r\n} from \"core/index\";\r\n\r\n/**\r\n * Description of a custom block to be used in the node render graph editor\r\n */\r\nexport interface INodeRenderGraphCustomBlockDescription {\r\n    /** Block name. It will be used as the block name in the left menu of the editor. Spaces must be replaced by underscores in the name. */\r\n    name: string;\r\n    /** Description (tooltip) of the block. */\r\n    description: string;\r\n    /** Category of the block. Spaces must be replaced by underscores in the category name. */\r\n    menu: string;\r\n    /** Factory function to create the block. */\r\n    factory: (frameGraph: FrameGraph, scene: Scene) => NodeRenderGraphBlock;\r\n}\r\n\r\n/**\r\n * Interface used to configure the node render graph editor\r\n */\r\nexport interface INodeRenderGraphEditorOptions {\r\n    /** Define the URL to load node editor script from */\r\n    editorURL?: string;\r\n    /** Additional configuration for the FGE */\r\n    nodeRenderGraphEditorConfig?: {\r\n        backgroundColor?: Color4;\r\n        hostScene?: Scene;\r\n        customBlockDescriptions?: INodeRenderGraphCustomBlockDescription[];\r\n    };\r\n}\r\n\r\n/**\r\n * Options that can be passed to the node render graph build method\r\n */\r\nexport interface INodeRenderGraphCreateOptions {\r\n    /** If true, textures created by the node render graph will be visible in the inspector, for easier debugging (default: false) */\r\n    debugTextures?: boolean;\r\n    /** Rebuild the node render graph when the screen is resized (default: true) */\r\n    rebuildGraphOnEngineResize?: boolean;\r\n    /** Defines if the build should log activity (default: false) */\r\n    verbose?: boolean;\r\n    /** Defines if the autoConfigure method should be called when initializing blocks (default: false) */\r\n    autoConfigure?: boolean;\r\n    /** If true, external inputs like object lists and cameras will be filled with default values, taken from the scene. Note that external textures are not concerned (default: true). */\r\n    autoFillExternalInputs?: boolean;\r\n}\r\n\r\n/**\r\n * Defines the kind of connection point for node render graph nodes\r\n */\r\nexport enum NodeRenderGraphBlockConnectionPointTypes {\r\n    /** General purpose texture */\r\n    Texture = 0x00000001,\r\n    /** Back buffer color texture */\r\n    TextureBackBuffer = 0x00000002,\r\n    /** Back buffer depth/stencil attachment */\r\n    TextureBackBufferDepthStencilAttachment = 0x00000004,\r\n    /** Depth/stencil attachment */\r\n    TextureDepthStencilAttachment = 0x00000008,\r\n    /** Depth (in view space) geometry texture */\r\n    TextureViewDepth = 0x00000010,\r\n    /** Normal (in view space) geometry texture */\r\n    TextureViewNormal = 0x00000020,\r\n    /** Albedo geometry texture */\r\n    TextureAlbedo = 0x00000040,\r\n    /** Reflectivity geometry texture */\r\n    TextureReflectivity = 0x00000080,\r\n    /** Position (in world space) geometry texture */\r\n    TextureWorldPosition = 0x00000100,\r\n    /** Velocity geometry texture */\r\n    TextureVelocity = 0x00000200,\r\n    /** Irradiance geometry texture */\r\n    TextureIrradiance = 0x00000400,\r\n    /** Albedo (sqrt) geometry texture */\r\n    TextureAlbedoSqrt = 0x00000800,\r\n    /** Depth (in screen space) geometry texture */\r\n    TextureScreenDepth = 0x00001000,\r\n    /** Normal (in world space) geometry texture */\r\n    TextureWorldNormal = 0x00002000,\r\n    /** Position (in local space) geometry texture */\r\n    TextureLocalPosition = 0x00004000,\r\n    /** Linear velocity geometry texture */\r\n    TextureLinearVelocity = 0x00008000,\r\n    /** Normalied depth (in view space) geometry texture */\r\n    TextureNormalizedViewDepth = 0x00010000,\r\n\r\n    /** Bit field for all textures but back buffer depth/stencil */\r\n    TextureAllButBackBufferDepthStencil = 0x000ffffb,\r\n    /** Bit field for all textures but back buffer color and depth/stencil */\r\n    TextureAllButBackBuffer = 0x000ffff9,\r\n    /** Bit field for all textures */\r\n    TextureAll = 0x000fffff,\r\n\r\n    /** Resource container */\r\n    ResourceContainer = 0x00100000,\r\n    /** Shadow generator */\r\n    ShadowGenerator = 0x00200000,\r\n    /** Light */\r\n    ShadowLight = 0x00400000,\r\n    /** Camera */\r\n    Camera = 0x01000000,\r\n    /** List of objects (meshes, particle systems, sprites) */\r\n    ObjectList = 0x02000000,\r\n\r\n    /** Detect type based on connection */\r\n    AutoDetect = 0x10000000,\r\n    /** Output type that will be defined by input type */\r\n    BasedOnInput = 0x20000000,\r\n    /** Undefined */\r\n    Undefined = 0x40000000,\r\n    /** Custom object */\r\n    Object = 0x80000000,\r\n    /** Bitmask of all types */\r\n    All = 0xffffffff,\r\n}\r\n\r\n/**\r\n * Enum used to define the compatibility state between two connection points\r\n */\r\nexport const enum NodeRenderGraphConnectionPointCompatibilityStates {\r\n    /** Points are compatibles */\r\n    Compatible,\r\n    /** Points are incompatible because of their types */\r\n    TypeIncompatible,\r\n    /** Points are incompatible because they are in the same hierarchy **/\r\n    HierarchyIssue,\r\n}\r\n\r\n/**\r\n * Defines the direction of a connection point\r\n */\r\nexport const enum NodeRenderGraphConnectionPointDirection {\r\n    /** Input */\r\n    Input,\r\n    /** Output */\r\n    Output,\r\n}\r\n\r\n/**\r\n * Defines the type of a connection point value\r\n */\r\nexport type NodeRenderGraphBlockConnectionPointValueType =\r\n    | FrameGraphTextureHandle\r\n    | Camera\r\n    | FrameGraphObjectList\r\n    | IShadowLight\r\n    | FrameGraphShadowGeneratorTask\r\n    | FrameGraphObjectRendererTask;\r\n", "import type {\r\n    Nullable,\r\n    NodeRenderGraphBlock,\r\n    NodeRenderGraphBlockConnectionPointValueType,\r\n    NodeRenderGraphInputBlock,\r\n    IShadowLight,\r\n    FrameGraphShadowGeneratorTask,\r\n} from \"core/index\";\r\nimport { Observable } from \"../../Misc/observable\";\r\nimport { NodeRenderGraphBlockConnectionPointTypes, NodeRenderGraphConnectionPointCompatibilityStates, NodeRenderGraphConnectionPointDirection } from \"./Types/nodeRenderGraphTypes\";\r\n\r\n/**\r\n * Defines a connection point for a block\r\n */\r\nexport class NodeRenderGraphConnectionPoint {\r\n    private readonly _ownerBlock: NodeRenderGraphBlock;\r\n    private _connectedPoint: Nullable<NodeRenderGraphConnectionPoint> = null;\r\n\r\n    /** @internal */\r\n    public _acceptedConnectionPointType: Nullable<NodeRenderGraphConnectionPoint> = null;\r\n\r\n    private _endpoints = new Array<NodeRenderGraphConnectionPoint>();\r\n    private readonly _direction: NodeRenderGraphConnectionPointDirection;\r\n    private _type = NodeRenderGraphBlockConnectionPointTypes.Undefined;\r\n\r\n    /** @internal */\r\n    public _linkedConnectionSource: Nullable<NodeRenderGraphConnectionPoint> = null;\r\n\r\n    /** @internal */\r\n    public _isMainLinkSource = false;\r\n\r\n    /** @internal */\r\n    public _typeConnectionSource: Nullable<NodeRenderGraphConnectionPoint | (() => NodeRenderGraphConnectionPoint)> = null;\r\n\r\n    /** @internal */\r\n    public _defaultConnectionPointType: Nullable<NodeRenderGraphBlockConnectionPointTypes> = null;\r\n\r\n    /** Gets the direction of the point */\r\n    public get direction() {\r\n        return this._direction;\r\n    }\r\n\r\n    /**\r\n     * Checks if the value is a texture handle\r\n     * @param value The value to check\r\n     * @returns True if the value is a texture handle\r\n     */\r\n    public static IsTextureHandle(value: NodeRenderGraphBlockConnectionPointValueType | undefined): boolean {\r\n        return value !== undefined && Number.isFinite(value);\r\n    }\r\n\r\n    /**\r\n     * Checks if the value is a shadow generator task\r\n     * @param value The value to check\r\n     * @returns True if the value is a shadow generator\r\n     */\r\n    public static IsShadowGenerator(value: NodeRenderGraphBlockConnectionPointValueType | undefined): boolean {\r\n        return value !== undefined && (value as FrameGraphShadowGeneratorTask).mapSize !== undefined;\r\n    }\r\n\r\n    /**\r\n     * Checks if the value is a shadow light\r\n     * @param value The value to check\r\n     * @returns True if the value is a shadow light\r\n     */\r\n    public static IsShadowLight(value: NodeRenderGraphBlockConnectionPointValueType | undefined): boolean {\r\n        return value !== undefined && (value as IShadowLight).setShadowProjectionMatrix !== undefined;\r\n    }\r\n\r\n    /**\r\n     * The value stored in this connection point\r\n     */\r\n    public value: NodeRenderGraphBlockConnectionPointValueType | undefined;\r\n\r\n    /** Indicates that this connection point needs dual validation before being connected to another point */\r\n    public needDualDirectionValidation: boolean = false;\r\n\r\n    /**\r\n     * Gets or sets the additional types supported by this connection point\r\n     */\r\n    public acceptedConnectionPointTypes: NodeRenderGraphBlockConnectionPointTypes[] = [];\r\n\r\n    /**\r\n     * Gets or sets the additional types excluded by this connection point\r\n     */\r\n    public excludedConnectionPointTypes: NodeRenderGraphBlockConnectionPointTypes[] = [];\r\n\r\n    /**\r\n     * Observable triggered when this point is connected\r\n     */\r\n    public onConnectionObservable = new Observable<NodeRenderGraphConnectionPoint>();\r\n\r\n    /**\r\n     * Observable triggered when this point is disconnected\r\n     */\r\n    public onDisconnectionObservable = new Observable<NodeRenderGraphConnectionPoint>();\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that this connection point is exposed on a frame\r\n     */\r\n    public isExposedOnFrame: boolean = false;\r\n\r\n    /**\r\n     * Gets or sets number indicating the position that the port is exposed to on a frame\r\n     */\r\n    public exposedPortPosition: number = -1;\r\n\r\n    /**\r\n     * Gets or sets the connection point type (default is Undefined)\r\n     */\r\n    public get type(): NodeRenderGraphBlockConnectionPointTypes {\r\n        if (this._type === NodeRenderGraphBlockConnectionPointTypes.AutoDetect) {\r\n            if (this._ownerBlock.isInput) {\r\n                return (this._ownerBlock as NodeRenderGraphInputBlock).type;\r\n            }\r\n\r\n            if (this._connectedPoint) {\r\n                return this._connectedPoint.type;\r\n            }\r\n\r\n            if (this._linkedConnectionSource) {\r\n                if (this._linkedConnectionSource.isConnected) {\r\n                    return this._linkedConnectionSource.type;\r\n                }\r\n                if (this._linkedConnectionSource._defaultConnectionPointType) {\r\n                    return this._linkedConnectionSource._defaultConnectionPointType;\r\n                }\r\n            }\r\n\r\n            if (this._defaultConnectionPointType) {\r\n                return this._defaultConnectionPointType;\r\n            }\r\n        }\r\n\r\n        if (this._type === NodeRenderGraphBlockConnectionPointTypes.BasedOnInput) {\r\n            if (this._typeConnectionSource) {\r\n                const typeConnectionSource = typeof this._typeConnectionSource === \"function\" ? this._typeConnectionSource() : this._typeConnectionSource;\r\n                if (!typeConnectionSource.isConnected) {\r\n                    return this._defaultConnectionPointType ?? typeConnectionSource.type;\r\n                }\r\n                return typeConnectionSource._connectedPoint!.type;\r\n            } else if (this._defaultConnectionPointType) {\r\n                return this._defaultConnectionPointType;\r\n            }\r\n        }\r\n\r\n        return this._type;\r\n    }\r\n\r\n    public set type(value: NodeRenderGraphBlockConnectionPointTypes) {\r\n        this._type = value;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the connection point name\r\n     */\r\n    public name: string;\r\n\r\n    /**\r\n     * Gets or sets the connection point display name\r\n     */\r\n    public displayName: string;\r\n\r\n    /**\r\n     * Gets or sets a boolean indicating that this connection point can be omitted\r\n     */\r\n    public isOptional: boolean;\r\n\r\n    /**\r\n     * Gets a boolean indicating that the current point is connected to another NodeRenderGraphBlock\r\n     */\r\n    public get isConnected(): boolean {\r\n        return this.connectedPoint !== null || this.hasEndpoints;\r\n    }\r\n\r\n    /** Get the other side of the connection (if any) */\r\n    public get connectedPoint(): Nullable<NodeRenderGraphConnectionPoint> {\r\n        return this._connectedPoint;\r\n    }\r\n\r\n    /** Get the block that owns this connection point */\r\n    public get ownerBlock(): NodeRenderGraphBlock {\r\n        return this._ownerBlock;\r\n    }\r\n\r\n    /** Get the block connected on the other side of this connection (if any) */\r\n    public get sourceBlock(): Nullable<NodeRenderGraphBlock> {\r\n        if (!this._connectedPoint) {\r\n            return null;\r\n        }\r\n\r\n        return this._connectedPoint.ownerBlock;\r\n    }\r\n\r\n    /** Get the block connected on the endpoints of this connection (if any) */\r\n    public get connectedBlocks(): Array<NodeRenderGraphBlock> {\r\n        if (this._endpoints.length === 0) {\r\n            return [];\r\n        }\r\n\r\n        return this._endpoints.map((e) => e.ownerBlock);\r\n    }\r\n\r\n    /** Gets the list of connected endpoints */\r\n    public get endpoints() {\r\n        return this._endpoints;\r\n    }\r\n\r\n    /** Gets a boolean indicating if that output point is connected to at least one input */\r\n    public get hasEndpoints(): boolean {\r\n        return this._endpoints && this._endpoints.length > 0;\r\n    }\r\n\r\n    /** Get the inner type (ie AutoDetect for instance instead of the inferred one) */\r\n    public get innerType() {\r\n        if (this._linkedConnectionSource && !this._isMainLinkSource && this._linkedConnectionSource.isConnected) {\r\n            return this.type;\r\n        }\r\n        return this._type;\r\n    }\r\n\r\n    /**\r\n     * Creates a block suitable to be used as an input for this input point.\r\n     * If null is returned, a block based on the point type will be created.\r\n     * @returns The returned string parameter is the name of the output point of NodeRenderGraphBlock (first parameter of the returned array) that can be connected to the input\r\n     */\r\n    public createCustomInputBlock(): Nullable<[NodeRenderGraphBlock, string]> {\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Creates a new connection point\r\n     * @param name defines the connection point name\r\n     * @param ownerBlock defines the block hosting this connection point\r\n     * @param direction defines the direction of the connection point\r\n     */\r\n    public constructor(name: string, ownerBlock: NodeRenderGraphBlock, direction: NodeRenderGraphConnectionPointDirection) {\r\n        this._ownerBlock = ownerBlock;\r\n        this.name = name;\r\n        this._direction = direction;\r\n    }\r\n\r\n    /**\r\n     * Gets the current class name e.g. \"NodeRenderGraphConnectionPoint\"\r\n     * @returns the class name\r\n     */\r\n    public getClassName(): string {\r\n        return \"NodeRenderGraphConnectionPoint\";\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating if the current point can be connected to another point\r\n     * @param connectionPoint defines the other connection point\r\n     * @returns a boolean\r\n     */\r\n    public canConnectTo(connectionPoint: NodeRenderGraphConnectionPoint) {\r\n        return this.checkCompatibilityState(connectionPoint) === NodeRenderGraphConnectionPointCompatibilityStates.Compatible;\r\n    }\r\n\r\n    /**\r\n     * Gets a number indicating if the current point can be connected to another point\r\n     * @param connectionPoint defines the other connection point\r\n     * @returns a number defining the compatibility state\r\n     */\r\n    public checkCompatibilityState(connectionPoint: NodeRenderGraphConnectionPoint): NodeRenderGraphConnectionPointCompatibilityStates {\r\n        const ownerBlock = this._ownerBlock;\r\n        const otherBlock = connectionPoint.ownerBlock;\r\n\r\n        if (this.type !== connectionPoint.type && connectionPoint.innerType !== NodeRenderGraphBlockConnectionPointTypes.AutoDetect) {\r\n            // Accepted types\r\n            if (connectionPoint.acceptedConnectionPointTypes && connectionPoint.acceptedConnectionPointTypes.indexOf(this.type) !== -1) {\r\n                return NodeRenderGraphConnectionPointCompatibilityStates.Compatible;\r\n            } else {\r\n                return NodeRenderGraphConnectionPointCompatibilityStates.TypeIncompatible;\r\n            }\r\n        }\r\n\r\n        // Excluded\r\n        if (connectionPoint.excludedConnectionPointTypes && connectionPoint.excludedConnectionPointTypes.indexOf(this.type) !== -1) {\r\n            return NodeRenderGraphConnectionPointCompatibilityStates.TypeIncompatible;\r\n        }\r\n\r\n        // Check hierarchy\r\n        let targetBlock = otherBlock;\r\n        let sourceBlock = ownerBlock;\r\n        if (this.direction === NodeRenderGraphConnectionPointDirection.Input) {\r\n            targetBlock = ownerBlock;\r\n            sourceBlock = otherBlock;\r\n        }\r\n\r\n        if (targetBlock.isAnAncestorOf(sourceBlock)) {\r\n            return NodeRenderGraphConnectionPointCompatibilityStates.HierarchyIssue;\r\n        }\r\n\r\n        return NodeRenderGraphConnectionPointCompatibilityStates.Compatible;\r\n    }\r\n\r\n    /**\r\n     * Connect this point to another connection point\r\n     * @param connectionPoint defines the other connection point\r\n     * @param ignoreConstraints defines if the system will ignore connection type constraints (default is false)\r\n     * @returns the current connection point\r\n     */\r\n    public connectTo(connectionPoint: NodeRenderGraphConnectionPoint, ignoreConstraints = false): NodeRenderGraphConnectionPoint {\r\n        if (!ignoreConstraints && !this.canConnectTo(connectionPoint)) {\r\n            // eslint-disable-next-line no-throw-literal\r\n            throw `Cannot connect these two connectors. source: \"${this.ownerBlock.name}\".${this.name}, target: \"${connectionPoint.ownerBlock.name}\".${connectionPoint.name}`;\r\n        }\r\n\r\n        this._endpoints.push(connectionPoint);\r\n        connectionPoint._connectedPoint = this;\r\n\r\n        this.onConnectionObservable.notifyObservers(connectionPoint);\r\n        connectionPoint.onConnectionObservable.notifyObservers(this);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Disconnect this point from one of his endpoint\r\n     * @param endpoint defines the other connection point\r\n     * @returns the current connection point\r\n     */\r\n    public disconnectFrom(endpoint: NodeRenderGraphConnectionPoint): NodeRenderGraphConnectionPoint {\r\n        const index = this._endpoints.indexOf(endpoint);\r\n\r\n        if (index === -1) {\r\n            return this;\r\n        }\r\n\r\n        this._endpoints.splice(index, 1);\r\n        endpoint._connectedPoint = null;\r\n\r\n        this.onDisconnectionObservable.notifyObservers(endpoint);\r\n        endpoint.onDisconnectionObservable.notifyObservers(this);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Fills the list of excluded connection point types with all types other than those passed in the parameter\r\n     * @param mask Types (ORed values of NodeRenderGraphBlockConnectionPointTypes) that are allowed, and thus will not be pushed to the excluded list\r\n     */\r\n    public addExcludedConnectionPointFromAllowedTypes(mask: number): void {\r\n        let bitmask = 0;\r\n        let val = 2 ** bitmask;\r\n        // Note: don't use 1 << bitmask instead of 2 ** bitmask, as it will cause an infinite loop because 1 << 31 is negative!\r\n        while (val < NodeRenderGraphBlockConnectionPointTypes.All) {\r\n            if (!(mask & val)) {\r\n                this.excludedConnectionPointTypes.push(val);\r\n            }\r\n            bitmask++;\r\n            val = 2 ** bitmask;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds accepted connection point types\r\n     * @param mask Types (ORed values of NodeRenderGraphBlockConnectionPointTypes) that are allowed to connect to this point\r\n     */\r\n    public addAcceptedConnectionPointTypes(mask: number): void {\r\n        let bitmask = 0;\r\n        let val = 2 ** bitmask;\r\n        // Note: don't use 1 << bitmask instead of 2 ** bitmask, as it will cause an infinite loop because 1 << 31 is negative!\r\n        while (val < NodeRenderGraphBlockConnectionPointTypes.All) {\r\n            if (mask & val && this.acceptedConnectionPointTypes.indexOf(val) === -1) {\r\n                this.acceptedConnectionPointTypes.push(val);\r\n            }\r\n            bitmask++;\r\n            val = 2 ** bitmask;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Serializes this point in a JSON representation\r\n     * @param isInput defines if the connection point is an input (default is true)\r\n     * @returns the serialized point object\r\n     */\r\n    public serialize(isInput = true): any {\r\n        const serializationObject: any = {};\r\n\r\n        serializationObject.name = this.name;\r\n        serializationObject.displayName = this.displayName;\r\n\r\n        if (isInput && this.connectedPoint) {\r\n            serializationObject.inputName = this.name;\r\n            serializationObject.targetBlockId = this.connectedPoint.ownerBlock.uniqueId;\r\n            serializationObject.targetConnectionName = this.connectedPoint.name;\r\n            serializationObject.isExposedOnFrame = true;\r\n            serializationObject.exposedPortPosition = this.exposedPortPosition;\r\n        }\r\n\r\n        if (this.isExposedOnFrame || this.exposedPortPosition >= 0) {\r\n            serializationObject.isExposedOnFrame = true;\r\n            serializationObject.exposedPortPosition = this.exposedPortPosition;\r\n        }\r\n\r\n        return serializationObject;\r\n    }\r\n\r\n    /**\r\n     * Release resources\r\n     */\r\n    public dispose() {\r\n        this.onConnectionObservable.clear();\r\n        this.onDisconnectionObservable.clear();\r\n    }\r\n}\r\n", "import type {\r\n    NodeRenderGraphBuildState,\r\n    Nullable,\r\n    NodeRenderGraphInputBlock,\r\n    AbstractEngine,\r\n    Scene,\r\n    FrameGraphTask,\r\n    FrameGraph,\r\n    NodeRenderGraphResourceContainerBlock,\r\n    FrameGraphTextureHandle,\r\n} from \"core/index\";\r\nimport { GetClass } from \"../../Misc/typeStore\";\r\nimport { serialize } from \"../../Misc/decorators\";\r\nimport { UniqueIdGenerator } from \"../../Misc/uniqueIdGenerator\";\r\nimport { NodeRenderGraphBlockConnectionPointTypes, NodeRenderGraphConnectionPointDirection } from \"./Types/nodeRenderGraphTypes\";\r\nimport { Observable } from \"../../Misc/observable\";\r\nimport { Logger } from \"../../Misc/logger\";\r\nimport { NodeRenderGraphConnectionPoint } from \"./nodeRenderGraphBlockConnectionPoint\";\r\n\r\n/**\r\n * Defines a block that can be used inside a node render graph\r\n */\r\nexport class NodeRenderGraphBlock {\r\n    private _name = \"\";\r\n    private _buildId: number;\r\n    protected _isInput = false;\r\n    protected _isTeleportOut = false;\r\n    protected _isTeleportIn = false;\r\n    protected _isDebug = false;\r\n    protected _isUnique = false;\r\n    protected _scene: Scene;\r\n    protected _engine: AbstractEngine;\r\n    protected _frameGraph: FrameGraph;\r\n    protected _frameGraphTask?: FrameGraphTask;\r\n\r\n    /**\r\n     * Gets or sets the disable flag of the task associated with this block\r\n     */\r\n    public get disabled() {\r\n        return !!this._frameGraphTask?.disabled;\r\n    }\r\n\r\n    public set disabled(value: boolean) {\r\n        if (this._frameGraphTask) {\r\n            this._frameGraphTask.disabled = value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the frame graph task associated with this block\r\n     */\r\n    public get task() {\r\n        return this._frameGraphTask;\r\n    }\r\n\r\n    /**\r\n     * Gets an observable raised when the block is built\r\n     */\r\n    public onBuildObservable = new Observable<NodeRenderGraphBlock>();\r\n\r\n    /** @internal */\r\n    public _inputs = new Array<NodeRenderGraphConnectionPoint>();\r\n\r\n    /** @internal */\r\n    public _outputs = new Array<NodeRenderGraphConnectionPoint>();\r\n\r\n    /** @internal */\r\n    public _codeVariableName = \"\";\r\n\r\n    /** @internal */\r\n    public _additionalConstructionParameters: Nullable<unknown[]> = null;\r\n\r\n    /**\r\n     * Gets the list of input points\r\n     */\r\n    public get inputs(): NodeRenderGraphConnectionPoint[] {\r\n        return this._inputs;\r\n    }\r\n\r\n    /** Gets the list of output points */\r\n    public get outputs(): NodeRenderGraphConnectionPoint[] {\r\n        return this._outputs;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the unique id of the node\r\n     */\r\n    public uniqueId: number;\r\n\r\n    /**\r\n     * Gets or set the name of the block\r\n     */\r\n    public get name(): string {\r\n        return this._name;\r\n    }\r\n\r\n    public set name(value: string) {\r\n        this._name = value;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating if this block is an input\r\n     */\r\n    public get isInput(): boolean {\r\n        return this._isInput;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating if this block is a teleport out\r\n     */\r\n    public get isTeleportOut(): boolean {\r\n        return this._isTeleportOut;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating if this block is a teleport in\r\n     */\r\n    public get isTeleportIn(): boolean {\r\n        return this._isTeleportIn;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating if this block is a debug block\r\n     */\r\n    public get isDebug(): boolean {\r\n        return this._isDebug;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating that this block can only be used once per node render graph\r\n     */\r\n    public get isUnique() {\r\n        return this._isUnique;\r\n    }\r\n\r\n    /**\r\n     * A free comment about the block\r\n     */\r\n    @serialize(\"comment\")\r\n    public comments: string;\r\n\r\n    /** Gets or sets a boolean indicating that this input can be edited from a collapsed frame */\r\n    public visibleOnFrame = false;\r\n\r\n    /**\r\n     * Gets the current class name e.g. \"NodeRenderGraphBlock\"\r\n     * @returns the class name\r\n     */\r\n    public getClassName() {\r\n        return \"NodeRenderGraphBlock\";\r\n    }\r\n\r\n    protected _inputRename(name: string) {\r\n        return name;\r\n    }\r\n\r\n    protected _outputRename(name: string) {\r\n        return name;\r\n    }\r\n\r\n    /**\r\n     * Checks if the current block is an ancestor of a given block\r\n     * @param block defines the potential descendant block to check\r\n     * @returns true if block is a descendant\r\n     */\r\n    public isAnAncestorOf(block: NodeRenderGraphBlock): boolean {\r\n        for (const output of this._outputs) {\r\n            if (!output.hasEndpoints) {\r\n                continue;\r\n            }\r\n\r\n            for (const endpoint of output.endpoints) {\r\n                if (endpoint.ownerBlock === block) {\r\n                    return true;\r\n                }\r\n\r\n                if (endpoint.ownerBlock.isAnAncestorOf(block)) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Checks if the current block is an ancestor of a given type\r\n     * @param type defines the potential type to check\r\n     * @returns true if block is a descendant\r\n     */\r\n    public isAnAncestorOfType(type: string): boolean {\r\n        if (this.getClassName() === type) {\r\n            return true;\r\n        }\r\n\r\n        for (const output of this._outputs) {\r\n            if (!output.hasEndpoints) {\r\n                continue;\r\n            }\r\n\r\n            for (const endpoint of output.endpoints) {\r\n                if (endpoint.ownerBlock.isAnAncestorOfType(type)) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Get the first descendant using a predicate\r\n     * @param predicate defines the predicate to check\r\n     * @returns descendant or null if none found\r\n     */\r\n    public getDescendantOfPredicate(predicate: (block: NodeRenderGraphBlock) => boolean): Nullable<NodeRenderGraphBlock> {\r\n        if (predicate(this)) {\r\n            return this;\r\n        }\r\n\r\n        for (const output of this._outputs) {\r\n            if (!output.hasEndpoints) {\r\n                continue;\r\n            }\r\n\r\n            for (const endpoint of output.endpoints) {\r\n                const descendant = endpoint.ownerBlock.getDescendantOfPredicate(predicate);\r\n                if (descendant) {\r\n                    return descendant;\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Creates a new NodeRenderGraphBlock\r\n     * @param name defines the block name\r\n     * @param frameGraph defines the hosting frame graph\r\n     * @param scene defines the hosting scene\r\n     * @param _additionalConstructionParameters defines additional parameters to pass to the block constructor\r\n     */\r\n    public constructor(name: string, frameGraph: FrameGraph, scene: Scene, ..._additionalConstructionParameters: unknown[]) {\r\n        this._name = name;\r\n        this._frameGraph = frameGraph;\r\n        this._scene = scene;\r\n        this._engine = scene.getEngine();\r\n        this.uniqueId = UniqueIdGenerator.UniqueId;\r\n    }\r\n\r\n    /**\r\n     * Register a new input. Must be called inside a block constructor\r\n     * @param name defines the connection point name\r\n     * @param type defines the connection point type\r\n     * @param isOptional defines a boolean indicating that this input can be omitted\r\n     * @param point an already created connection point. If not provided, create a new one\r\n     * @returns the current block\r\n     */\r\n    public registerInput(name: string, type: NodeRenderGraphBlockConnectionPointTypes, isOptional: boolean = false, point?: NodeRenderGraphConnectionPoint) {\r\n        point = point ?? new NodeRenderGraphConnectionPoint(name, this, NodeRenderGraphConnectionPointDirection.Input);\r\n        point.type = type;\r\n        point.isOptional = isOptional;\r\n\r\n        this._inputs.push(point);\r\n\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * Register a new output. Must be called inside a block constructor\r\n     * @param name defines the connection point name\r\n     * @param type defines the connection point type\r\n     * @param point an already created connection point. If not provided, create a new one\r\n     * @returns the current block\r\n     */\r\n    public registerOutput(name: string, type: NodeRenderGraphBlockConnectionPointTypes, point?: NodeRenderGraphConnectionPoint) {\r\n        point = point ?? new NodeRenderGraphConnectionPoint(name, this, NodeRenderGraphConnectionPointDirection.Output);\r\n        point.type = type;\r\n\r\n        this._outputs.push(point);\r\n\r\n        return this;\r\n    }\r\n\r\n    protected _addDependenciesInput(additionalAllowedTypes = 0) {\r\n        this.registerInput(\"dependencies\", NodeRenderGraphBlockConnectionPointTypes.AutoDetect, true);\r\n\r\n        const dependencies = this.getInputByName(\"dependencies\")!;\r\n\r\n        Object.defineProperty(this, \"dependencies\", {\r\n            get: function (this: FrameGraphTask) {\r\n                return dependencies;\r\n            },\r\n            enumerable: true,\r\n            configurable: true,\r\n        });\r\n\r\n        dependencies.addExcludedConnectionPointFromAllowedTypes(\r\n            NodeRenderGraphBlockConnectionPointTypes.TextureAllButBackBuffer |\r\n                NodeRenderGraphBlockConnectionPointTypes.ResourceContainer |\r\n                NodeRenderGraphBlockConnectionPointTypes.ShadowGenerator |\r\n                NodeRenderGraphBlockConnectionPointTypes.ObjectList |\r\n                NodeRenderGraphBlockConnectionPointTypes.ShadowLight |\r\n                NodeRenderGraphBlockConnectionPointTypes.Camera |\r\n                NodeRenderGraphBlockConnectionPointTypes.Object |\r\n                additionalAllowedTypes\r\n        );\r\n\r\n        return dependencies;\r\n    }\r\n\r\n    protected _buildBlock(_state: NodeRenderGraphBuildState) {\r\n        // Empty. Must be defined by child nodes\r\n    }\r\n\r\n    protected _customBuildStep(_state: NodeRenderGraphBuildState): void {\r\n        // Must be implemented by children\r\n    }\r\n\r\n    protected _propagateInputValueToOutput(inputConnectionPoint: NodeRenderGraphConnectionPoint, outputConnectionPoint: NodeRenderGraphConnectionPoint) {\r\n        if (inputConnectionPoint.connectedPoint) {\r\n            outputConnectionPoint.value = inputConnectionPoint.connectedPoint.value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Build the current node and generate the vertex data\r\n     * @param state defines the current generation state\r\n     * @returns true if already built\r\n     */\r\n    public build(state: NodeRenderGraphBuildState): boolean {\r\n        if (this._buildId === state.buildId) {\r\n            return true;\r\n        }\r\n\r\n        this._buildId = state.buildId;\r\n\r\n        // Check if \"parent\" blocks are compiled\r\n        for (const input of this._inputs) {\r\n            if (!input.connectedPoint) {\r\n                if (!input.isOptional) {\r\n                    // Emit a warning\r\n                    state._notConnectedNonOptionalInputs.push(input);\r\n                }\r\n                continue;\r\n            }\r\n\r\n            const block = input.connectedPoint.ownerBlock;\r\n            if (block && block !== this) {\r\n                block.build(state);\r\n            }\r\n        }\r\n\r\n        this._customBuildStep(state);\r\n\r\n        // Logs\r\n        if (state.verbose) {\r\n            Logger.Log(`Building ${this.name} [${this.getClassName()}]`);\r\n        }\r\n\r\n        if (this._frameGraphTask) {\r\n            this._frameGraphTask.name = this.name;\r\n        }\r\n\r\n        this._buildBlock(state);\r\n\r\n        if (this._frameGraphTask) {\r\n            this._frameGraphTask.dependencies = undefined;\r\n\r\n            const dependenciesConnectedPoint = this.getInputByName(\"dependencies\")?.connectedPoint;\r\n            if (dependenciesConnectedPoint) {\r\n                if (dependenciesConnectedPoint.type === NodeRenderGraphBlockConnectionPointTypes.ResourceContainer) {\r\n                    const container = dependenciesConnectedPoint.ownerBlock as NodeRenderGraphResourceContainerBlock;\r\n                    for (let i = 0; i < container.inputs.length; i++) {\r\n                        const input = container.inputs[i];\r\n                        if (input.connectedPoint && input.connectedPoint.value !== undefined && NodeRenderGraphConnectionPoint.IsTextureHandle(input.connectedPoint.value)) {\r\n                            this._frameGraphTask.dependencies = this._frameGraphTask.dependencies || new Set();\r\n                            this._frameGraphTask.dependencies.add(input.connectedPoint.value as FrameGraphTextureHandle);\r\n                        }\r\n                    }\r\n                } else if (NodeRenderGraphConnectionPoint.IsTextureHandle(dependenciesConnectedPoint.value)) {\r\n                    this._frameGraphTask.dependencies = this._frameGraphTask.dependencies || new Set();\r\n                    this._frameGraphTask.dependencies.add(dependenciesConnectedPoint.value as FrameGraphTextureHandle);\r\n                }\r\n            }\r\n            this._frameGraph.addTask(this._frameGraphTask);\r\n        }\r\n\r\n        this.onBuildObservable.notifyObservers(this);\r\n\r\n        return false;\r\n    }\r\n\r\n    protected _getConnectedTextures(targetConnectedPoint: Nullable<NodeRenderGraphConnectionPoint>) {\r\n        let textureHandles: FrameGraphTextureHandle | FrameGraphTextureHandle[] | undefined;\r\n        if (targetConnectedPoint) {\r\n            if (targetConnectedPoint.type === NodeRenderGraphBlockConnectionPointTypes.ResourceContainer) {\r\n                const container = targetConnectedPoint.ownerBlock as NodeRenderGraphResourceContainerBlock;\r\n                textureHandles = [];\r\n                for (let i = 0; i < container.inputs.length; i++) {\r\n                    const input = container.inputs[i];\r\n                    if (input.connectedPoint && input.connectedPoint.value !== undefined && NodeRenderGraphConnectionPoint.IsTextureHandle(input.connectedPoint.value)) {\r\n                        textureHandles.push(input.connectedPoint.value as FrameGraphTextureHandle);\r\n                    }\r\n                }\r\n            } else {\r\n                textureHandles = targetConnectedPoint.value as FrameGraphTextureHandle;\r\n            }\r\n        }\r\n\r\n        return textureHandles;\r\n    }\r\n\r\n    protected _linkConnectionTypes(inputIndex0: number, inputIndex1: number, looseCoupling = false) {\r\n        if (looseCoupling) {\r\n            this._inputs[inputIndex1]._acceptedConnectionPointType = this._inputs[inputIndex0];\r\n        } else {\r\n            this._inputs[inputIndex0]._linkedConnectionSource = this._inputs[inputIndex1];\r\n            this._inputs[inputIndex0]._isMainLinkSource = true;\r\n        }\r\n\r\n        this._inputs[inputIndex1]._linkedConnectionSource = this._inputs[inputIndex0];\r\n    }\r\n\r\n    /**\r\n     * Initialize the block and prepare the context for build\r\n     */\r\n    public initialize() {\r\n        // Do nothing\r\n    }\r\n\r\n    /**\r\n     * Lets the block try to connect some inputs automatically\r\n     */\r\n    public autoConfigure() {\r\n        // Do nothing\r\n    }\r\n\r\n    /**\r\n     * Find an input by its name\r\n     * @param name defines the name of the input to look for\r\n     * @returns the input or null if not found\r\n     */\r\n    public getInputByName(name: string) {\r\n        const filter = this._inputs.filter((e) => e.name === name);\r\n\r\n        if (filter.length) {\r\n            return filter[0];\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Find an output by its name\r\n     * @param name defines the name of the output to look for\r\n     * @returns the output or null if not found\r\n     */\r\n    public getOutputByName(name: string) {\r\n        const filter = this._outputs.filter((e) => e.name === name);\r\n\r\n        if (filter.length) {\r\n            return filter[0];\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Serializes this block in a JSON representation\r\n     * @returns the serialized block object\r\n     */\r\n    public serialize(): any {\r\n        const serializationObject: any = {};\r\n\r\n        serializationObject.customType = \"BABYLON.\" + this.getClassName();\r\n        serializationObject.id = this.uniqueId;\r\n        serializationObject.name = this.name;\r\n        serializationObject.comments = this.comments;\r\n        serializationObject.visibleOnFrame = this.visibleOnFrame;\r\n        serializationObject.disabled = this.disabled;\r\n        if (this._additionalConstructionParameters) {\r\n            serializationObject.additionalConstructionParameters = this._additionalConstructionParameters;\r\n        }\r\n\r\n        serializationObject.inputs = [];\r\n        serializationObject.outputs = [];\r\n\r\n        for (const input of this.inputs) {\r\n            serializationObject.inputs.push(input.serialize());\r\n        }\r\n\r\n        for (const output of this.outputs) {\r\n            serializationObject.outputs.push(output.serialize(false));\r\n        }\r\n\r\n        return serializationObject;\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    public _deserialize(serializationObject: any) {\r\n        this._name = serializationObject.name;\r\n        this.comments = serializationObject.comments;\r\n        this.visibleOnFrame = serializationObject.visibleOnFrame;\r\n        this.disabled = serializationObject.disabled;\r\n\r\n        this._deserializePortDisplayNamesAndExposedOnFrame(serializationObject);\r\n    }\r\n\r\n    private _deserializePortDisplayNamesAndExposedOnFrame(serializationObject: any) {\r\n        const serializedInputs = serializationObject.inputs;\r\n        const serializedOutputs = serializationObject.outputs;\r\n\r\n        if (serializedInputs) {\r\n            for (const port of serializedInputs) {\r\n                const input = this.inputs.find((i) => i.name === port.name);\r\n                if (!input) {\r\n                    continue;\r\n                }\r\n                if (port.displayName) {\r\n                    input.displayName = port.displayName;\r\n                }\r\n                if (port.isExposedOnFrame) {\r\n                    input.isExposedOnFrame = port.isExposedOnFrame;\r\n                    input.exposedPortPosition = port.exposedPortPosition;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (serializedOutputs) {\r\n            for (let i = 0; i < serializedOutputs.length; i++) {\r\n                const port = serializedOutputs[i];\r\n                if (port.displayName) {\r\n                    this.outputs[i].displayName = port.displayName;\r\n                }\r\n                if (port.isExposedOnFrame) {\r\n                    this.outputs[i].isExposedOnFrame = port.isExposedOnFrame;\r\n                    this.outputs[i].exposedPortPosition = port.exposedPortPosition;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    protected _dumpPropertiesCode() {\r\n        const variableName = this._codeVariableName;\r\n        return `${variableName}.visibleOnFrame = ${this.visibleOnFrame};\\n${variableName}.disabled = ${this.disabled};\\n`;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _dumpCodeForOutputConnections(alreadyDumped: NodeRenderGraphBlock[]) {\r\n        let codeString = \"\";\r\n\r\n        if (alreadyDumped.indexOf(this) !== -1) {\r\n            return codeString;\r\n        }\r\n\r\n        alreadyDumped.push(this);\r\n\r\n        for (const input of this.inputs) {\r\n            if (!input.isConnected) {\r\n                continue;\r\n            }\r\n\r\n            const connectedOutput = input.connectedPoint!;\r\n            const connectedBlock = connectedOutput.ownerBlock;\r\n\r\n            codeString += connectedBlock._dumpCodeForOutputConnections(alreadyDumped);\r\n            codeString += `${connectedBlock._codeVariableName}.${connectedBlock._outputRename(connectedOutput.name)}.connectTo(${this._codeVariableName}.${this._inputRename(\r\n                input.name\r\n            )});\\n`;\r\n        }\r\n\r\n        return codeString;\r\n    }\r\n\r\n    /**\r\n     * @internal\r\n     */\r\n    public _dumpCode(uniqueNames: string[], alreadyDumped: NodeRenderGraphBlock[]) {\r\n        alreadyDumped.push(this);\r\n\r\n        // Get unique name\r\n        const nameAsVariableName = this.name.replace(/[^A-Za-z_]+/g, \"\");\r\n        this._codeVariableName = nameAsVariableName || `${this.getClassName()}_${this.uniqueId}`;\r\n\r\n        if (uniqueNames.indexOf(this._codeVariableName) !== -1) {\r\n            let index = 0;\r\n            do {\r\n                index++;\r\n                this._codeVariableName = nameAsVariableName + index;\r\n            } while (uniqueNames.indexOf(this._codeVariableName) !== -1);\r\n        }\r\n\r\n        uniqueNames.push(this._codeVariableName);\r\n\r\n        // Declaration\r\n        let codeString = `\\n// ${this.getClassName()}\\n`;\r\n        if (this.comments) {\r\n            codeString += `// ${this.comments}\\n`;\r\n        }\r\n        const className = this.getClassName();\r\n        if (className === \"NodeRenderGraphInputBlock\") {\r\n            const block = this as unknown as NodeRenderGraphInputBlock;\r\n            const blockType = block.type;\r\n\r\n            codeString += `var ${this._codeVariableName} = new BABYLON.NodeRenderGraphInputBlock(\"${this.name}\", nodeRenderGraph.frameGraph, scene, BABYLON.NodeRenderGraphBlockConnectionPointTypes.${NodeRenderGraphBlockConnectionPointTypes[blockType]});\\n`;\r\n        } else {\r\n            if (this._additionalConstructionParameters) {\r\n                codeString += `var ${this._codeVariableName} = new BABYLON.${className}(\"${this.name}\", nodeRenderGraph.frameGraph, scene, ...${JSON.stringify(this._additionalConstructionParameters)});\\n`;\r\n            } else {\r\n                codeString += `var ${this._codeVariableName} = new BABYLON.${className}(\"${this.name}\", nodeRenderGraph.frameGraph, scene);\\n`;\r\n            }\r\n        }\r\n\r\n        // Properties\r\n        codeString += this._dumpPropertiesCode() + \"\\n\";\r\n\r\n        // Inputs\r\n        for (const input of this.inputs) {\r\n            if (!input.isConnected) {\r\n                continue;\r\n            }\r\n\r\n            const connectedOutput = input.connectedPoint!;\r\n            const connectedBlock = connectedOutput.ownerBlock;\r\n\r\n            if (alreadyDumped.indexOf(connectedBlock) === -1) {\r\n                codeString += connectedBlock._dumpCode(uniqueNames, alreadyDumped);\r\n            }\r\n        }\r\n\r\n        // Outputs\r\n        for (const output of this.outputs) {\r\n            if (!output.hasEndpoints) {\r\n                continue;\r\n            }\r\n\r\n            for (const endpoint of output.endpoints) {\r\n                const connectedBlock = endpoint.ownerBlock;\r\n                if (connectedBlock && alreadyDumped.indexOf(connectedBlock) === -1) {\r\n                    codeString += connectedBlock._dumpCode(uniqueNames, alreadyDumped);\r\n                }\r\n            }\r\n        }\r\n\r\n        return codeString;\r\n    }\r\n\r\n    /**\r\n     * Clone the current block to a new identical block\r\n     * @returns a copy of the current block\r\n     */\r\n    public clone() {\r\n        const serializationObject = this.serialize();\r\n        const blockType: typeof NodeRenderGraphBlock = GetClass(serializationObject.customType);\r\n\r\n        if (blockType) {\r\n            const additionalConstructionParameters = serializationObject.additionalConstructionParameters;\r\n            const block: NodeRenderGraphBlock = additionalConstructionParameters\r\n                ? new blockType(\"\", this._frameGraph, this._scene, ...additionalConstructionParameters)\r\n                : new blockType(\"\", this._frameGraph, this._scene);\r\n            block._deserialize(serializationObject);\r\n            return block;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Release resources\r\n     */\r\n    public dispose() {\r\n        for (const input of this.inputs) {\r\n            input.dispose();\r\n        }\r\n\r\n        for (const output of this.outputs) {\r\n            output.dispose();\r\n        }\r\n\r\n        this._frameGraphTask?.dispose();\r\n        this._frameGraphTask = undefined as any;\r\n\r\n        this.onBuildObservable.clear();\r\n    }\r\n}\r\n", "import type { FrameGraphTextureHandle } from \"core/index\";\r\nimport { backbufferColorTextureHandle } from \"../../frameGraphTypes\";\r\nimport { FrameGraphTask } from \"../../frameGraphTask\";\r\n\r\n/**\r\n * Task which copies a texture to the backbuffer color texture.\r\n */\r\nexport class FrameGraphCopyToBackbufferColorTask extends FrameGraphTask {\r\n    /**\r\n     * The source texture to copy to the backbuffer color texture.\r\n     */\r\n    public sourceTexture: FrameGraphTextureHandle;\r\n\r\n    public override getClassName(): string {\r\n        return \"FrameGraphCopyToBackbufferColorTask\";\r\n    }\r\n\r\n    public record() {\r\n        if (this.sourceTexture === undefined) {\r\n            throw new Error(`FrameGraphCopyToBackbufferColorTask \"${this.name}\": sourceTexture is required`);\r\n        }\r\n\r\n        const pass = this._frameGraph.addRenderPass(this.name);\r\n\r\n        pass.addDependencies(this.sourceTexture);\r\n\r\n        pass.setRenderTarget(backbufferColorTextureHandle);\r\n        pass.setExecuteFunc((context) => {\r\n            if (!context.isBackbuffer(this.sourceTexture)) {\r\n                context.copyTexture(this.sourceTexture);\r\n            }\r\n        });\r\n\r\n        const passDisabled = this._frameGraph.addRenderPass(this.name + \"_disabled\", true);\r\n\r\n        passDisabled.setRenderTarget(backbufferColorTextureHandle);\r\n        passDisabled.setExecuteFunc((_context) => {});\r\n    }\r\n}\r\n", "import type { NodeRenderGraphConnectionPoint, Scene, FrameGraph, NodeRenderGraphBuildState, FrameGraphTextureHandle } from \"core/index\";\r\nimport { NodeRenderGraphBlock } from \"../nodeRenderGraphBlock\";\r\nimport { RegisterClass } from \"../../../Misc/typeStore\";\r\nimport { NodeRenderGraphBlockConnectionPointTypes } from \"../Types/nodeRenderGraphTypes\";\r\nimport { FrameGraphCopyToBackbufferColorTask } from \"../../Tasks/Texture/copyToBackbufferColorTask\";\r\n\r\n/**\r\n * Block used to generate the final graph\r\n */\r\nexport class NodeRenderGraphOutputBlock extends NodeRenderGraphBlock {\r\n    protected override _frameGraphTask: FrameGraphCopyToBackbufferColorTask;\r\n\r\n    /**\r\n     * Gets the frame graph task associated with this block\r\n     */\r\n    public override get task() {\r\n        return this._frameGraphTask;\r\n    }\r\n\r\n    /**\r\n     * Create a new NodeRenderGraphOutputBlock\r\n     * @param name defines the block name\r\n     * @param frameGraph defines the hosting frame graph\r\n     * @param scene defines the hosting scene\r\n     */\r\n    public constructor(name: string, frameGraph: FrameGraph, scene: Scene) {\r\n        super(name, frameGraph, scene);\r\n\r\n        this._isUnique = true;\r\n\r\n        this.registerInput(\"texture\", NodeRenderGraphBlockConnectionPointTypes.Texture);\r\n        this._addDependenciesInput();\r\n\r\n        this.texture.addAcceptedConnectionPointTypes(NodeRenderGraphBlockConnectionPointTypes.TextureAll);\r\n\r\n        this._frameGraphTask = new FrameGraphCopyToBackbufferColorTask(name, frameGraph);\r\n    }\r\n\r\n    /**\r\n     * Gets the current class name\r\n     * @returns the class name\r\n     */\r\n    public override getClassName() {\r\n        return \"NodeRenderGraphOutputBlock\";\r\n    }\r\n    /**\r\n     * Gets the texture input component\r\n     */\r\n    public get texture(): NodeRenderGraphConnectionPoint {\r\n        return this._inputs[0];\r\n    }\r\n\r\n    protected override _buildBlock(state: NodeRenderGraphBuildState) {\r\n        super._buildBlock(state);\r\n\r\n        this._frameGraphTask.name = this.name;\r\n\r\n        const textureConnectedPoint = this.texture.connectedPoint;\r\n        if (textureConnectedPoint) {\r\n            this._frameGraphTask.sourceTexture = textureConnectedPoint.value as FrameGraphTextureHandle;\r\n        }\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.NodeRenderGraphOutputBlock\", NodeRenderGraphOutputBlock);\r\n", "import type {\r\n    NodeRenderGraphConnectionPoint,\r\n    Scene,\r\n    FrameGraph,\r\n    NodeRenderGraphBuildState,\r\n    Camera,\r\n    InternalTexture,\r\n    Nullable,\r\n    FrameGraphTextureCreationOptions,\r\n    FrameGraphTextureHandle,\r\n    FrameGraphObjectList,\r\n    IShadowLight,\r\n} from \"core/index\";\r\nimport { Observable } from \"../../../Misc/observable\";\r\nimport { NodeRenderGraphBlockConnectionPointTypes } from \"../Types/nodeRenderGraphTypes\";\r\nimport { NodeRenderGraphBlock } from \"../nodeRenderGraphBlock\";\r\nimport { RegisterClass } from \"../../../Misc/typeStore\";\r\nimport { editableInPropertyPage, PropertyTypeForEdition } from \"../../../Decorators/nodeDecorator\";\r\nimport { backbufferColorTextureHandle, backbufferDepthStencilTextureHandle } from \"../../../FrameGraph/frameGraphTypes\";\r\nimport { Constants } from \"../../../Engines/constants\";\r\n\r\nexport type NodeRenderGraphValueType = InternalTexture | Camera | FrameGraphObjectList | IShadowLight;\r\n\r\nexport type NodeRenderGraphInputCreationOptions = FrameGraphTextureCreationOptions;\r\n\r\n/**\r\n * Block used to expose an input value\r\n */\r\nexport class NodeRenderGraphInputBlock extends NodeRenderGraphBlock {\r\n    private _storedValue: Nullable<NodeRenderGraphValueType> = null;\r\n    private _type: NodeRenderGraphBlockConnectionPointTypes = NodeRenderGraphBlockConnectionPointTypes.Undefined;\r\n\r\n    /** Gets an observable raised when the value is changed */\r\n    public onValueChangedObservable = new Observable<NodeRenderGraphInputBlock>();\r\n\r\n    /** Indicates that the input is externally managed */\r\n    @editableInPropertyPage(\"Is external\", PropertyTypeForEdition.Boolean, \"PROPERTIES\")\r\n    public isExternal = false;\r\n\r\n    /** Gets or sets the options to create the input value */\r\n    public creationOptions: NodeRenderGraphInputCreationOptions;\r\n\r\n    /**\r\n     * Gets or sets the connection point type (default is Undefined)\r\n     */\r\n    public get type(): NodeRenderGraphBlockConnectionPointTypes {\r\n        return this._type;\r\n    }\r\n\r\n    /**\r\n     * Creates a new NodeRenderGraphInputBlock\r\n     * @param name defines the block name\r\n     * @param frameGraph defines the hosting frame graph\r\n     * @param scene defines the hosting scene\r\n     * @param type defines the type of the input (can be set to NodeRenderGraphBlockConnectionPointTypes.Undefined)\r\n     */\r\n    public constructor(name: string, frameGraph: FrameGraph, scene: Scene, type: NodeRenderGraphBlockConnectionPointTypes = NodeRenderGraphBlockConnectionPointTypes.Undefined) {\r\n        super(name, frameGraph, scene);\r\n\r\n        this._type = type;\r\n        this._isInput = true;\r\n        this.registerOutput(\"output\", type);\r\n        this.setDefaultValue();\r\n    }\r\n\r\n    /**\r\n     * Set the input block to its default value (based on its type)\r\n     */\r\n    public setDefaultValue() {\r\n        switch (this.type) {\r\n            case NodeRenderGraphBlockConnectionPointTypes.Texture:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureViewDepth:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureScreenDepth:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureNormalizedViewDepth:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureViewNormal:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureWorldNormal:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureAlbedo:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureReflectivity:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureLocalPosition:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureWorldPosition:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureVelocity:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureLinearVelocity:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureIrradiance:\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureAlbedoSqrt: {\r\n                const options: FrameGraphTextureCreationOptions = {\r\n                    size: { width: 100, height: 100 },\r\n                    options: {\r\n                        createMipMaps: false,\r\n                        targetTypes: [Constants.TEXTURE_2D],\r\n                        types: [Constants.TEXTURETYPE_UNSIGNED_BYTE],\r\n                        formats: [Constants.TEXTUREFORMAT_RGBA],\r\n                        layerCounts: [0],\r\n                        samples: 1,\r\n                        useSRGBBuffers: [false],\r\n                        creationFlags: [0],\r\n                    },\r\n                    sizeIsPercentage: true,\r\n                    isHistoryTexture: false,\r\n                };\r\n                this.creationOptions = options;\r\n                break;\r\n            }\r\n            case NodeRenderGraphBlockConnectionPointTypes.TextureDepthStencilAttachment: {\r\n                const options: FrameGraphTextureCreationOptions = {\r\n                    size: { width: 100, height: 100 },\r\n                    options: {\r\n                        createMipMaps: false,\r\n                        targetTypes: [Constants.TEXTURE_2D],\r\n                        types: [Constants.TEXTURETYPE_UNSIGNED_BYTE],\r\n                        formats: [Constants.TEXTUREFORMAT_DEPTH24_STENCIL8],\r\n                        layerCounts: [0],\r\n                        useSRGBBuffers: [false],\r\n                        creationFlags: [0],\r\n                        labels: [this.name],\r\n                        samples: 1,\r\n                    },\r\n                    sizeIsPercentage: true,\r\n                    isHistoryTexture: false,\r\n                };\r\n                this.creationOptions = options;\r\n                break;\r\n            }\r\n            case NodeRenderGraphBlockConnectionPointTypes.ObjectList:\r\n                this.value = { meshes: null, particleSystems: null };\r\n                this.isExternal = true;\r\n                break;\r\n            case NodeRenderGraphBlockConnectionPointTypes.Camera:\r\n                this.value = this._scene.cameras[0];\r\n                this.isExternal = true;\r\n                break;\r\n            default:\r\n                this.isExternal = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets or sets the value of that point.\r\n     */\r\n    public get value(): Nullable<NodeRenderGraphValueType> {\r\n        return this._storedValue;\r\n    }\r\n\r\n    public set value(value: Nullable<NodeRenderGraphValueType>) {\r\n        this._storedValue = value;\r\n        this.output.value = undefined;\r\n        this.onValueChangedObservable.notifyObservers(this);\r\n    }\r\n\r\n    /**\r\n     * Gets the value as a specific type\r\n     * @returns the value as a specific type\r\n     */\r\n    public getTypedValue<T extends NodeRenderGraphValueType>(): T {\r\n        return this._storedValue as T;\r\n    }\r\n\r\n    /**\r\n     * Gets the value as an internal texture\r\n     * @returns The internal texture stored in value if value is an internal texture, otherwise null\r\n     */\r\n    public getInternalTextureFromValue(): Nullable<InternalTexture> {\r\n        if ((this._storedValue as InternalTexture)._swapAndDie) {\r\n            return this._storedValue as InternalTexture;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Gets the current class name\r\n     * @returns the class name\r\n     */\r\n    public override getClassName() {\r\n        return \"NodeRenderGraphInputBlock\";\r\n    }\r\n\r\n    /**\r\n     * Gets the output component\r\n     */\r\n    public get output(): NodeRenderGraphConnectionPoint {\r\n        return this._outputs[0];\r\n    }\r\n\r\n    /**\r\n     * Check if the block is a texture of any type\r\n     * @returns true if the block is a texture\r\n     */\r\n    public isAnyTexture(): boolean {\r\n        return (this.type & NodeRenderGraphBlockConnectionPointTypes.TextureAll) !== 0;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating that the connection point is the back buffer texture\r\n     * @returns true if the connection point is the back buffer texture\r\n     */\r\n    public isBackBuffer() {\r\n        return (this.type & NodeRenderGraphBlockConnectionPointTypes.TextureBackBuffer) !== 0;\r\n    }\r\n\r\n    /**\r\n     * Gets a boolean indicating that the connection point is a depth/stencil attachment texture\r\n     * @returns true if the connection point is a depth/stencil attachment texture\r\n     */\r\n    public isBackBufferDepthStencilAttachment() {\r\n        return (this.type & NodeRenderGraphBlockConnectionPointTypes.TextureBackBufferDepthStencilAttachment) !== 0;\r\n    }\r\n\r\n    /**\r\n     * Check if the block is a camera\r\n     * @returns true if the block is a camera\r\n     */\r\n    public isCamera(): boolean {\r\n        return (this.type & NodeRenderGraphBlockConnectionPointTypes.Camera) !== 0;\r\n    }\r\n\r\n    /**\r\n     * Check if the block is an object list\r\n     * @returns true if the block is an object list\r\n     */\r\n    public isObjectList(): boolean {\r\n        return (this.type & NodeRenderGraphBlockConnectionPointTypes.ObjectList) !== 0;\r\n    }\r\n\r\n    /**\r\n     * Check if the block is a shadow light\r\n     * @returns true if the block is a shadow light\r\n     */\r\n    public isShadowLight(): boolean {\r\n        return (this.type & NodeRenderGraphBlockConnectionPointTypes.ShadowLight) !== 0;\r\n    }\r\n\r\n    protected override _buildBlock(state: NodeRenderGraphBuildState) {\r\n        super._buildBlock(state);\r\n\r\n        if (this.isExternal) {\r\n            if (this.isBackBuffer()) {\r\n                this.output.value = backbufferColorTextureHandle;\r\n            } else if (this.isBackBufferDepthStencilAttachment()) {\r\n                this.output.value = backbufferDepthStencilTextureHandle;\r\n            } else if (this.isCamera()) {\r\n                this.output.value = this.getTypedValue<Camera>();\r\n            } else if (this.isObjectList()) {\r\n                this.output.value = this.getTypedValue<FrameGraphObjectList>();\r\n            } else if (this.isShadowLight()) {\r\n                this.output.value = this.getTypedValue<IShadowLight>();\r\n            } else {\r\n                if (this._storedValue === undefined || this._storedValue === null) {\r\n                    throw new Error(`NodeRenderGraphInputBlock: External input \"${this.name}\" is not set`);\r\n                }\r\n                const texture = this.getInternalTextureFromValue();\r\n                if (texture) {\r\n                    this.output.value = this._frameGraph.textureManager.importTexture(this.name, texture, this.output.value as FrameGraphTextureHandle);\r\n                }\r\n            }\r\n            return;\r\n        }\r\n\r\n        if ((this.type & NodeRenderGraphBlockConnectionPointTypes.TextureAllButBackBuffer) !== 0) {\r\n            const textureCreateOptions = this.creationOptions;\r\n\r\n            if (!textureCreateOptions) {\r\n                throw new Error(`NodeRenderGraphInputBlock: Creation options are missing for texture \"${this.name}\"`);\r\n            }\r\n\r\n            this.output.value = this._frameGraph.textureManager.createRenderTargetTexture(this.name, textureCreateOptions);\r\n        }\r\n    }\r\n\r\n    public override dispose() {\r\n        this._storedValue = null;\r\n        this.onValueChangedObservable.clear();\r\n        super.dispose();\r\n    }\r\n\r\n    protected override _dumpPropertiesCode() {\r\n        const codes: string[] = [];\r\n        codes.push(`${this._codeVariableName}.isExternal = ${this.isExternal};`);\r\n        if (this.isAnyTexture()) {\r\n            if (!this.isExternal) {\r\n                codes.push(`${this._codeVariableName}.creationOptions = ${JSON.stringify(this.creationOptions)};`);\r\n            } else {\r\n                codes.push(`${this._codeVariableName}.value = EXTERNAL_TEXTURE; // TODO: set the external texture`);\r\n            }\r\n        } else if (this.isCamera()) {\r\n            codes.push(`${this._codeVariableName}.value = EXTERNAL_CAMERA; // TODO: set the external camera`);\r\n        } else if (this.isObjectList()) {\r\n            codes.push(`${this._codeVariableName}.value = EXTERNAL_OBJECT_LIST; // TODO: set the external object list`);\r\n        } else if (this.isShadowLight()) {\r\n            codes.push(`${this._codeVariableName}.value = EXTERNAL_SHADOW_LIGHT; // TODO: set the external shadow light`);\r\n        }\r\n        return super._dumpPropertiesCode() + codes.join(\"\\n\");\r\n    }\r\n\r\n    public override serialize(): any {\r\n        const serializationObject = super.serialize();\r\n        serializationObject.type = this.type;\r\n        serializationObject.isExternal = this.isExternal;\r\n        if (this.creationOptions) {\r\n            serializationObject.creationOptions = this.creationOptions;\r\n        }\r\n        return serializationObject;\r\n    }\r\n\r\n    public override _deserialize(serializationObject: any) {\r\n        super._deserialize(serializationObject);\r\n        this._type = serializationObject.type;\r\n        this.output.type = this._type;\r\n        this.isExternal = serializationObject.isExternal;\r\n        if (serializationObject.creationOptions) {\r\n            if (serializationObject.creationOptions.options.depthTextureFormat !== undefined) {\r\n                // Backward compatibility - remove this code in the future\r\n                serializationObject.creationOptions.options.formats = [serializationObject.creationOptions.options.depthTextureFormat];\r\n            }\r\n            this.creationOptions = serializationObject.creationOptions;\r\n        }\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.NodeRenderGraphInputBlock\", NodeRenderGraphInputBlock);\r\n", "import type { FrameGraph, FrameGraphTextureHandle, FrameGraphRenderPass } from \"core/index\";\r\nimport { Color4, TmpColors } from \"../../../Maths/math.color\";\r\nimport { FrameGraphTaskMultiRenderTarget } from \"../../frameGraphTaskMultiRenderTarget\";\r\nimport { backbufferColorTextureHandle } from \"../../frameGraphTypes\";\r\n\r\n/**\r\n * Task used to clear a texture.\r\n */\r\nexport class FrameGraphClearTextureTask extends FrameGraphTaskMultiRenderTarget {\r\n    /**\r\n     * The color to clear the texture with.\r\n     */\r\n    public color = new Color4(0.2, 0.2, 0.3, 1);\r\n\r\n    /**\r\n     * If the color should be cleared.\r\n     */\r\n    public clearColor = true;\r\n\r\n    /**\r\n     * If the color should be converted to linear space (default: false).\r\n     */\r\n    public convertColorToLinearSpace = false;\r\n\r\n    /**\r\n     * If the depth should be cleared.\r\n     */\r\n    public clearDepth = false;\r\n\r\n    /**\r\n     * If the stencil should be cleared.\r\n     */\r\n    public clearStencil = false;\r\n\r\n    /**\r\n     * The value to use to clear the stencil buffer (default: 0).\r\n     */\r\n    public stencilValue = 0;\r\n\r\n    /**\r\n     * The color texture to clear.\r\n     */\r\n    public targetTexture?: FrameGraphTextureHandle | FrameGraphTextureHandle[];\r\n\r\n    /**\r\n     * The depth attachment texture to clear.\r\n     */\r\n    public depthTexture?: FrameGraphTextureHandle;\r\n\r\n    /**\r\n     * The output texture (same as targetTexture, but the handle will be different).\r\n     */\r\n    public readonly outputTexture: FrameGraphTextureHandle;\r\n\r\n    /**\r\n     * The output depth texture (same as depthTexture, but the handle will be different).\r\n     */\r\n    public readonly outputDepthTexture: FrameGraphTextureHandle;\r\n\r\n    /**\r\n     * Constructs a new clear task.\r\n     * @param name The name of the task.\r\n     * @param frameGraph The frame graph the task belongs to.\r\n     */\r\n    constructor(name: string, frameGraph: FrameGraph) {\r\n        super(name, frameGraph);\r\n\r\n        this.outputTexture = this._frameGraph.textureManager.createDanglingHandle();\r\n        this.outputDepthTexture = this._frameGraph.textureManager.createDanglingHandle();\r\n    }\r\n\r\n    public override getClassName(): string {\r\n        return \"FrameGraphClearTextureTask\";\r\n    }\r\n\r\n    public record(skipCreationOfDisabledPasses = false): FrameGraphRenderPass {\r\n        if (this.targetTexture === undefined && this.depthTexture === undefined) {\r\n            throw new Error(`FrameGraphClearTextureTask ${this.name}: targetTexture and depthTexture can't both be undefined.`);\r\n        }\r\n\r\n        const textureManager = this._frameGraph.textureManager;\r\n        const targetTextures = this.targetTexture !== undefined ? (Array.isArray(this.targetTexture) ? this.targetTexture : [this.targetTexture]) : undefined;\r\n\r\n        if (this.targetTexture !== undefined) {\r\n            textureManager.resolveDanglingHandle(this.outputTexture, targetTextures![0]);\r\n        }\r\n        if (this.depthTexture !== undefined) {\r\n            textureManager.resolveDanglingHandle(this.outputDepthTexture, this.depthTexture);\r\n        }\r\n        if (this.targetTexture !== undefined && this.depthTexture !== undefined) {\r\n            const targetDescription = textureManager.getTextureDescription(targetTextures![0]);\r\n            const depthDescription = textureManager.getTextureDescription(this.depthTexture);\r\n\r\n            if (targetDescription.size.width !== depthDescription.size.width || targetDescription.size.height !== depthDescription.size.height) {\r\n                throw new Error(\r\n                    `FrameGraphClearTextureTask ${this.name}: the depth texture (size: ${depthDescription.size.width}x${depthDescription.size.height}) and the target texture (size: ${targetDescription.size.width}x${targetDescription.size.height}) must have the same dimensions.`\r\n                );\r\n            }\r\n\r\n            const textureSamples = targetDescription.options.samples || 1;\r\n            const depthSamples = depthDescription.options.samples || 1;\r\n\r\n            if (textureSamples !== depthSamples && textureSamples !== 0 && depthSamples !== 0) {\r\n                throw new Error(\r\n                    `FrameGraphClearTextureTask ${this.name}: the depth texture (${depthSamples} samples) and the target texture (${textureSamples} samples) must have the same number of samples.`\r\n                );\r\n            }\r\n        }\r\n\r\n        const attachments = this._frameGraph.engine.buildTextureLayout(\r\n            targetTextures ? Array(targetTextures.length).fill(true) : [],\r\n            this.targetTexture === backbufferColorTextureHandle && !this._frameGraph.textureManager.backBufferTextureOverriden\r\n        );\r\n\r\n        const color = TmpColors.Color4[0];\r\n\r\n        const pass = this._frameGraph.addRenderPass(this.name);\r\n\r\n        pass.setRenderTarget(targetTextures);\r\n        pass.setRenderTargetDepth(this.depthTexture);\r\n        pass.setInitializeFunc(() => {\r\n            const renderTargetWrapper = pass.frameGraphRenderTarget.renderTargetWrapper;\r\n            if (renderTargetWrapper) {\r\n                renderTargetWrapper.disableAutomaticMSAAResolve = true;\r\n            }\r\n        });\r\n        pass.setExecuteFunc((context) => {\r\n            this._updateLayerAndFaceIndices(pass);\r\n\r\n            color.copyFrom(this.color);\r\n            if (this.convertColorToLinearSpace) {\r\n                color.toLinearSpaceToRef(color);\r\n            }\r\n\r\n            context.clearAttachments(color, attachments, !!this.clearColor, !!this.clearDepth, !!this.clearStencil, this.stencilValue);\r\n        });\r\n\r\n        if (!skipCreationOfDisabledPasses) {\r\n            const passDisabled = this._frameGraph.addRenderPass(this.name + \"_disabled\", true);\r\n\r\n            passDisabled.setRenderTarget(targetTextures);\r\n            passDisabled.setRenderTargetDepth(this.depthTexture);\r\n            passDisabled.setExecuteFunc((_context) => {});\r\n        }\r\n\r\n        return pass;\r\n    }\r\n}\r\n", "import type { Scene, FrameGraphTextureHandle, FrameGraph, NodeRenderGraphBuildState, NodeRenderGraphConnectionPoint } from \"core/index\";\r\nimport { NodeRenderGraphBlock } from \"../../nodeRenderGraphBlock\";\r\nimport { RegisterClass } from \"../../../../Misc/typeStore\";\r\nimport { NodeRenderGraphBlockConnectionPointTypes } from \"../../Types/nodeRenderGraphTypes\";\r\nimport { Color4 } from \"../../../../Maths/math.color\";\r\nimport { editableInPropertyPage, PropertyTypeForEdition } from \"../../../../Decorators/nodeDecorator\";\r\nimport { FrameGraphClearTextureTask } from \"../../../Tasks/Texture/clearTextureTask\";\r\n\r\n/**\r\n * Block used to clear a texture\r\n */\r\nexport class NodeRenderGraphClearBlock extends NodeRenderGraphBlock {\r\n    protected override _frameGraphTask: FrameGraphClearTextureTask;\r\n\r\n    /**\r\n     * Gets the frame graph task associated with this block\r\n     */\r\n    public override get task() {\r\n        return this._frameGraphTask;\r\n    }\r\n\r\n    /**\r\n     * Create a new NodeRenderGraphClearBlock\r\n     * @param name defines the block name\r\n     * @param frameGraph defines the hosting frame graph\r\n     * @param scene defines the hosting scene\r\n     */\r\n    public constructor(name: string, frameGraph: FrameGraph, scene: Scene) {\r\n        super(name, frameGraph, scene);\r\n\r\n        this.registerInput(\"target\", NodeRenderGraphBlockConnectionPointTypes.AutoDetect, true);\r\n        this.registerInput(\"depth\", NodeRenderGraphBlockConnectionPointTypes.AutoDetect, true);\r\n        this._addDependenciesInput();\r\n\r\n        this.registerOutput(\"output\", NodeRenderGraphBlockConnectionPointTypes.BasedOnInput);\r\n        this.registerOutput(\"outputDepth\", NodeRenderGraphBlockConnectionPointTypes.BasedOnInput);\r\n\r\n        this.target.addExcludedConnectionPointFromAllowedTypes(NodeRenderGraphBlockConnectionPointTypes.TextureAll | NodeRenderGraphBlockConnectionPointTypes.ResourceContainer);\r\n        this.depth.addExcludedConnectionPointFromAllowedTypes(\r\n            NodeRenderGraphBlockConnectionPointTypes.TextureDepthStencilAttachment | NodeRenderGraphBlockConnectionPointTypes.TextureBackBufferDepthStencilAttachment\r\n        );\r\n\r\n        this.output._typeConnectionSource = this.target;\r\n        this.outputDepth._typeConnectionSource = this.depth;\r\n\r\n        this._frameGraphTask = new FrameGraphClearTextureTask(name, frameGraph);\r\n    }\r\n\r\n    /** Gets or sets the clear color */\r\n    @editableInPropertyPage(\"Color\", PropertyTypeForEdition.Color4)\r\n    public get color(): Color4 {\r\n        return this._frameGraphTask.color;\r\n    }\r\n\r\n    public set color(value: Color4) {\r\n        this._frameGraphTask.color = value;\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating whether the color part of the texture should be cleared. */\r\n    @editableInPropertyPage(\"Clear color\", PropertyTypeForEdition.Boolean, undefined, { embedded: true })\r\n    public get clearColor(): boolean {\r\n        return !!this._frameGraphTask.clearColor;\r\n    }\r\n\r\n    public set clearColor(value: boolean) {\r\n        this._frameGraphTask.clearColor = value;\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating whether the color should be converted to linear space. */\r\n    @editableInPropertyPage(\"Convert color to linear space\", PropertyTypeForEdition.Boolean)\r\n    public get convertColorToLinearSpace(): boolean {\r\n        return !!this._frameGraphTask.convertColorToLinearSpace;\r\n    }\r\n\r\n    public set convertColorToLinearSpace(value: boolean) {\r\n        this._frameGraphTask.convertColorToLinearSpace = value;\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating whether the depth part of the texture should be cleared. */\r\n    @editableInPropertyPage(\"Clear depth\", PropertyTypeForEdition.Boolean, undefined, { embedded: true })\r\n    public get clearDepth(): boolean {\r\n        return !!this._frameGraphTask.clearDepth;\r\n    }\r\n\r\n    public set clearDepth(value: boolean) {\r\n        this._frameGraphTask.clearDepth = value;\r\n    }\r\n\r\n    /** Gets or sets a boolean indicating whether the stencil part of the texture should be cleared. */\r\n    @editableInPropertyPage(\"Clear stencil\", PropertyTypeForEdition.Boolean, undefined, { embedded: true })\r\n    public get clearStencil(): boolean {\r\n        return !!this._frameGraphTask.clearStencil;\r\n    }\r\n\r\n    public set clearStencil(value: boolean) {\r\n        this._frameGraphTask.clearStencil = value;\r\n    }\r\n\r\n    /**\r\n     * Gets the current class name\r\n     * @returns the class name\r\n     */\r\n    public override getClassName() {\r\n        return \"NodeRenderGraphClearBlock\";\r\n    }\r\n\r\n    /**\r\n     * Gets the target input component\r\n     */\r\n    public get target(): NodeRenderGraphConnectionPoint {\r\n        return this._inputs[0];\r\n    }\r\n\r\n    /**\r\n     * Gets the depth texture input component\r\n     */\r\n    public get depth(): NodeRenderGraphConnectionPoint {\r\n        return this._inputs[1];\r\n    }\r\n\r\n    /**\r\n     * Gets the output component\r\n     */\r\n    public get output(): NodeRenderGraphConnectionPoint {\r\n        return this._outputs[0];\r\n    }\r\n\r\n    /**\r\n     * Gets the output depth component\r\n     */\r\n    public get outputDepth(): NodeRenderGraphConnectionPoint {\r\n        return this._outputs[1];\r\n    }\r\n\r\n    protected override _buildBlock(state: NodeRenderGraphBuildState) {\r\n        super._buildBlock(state);\r\n\r\n        this.output.value = this._frameGraphTask.outputTexture;\r\n        this.outputDepth.value = this._frameGraphTask.outputDepthTexture;\r\n\r\n        this._frameGraphTask.targetTexture = this._getConnectedTextures(this.target.connectedPoint);\r\n        this._frameGraphTask.depthTexture = this.depth.connectedPoint?.value as FrameGraphTextureHandle;\r\n    }\r\n\r\n    protected override _dumpPropertiesCode() {\r\n        const codes: string[] = [];\r\n        codes.push(`${this._codeVariableName}.color = new BABYLON.Color4(${this.color.r}, ${this.color.g}, ${this.color.b}, ${this.color.a});`);\r\n        codes.push(`${this._codeVariableName}.clearColor = ${this.clearColor};`);\r\n        codes.push(`${this._codeVariableName}.convertColorToLinearSpace = ${this.convertColorToLinearSpace};`);\r\n        codes.push(`${this._codeVariableName}.clearDepth = ${this.clearDepth};`);\r\n        codes.push(`${this._codeVariableName}.clearStencil = ${this.clearStencil};`);\r\n        return super._dumpPropertiesCode() + codes.join(\"\\n\");\r\n    }\r\n\r\n    public override serialize(): any {\r\n        const serializationObject = super.serialize();\r\n        serializationObject.color = this.color.asArray();\r\n        serializationObject.clearColor = this.clearColor;\r\n        serializationObject.convertColorToLinearSpace = this.convertColorToLinearSpace;\r\n        serializationObject.clearDepth = this.clearDepth;\r\n        serializationObject.clearStencil = this.clearStencil;\r\n        return serializationObject;\r\n    }\r\n\r\n    public override _deserialize(serializationObject: any) {\r\n        super._deserialize(serializationObject);\r\n        this.color = Color4.FromArray(serializationObject.color);\r\n        this.clearColor = serializationObject.clearColor;\r\n        this.convertColorToLinearSpace = !!serializationObject.convertColorToLinearSpace;\r\n        this.clearDepth = serializationObject.clearDepth;\r\n        this.clearStencil = serializationObject.clearStencil;\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.NodeRenderGraphClearBlock\", NodeRenderGraphClearBlock);\r\n", "import type { NodeRenderGraphConnectionPointDirection, NodeRenderGraphBlock, Nullable } from \"core/index\";\r\nimport { NodeRenderGraphConnectionPoint } from \"./nodeRenderGraphBlockConnectionPoint\";\r\nimport { NodeRenderGraphConnectionPointCompatibilityStates } from \"./Types/nodeRenderGraphTypes\";\r\n\r\n/**\r\n * Defines a connection point to be used for points with a custom object type\r\n */\r\nexport class NodeRenderGraphConnectionPointCustomObject<T extends NodeRenderGraphBlock> extends NodeRenderGraphConnectionPoint {\r\n    /**\r\n     * Creates a new connection point\r\n     * @param name defines the connection point name\r\n     * @param ownerBlock defines the block hosting this connection point\r\n     * @param direction defines the direction of the connection point\r\n     * @param _blockType\r\n     * @param _blockName\r\n     */\r\n    public constructor(\r\n        name: string,\r\n        ownerBlock: NodeRenderGraphBlock,\r\n        direction: NodeRenderGraphConnectionPointDirection,\r\n        // @internal\r\n        public _blockType: new (...args: any[]) => T,\r\n        private _blockName: string\r\n    ) {\r\n        super(name, ownerBlock, direction);\r\n\r\n        this.needDualDirectionValidation = true;\r\n    }\r\n\r\n    public override checkCompatibilityState(connectionPoint: NodeRenderGraphConnectionPoint): NodeRenderGraphConnectionPointCompatibilityStates {\r\n        return connectionPoint instanceof NodeRenderGraphConnectionPointCustomObject && connectionPoint._blockName === this._blockName\r\n            ? NodeRenderGraphConnectionPointCompatibilityStates.Compatible\r\n            : NodeRenderGraphConnectionPointCompatibilityStates.TypeIncompatible;\r\n    }\r\n\r\n    public override createCustomInputBlock(): Nullable<[NodeRenderGraphBlock, string]> {\r\n        return [new this._blockType(this._blockName), this.name];\r\n    }\r\n}\r\n", "import type {\r\n    Scene,\r\n    NodeRenderGraphBuildState,\r\n    FrameGraph,\r\n    FrameGraphTextureHandle,\r\n    FrameGraphObjectList,\r\n    Camera,\r\n    NodeRenderGraphResourceContainerBlock,\r\n    FrameGraphShadowGeneratorTask,\r\n} from \"core/index\";\r\nimport { NodeRenderGraphBlock } from \"../../nodeRenderGraphBlock\";\r\nimport { NodeRenderGraphBlockConnectionPointTypes, NodeRenderGraphConnectionPointDirection } from \"../../Types/nodeRenderGraphTypes\";\r\nimport { editableInPropertyPage, PropertyTypeForEdition } from \"../../../../Decorators/nodeDecorator\";\r\nimport { NodeRenderGraphConnectionPoint } from \"../../nodeRenderGraphBlockConnectionPoint\";\r\nimport { NodeRenderGraphConnectionPointCustomObject } from \"../../nodeRenderGraphConnectionPointCustomObject\";\r\nimport { FrameGraphObjectRendererTask } from \"core/FrameGraph/Tasks/Rendering/objectRendererTask\";\r\n\r\n/**\r\n * @internal\r\n */\r\nexport class NodeRenderGraphBaseObjectRendererBlock extends NodeRenderGraphBlock {\r\n    protected override _frameGraphTask: FrameGraphObjectRendererTask;\r\n\r\n    public override _additionalConstructionParameters: [boolean, boolean];\r\n\r\n    /**\r\n     * Gets the frame graph task associated with this block\r\n     */\r\n    public override get task() {\r\n        return this._frameGraphTask;\r\n    }\r\n\r\n    /**\r\n     * Create a new NodeRenderGraphBaseObjectRendererBlock\r\n     * @param name defines the block name\r\n     * @param frameGraph defines the hosting frame graph\r\n     * @param scene defines the hosting scene\r\n     * @param doNotChangeAspectRatio True (default) to not change the aspect ratio of the scene in the RTT\r\n     * @param enableClusteredLights True (default) to enable clustered lights\r\n     */\r\n    public constructor(name: string, frameGraph: FrameGraph, scene: Scene, doNotChangeAspectRatio = true, enableClusteredLights = true) {\r\n        super(name, frameGraph, scene);\r\n\r\n        this._additionalConstructionParameters = [doNotChangeAspectRatio, enableClusteredLights];\r\n\r\n        this.registerInput(\"target\", NodeRenderGraphBlockConnectionPointTypes.AutoDetect);\r\n        this.registerInput(\"depth\", NodeRenderGraphBlockConnectionPointTypes.AutoDetect, true);\r\n        this.registerInput(\"camera\", NodeRenderGraphBlockConnectionPointTypes.Camera);\r\n        this.registerInput(\"objects\", NodeRenderGraphBlockConnectionPointTypes.ObjectList);\r\n        this._addDependenciesInput();\r\n        this.registerInput(\"shadowGenerators\", NodeRenderGraphBlockConnectionPointTypes.AutoDetect, true);\r\n\r\n        this.registerOutput(\"output\", NodeRenderGraphBlockConnectionPointTypes.BasedOnInput);\r\n        this.registerOutput(\"outputDepth\", NodeRenderGraphBlockConnectionPointTypes.BasedOnInput);\r\n        this.registerOutput(\r\n            \"objectRenderer\",\r\n            NodeRenderGraphBlockConnectionPointTypes.Object,\r\n            new NodeRenderGraphConnectionPointCustomObject(\r\n                \"objectRenderer\",\r\n                this,\r\n                NodeRenderGraphConnectionPointDirection.Output,\r\n                NodeRenderGraphBaseObjectRendererBlock,\r\n                \"NodeRenderGraphBaseObjectRendererBlock\"\r\n            )\r\n        );\r\n\r\n        this.target.addExcludedConnectionPointFromAllowedTypes(\r\n            NodeRenderGraphBlockConnectionPointTypes.TextureAllButBackBufferDepthStencil | NodeRenderGraphBlockConnectionPointTypes.ResourceContainer\r\n        );\r\n        this.depth.addExcludedConnectionPointFromAllowedTypes(\r\n            NodeRenderGraphBlockConnectionPointTypes.TextureDepthStencilAttachment | NodeRenderGraphBlockConnectionPointTypes.TextureBackBufferDepthStencilAttachment\r\n        );\r\n        this.shadowGenerators.addExcludedConnectionPointFromAllowedTypes(\r\n            NodeRenderGraphBlockConnectionPointTypes.ShadowGenerator | NodeRenderGraphBlockConnectionPointTypes.ResourceContainer\r\n        );\r\n\r\n        this.output._typeConnectionSource = this.target;\r\n        this.outputDepth._typeConnectionSource = this.depth;\r\n\r\n        this._createFrameGraphObject();\r\n    }\r\n\r\n    protected _createFrameGraphObject(): void {\r\n        this._frameGraphTask?.dispose();\r\n        this._frameGraphTask = new FrameGraphObjectRendererTask(this.name, this._frameGraph, this._scene, {\r\n            doNotChangeAspectRatio: this._additionalConstructionParameters![0] as boolean,\r\n            enableClusteredLights: this._additionalConstructionParameters![1] as boolean,\r\n        });\r\n    }\r\n\r\n    protected _saveState(state: { [key: string]: any }) {\r\n        state.disabled = this._frameGraphTask.disabled;\r\n        state.isMainObjectRenderer = this.isMainObjectRenderer;\r\n        state.depthTest = this.depthTest;\r\n        state.depthWrite = this.depthWrite;\r\n        state.disableShadows = this.disableShadows;\r\n        state.renderInLinearSpace = this.renderInLinearSpace;\r\n        state.renderMeshes = this.renderMeshes;\r\n        state.renderDepthOnlyMeshes = this.renderDepthOnlyMeshes;\r\n        state.renderOpaqueMeshes = this.renderOpaqueMeshes;\r\n        state.renderAlphaTestMeshes = this.renderAlphaTestMeshes;\r\n        state.renderTransparentMeshes = this.renderTransparentMeshes;\r\n        state.useOITForTransparentMeshes = this.useOITForTransparentMeshes;\r\n        state.renderParticles = this.renderParticles;\r\n        state.renderSprites = this.renderSprites;\r\n        state.forceLayerMaskCheck = this.forceLayerMaskCheck;\r\n        state.enableBoundingBoxRendering = this.enableBoundingBoxRendering;\r\n        state.enableOutlineRendering = this.enableOutlineRendering;\r\n    }\r\n\r\n    protected _restoreState(state: { [key: string]: any }) {\r\n        this._frameGraphTask.disabled = state.disabled;\r\n        this.isMainObjectRenderer = state.isMainObjectRenderer;\r\n        this.depthTest = state.depthTest;\r\n        this.depthWrite = state.depthWrite;\r\n        this.disableShadows = state.disableShadows;\r\n        this.renderInLinearSpace = state.renderInLinearSpace;\r\n        this.renderMeshes = state.renderMeshes;\r\n        this.renderDepthOnlyMeshes = state.renderDepthOnlyMeshes;\r\n        this.renderOpaqueMeshes = state.renderOpaqueMeshes;\r\n        this.renderAlphaTestMeshes = state.renderAlphaTestMeshes;\r\n        this.renderTransparentMeshes = state.renderTransparentMeshes;\r\n        this.useOITForTransparentMeshes = state.useOITForTransparentMeshes;\r\n        this.renderParticles = state.renderParticles;\r\n        this.renderSprites = state.renderSprites;\r\n        this.forceLayerMaskCheck = state.forceLayerMaskCheck;\r\n        this.enableBoundingBoxRendering = state.enableBoundingBoxRendering;\r\n        this.enableOutlineRendering = state.enableOutlineRendering;\r\n    }\r\n\r\n    protected _createFrameGraphObjectWithState(doNotChangeAspectRatio: boolean, enableClusteredLights: boolean): void {\r\n        const state: { [key: string]: any } = {};\r\n\r\n        this._saveState(state);\r\n\r\n        this._additionalConstructionParameters = [doNotChangeAspectRatio, enableClusteredLights];\r\n\r\n        this._createFrameGraphObject();\r\n\r\n        this._restoreState(state);\r\n    }\r\n\r\n    /** Indicates that this object renderer is the main object renderer of the frame graph. */\r\n    @editableInPropertyPage(\"Is main object renderer\", PropertyTypeForEdition.Boolean, \"GENERAL\")\r\n    public get isMainObjectRenderer() {\r\n        return this._frameGraphTask.isMainObjectRenderer;\r\n    }\r\n\r\n    public set isMainObjectRenderer(value: boolean) {\r\n        this._frameGraphTask.isMainObjectRenderer = value;\r\n    }\r\n\r\n    /** Indicates if depth testing must be enabled or disabled */\r\n    @editableInPropertyPage(\"Depth test\", PropertyTypeForEdition.Boolean, \"GENERAL\")\r\n    public get depthTest() {\r\n        return this._frameGraphTask.depthTest;\r\n    }\r\n\r\n    public set depthTest(value: boolean) {\r\n        this._frameGraphTask.depthTest = value;\r\n    }\r\n\r\n    /** Indicates if depth writing must be enabled or disabled */\r\n    @editableInPropertyPage(\"Depth write\", PropertyTypeForEdition.Boolean, \"GENERAL\")\r\n    public get depthWrite() {\r\n        return this._frameGraphTask.depthWrite;\r\n    }\r\n\r\n    public set depthWrite(value: boolean) {\r\n        this._frameGraphTask.depthWrite = value;\r\n    }\r\n\r\n    /** Indicates if meshes should be rendered */\r\n    @editableInPropertyPage(\"Render meshes\", PropertyTypeForEdition.Boolean, \"RENDERING\")\r\n    public get renderMeshes() {\r\n        return this._frameGraphTask.renderMeshes;\r\n    }\r\n\r\n    public set renderMeshes(value: boolean) {\r\n        this._frameGraphTask.renderMeshes = value;\r\n    }\r\n\r\n    /** Indicates if depth-only meshes should be rendered */\r\n    @editableInPropertyPage(\"Â Â Â Â Render depth-only meshes\", PropertyTypeForEdition.Boolean, \"RENDERING\")\r\n    public get renderDepthOnlyMeshes() {\r\n        return this._frameGraphTask.renderDepthOnlyMeshes;\r\n    }\r\n\r\n    public set renderDepthOnlyMeshes(value: boolean) {\r\n        this._frameGraphTask.renderDepthOnlyMeshes = value;\r\n    }\r\n\r\n    /** Indicates if opaque meshes should be rendered */\r\n    @editableInPropertyPage(\"Â Â Â Â Render opaque meshes\", PropertyTypeForEdition.Boolean, \"RENDERING\")\r\n    public get renderOpaqueMeshes() {\r\n        return this._frameGraphTask.renderOpaqueMeshes;\r\n    }\r\n\r\n    public set renderOpaqueMeshes(value: boolean) {\r\n        this._frameGraphTask.renderOpaqueMeshes = value;\r\n    }\r\n\r\n    /** Indicates if alpha tested meshes should be rendered */\r\n    @editableInPropertyPage(\"Â Â Â Â Render alpha test meshes\", PropertyTypeForEdition.Boolean, \"RENDERING\")\r\n    public get renderAlphaTestMeshes() {\r\n        return this._frameGraphTask.renderAlphaTestMeshes;\r\n    }\r\n\r\n    public set renderAlphaTestMeshes(value: boolean) {\r\n        this._frameGraphTask.renderAlphaTestMeshes = value;\r\n    }\r\n\r\n    /** Indicates if transparent meshes should be rendered */\r\n    @editableInPropertyPage(\"Â Â Â Â Render transparent meshes\", PropertyTypeForEdition.Boolean, \"RENDERING\")\r\n    public get renderTransparentMeshes() {\r\n        return this._frameGraphTask.renderTransparentMeshes;\r\n    }\r\n\r\n    public set renderTransparentMeshes(value: boolean) {\r\n        this._frameGraphTask.renderTransparentMeshes = value;\r\n    }\r\n\r\n    /** Indicates if use of Order Independent Transparency (OIT) for transparent meshes should be enabled */\r\n    @editableInPropertyPage(\"Â Â Â Â Â Â Â Â Use OIT for transparent meshes\", PropertyTypeForEdition.Boolean, \"RENDERING\")\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    public get useOITForTransparentMeshes() {\r\n        return this._frameGraphTask.useOITForTransparentMeshes;\r\n    }\r\n\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    public set useOITForTransparentMeshes(value: boolean) {\r\n        this._frameGraphTask.useOITForTransparentMeshes = value;\r\n    }\r\n\r\n    /** Defines the number of passes to use for Order Independent Transparency */\r\n    @editableInPropertyPage(\"Â Â Â Â Â Â Â Â Â Â Â Â Pass count\", PropertyTypeForEdition.Int, \"RENDERING\", { min: 1, max: 20 })\r\n    public get oitPassCount(): number {\r\n        return this._frameGraphTask.oitPassCount;\r\n    }\r\n\r\n    public set oitPassCount(value: number) {\r\n        this._frameGraphTask.oitPassCount = value;\r\n    }\r\n\r\n    /** Indicates if particles should be rendered */\r\n    @editableInPropertyPage(\"Render particles\", PropertyTypeForEdition.Boolean, \"RENDERING\")\r\n    public get renderParticles() {\r\n        return this._frameGraphTask.renderParticles;\r\n    }\r\n\r\n    public set renderParticles(value: boolean) {\r\n        this._frameGraphTask.renderParticles = value;\r\n    }\r\n\r\n    /** Indicates if sprites should be rendered */\r\n    @editableInPropertyPage(\"Render sprites\", PropertyTypeForEdition.Boolean, \"RENDERING\")\r\n    public get renderSprites() {\r\n        return this._frameGraphTask.renderSprites;\r\n    }\r\n\r\n    public set renderSprites(value: boolean) {\r\n        this._frameGraphTask.renderSprites = value;\r\n    }\r\n\r\n    /** Indicates if layer mask check must be forced */\r\n    @editableInPropertyPage(\"Force layer mask check\", PropertyTypeForEdition.Boolean, \"GENERAL\")\r\n    public get forceLayerMaskCheck() {\r\n        return this._frameGraphTask.forceLayerMaskCheck;\r\n    }\r\n\r\n    public set forceLayerMaskCheck(value: boolean) {\r\n        this._frameGraphTask.forceLayerMaskCheck = value;\r\n    }\r\n\r\n    /** Indicates if bounding boxes should be rendered */\r\n    @editableInPropertyPage(\"Render bounding boxes\", PropertyTypeForEdition.Boolean, \"RENDERING\")\r\n    public get enableBoundingBoxRendering() {\r\n        return this._frameGraphTask.enableBoundingBoxRendering;\r\n    }\r\n\r\n    public set enableBoundingBoxRendering(value: boolean) {\r\n        this._frameGraphTask.enableBoundingBoxRendering = value;\r\n    }\r\n\r\n    /** Indicates if outlines/overlays should be rendered */\r\n    @editableInPropertyPage(\"Render outlines/overlays\", PropertyTypeForEdition.Boolean, \"RENDERING\")\r\n    public get enableOutlineRendering() {\r\n        return this._frameGraphTask.enableOutlineRendering;\r\n    }\r\n\r\n    public set enableOutlineRendering(value: boolean) {\r\n        this._frameGraphTask.enableOutlineRendering = value;\r\n    }\r\n\r\n    /** Indicates if shadows must be enabled or disabled */\r\n    @editableInPropertyPage(\"Disable shadows\", PropertyTypeForEdition.Boolean, \"GENERAL\")\r\n    public get disableShadows() {\r\n        return this._frameGraphTask.disableShadows;\r\n    }\r\n\r\n    public set disableShadows(value: boolean) {\r\n        this._frameGraphTask.disableShadows = value;\r\n    }\r\n\r\n    /** If image processing should be disabled */\r\n    @editableInPropertyPage(\"Disable image processing\", PropertyTypeForEdition.Boolean, \"GENERAL\")\r\n    public get renderInLinearSpace() {\r\n        return this._frameGraphTask.disableImageProcessing;\r\n    }\r\n\r\n    public set renderInLinearSpace(value: boolean) {\r\n        this._frameGraphTask.disableImageProcessing = value;\r\n    }\r\n\r\n    /** True (default) to not change the aspect ratio of the scene in the RTT */\r\n    @editableInPropertyPage(\"Do not change aspect ratio\", PropertyTypeForEdition.Boolean, \"GENERAL\")\r\n    public get doNotChangeAspectRatio() {\r\n        return this._frameGraphTask.objectRenderer.options.doNotChangeAspectRatio;\r\n    }\r\n\r\n    public set doNotChangeAspectRatio(value: boolean) {\r\n        this._createFrameGraphObjectWithState(value, this.enableClusteredLights);\r\n    }\r\n\r\n    /** True (default) to enable clustered lights */\r\n    @editableInPropertyPage(\"Enable clustered lights\", PropertyTypeForEdition.Boolean, \"GENERAL\")\r\n    public get enableClusteredLights() {\r\n        return this._frameGraphTask.objectRenderer.options.enableClusteredLights;\r\n    }\r\n\r\n    public set enableClusteredLights(value: boolean) {\r\n        this._createFrameGraphObjectWithState(this.doNotChangeAspectRatio, value);\r\n    }\r\n\r\n    /** If true, MSAA color textures will be resolved at the end of the render pass (default: true) */\r\n    @editableInPropertyPage(\"Resolve MSAA colors\", PropertyTypeForEdition.Boolean, \"GENERAL\")\r\n    public get resolveMSAAColors() {\r\n        return this._frameGraphTask.resolveMSAAColors;\r\n    }\r\n\r\n    public set resolveMSAAColors(value: boolean) {\r\n        this._frameGraphTask.resolveMSAAColors = value;\r\n    }\r\n\r\n    /** If true, MSAA depth texture will be resolved at the end of the render pass (default: false) */\r\n    @editableInPropertyPage(\"Resolve MSAA depth\", PropertyTypeForEdition.Boolean, \"GENERAL\")\r\n    public get resolveMSAADepth() {\r\n        return this._frameGraphTask.resolveMSAADepth;\r\n    }\r\n\r\n    public set resolveMSAADepth(value: boolean) {\r\n        this._frameGraphTask.resolveMSAADepth = value;\r\n    }\r\n\r\n    /**\r\n     * Gets the current class name\r\n     * @returns the class name\r\n     */\r\n    public override getClassName() {\r\n        return \"NodeRenderGraphBaseObjectRendererBlock\";\r\n    }\r\n\r\n    /**\r\n     * Gets the target texture input component\r\n     */\r\n    public get target(): NodeRenderGraphConnectionPoint {\r\n        return this._inputs[0];\r\n    }\r\n\r\n    /**\r\n     * Gets the depth texture input component\r\n     */\r\n    public get depth(): NodeRenderGraphConnectionPoint {\r\n        return this._inputs[1];\r\n    }\r\n\r\n    /**\r\n     * Gets the camera input component\r\n     */\r\n    public get camera(): NodeRenderGraphConnectionPoint {\r\n        return this._inputs[2];\r\n    }\r\n\r\n    /**\r\n     * Gets the objects input component\r\n     */\r\n    public get objects(): NodeRenderGraphConnectionPoint {\r\n        return this._inputs[3];\r\n    }\r\n\r\n    /**\r\n     * Gets the dependencies input component\r\n     */\r\n    public get dependencies(): NodeRenderGraphConnectionPoint {\r\n        return this._inputs[4];\r\n    }\r\n\r\n    /**\r\n     * Gets the shadowGenerators input component\r\n     */\r\n    public get shadowGenerators(): NodeRenderGraphConnectionPoint {\r\n        return this._inputs[5];\r\n    }\r\n\r\n    /**\r\n     * Gets the output component\r\n     */\r\n    public get output(): NodeRenderGraphConnectionPoint {\r\n        return this._outputs[0];\r\n    }\r\n\r\n    /**\r\n     * Gets the output depth component\r\n     */\r\n    public get outputDepth(): NodeRenderGraphConnectionPoint {\r\n        return this._outputs[1];\r\n    }\r\n\r\n    /**\r\n     * Gets the objectRenderer component\r\n     */\r\n    public get objectRenderer(): NodeRenderGraphConnectionPoint {\r\n        return this._outputs[2];\r\n    }\r\n\r\n    protected override _buildBlock(state: NodeRenderGraphBuildState) {\r\n        super._buildBlock(state);\r\n\r\n        this.output.value = this._frameGraphTask.outputTexture; // the value of the output connection point is the \"output\" texture of the task\r\n        this.outputDepth.value = this._frameGraphTask.outputDepthTexture; // the value of the outputDepth connection point is the \"outputDepth\" texture of the task\r\n        this.objectRenderer.value = this._frameGraphTask; // the value of the objectRenderer connection point is the task itself\r\n\r\n        this._frameGraphTask.targetTexture = this._getConnectedTextures(this.target.connectedPoint)!; // Geometry renderer allows undefined for targetTexture\r\n        this._frameGraphTask.depthTexture = this.depth.connectedPoint?.value as FrameGraphTextureHandle;\r\n        this._frameGraphTask.camera = this.camera.connectedPoint?.value as Camera;\r\n        this._frameGraphTask.objectList = this.objects.connectedPoint?.value as FrameGraphObjectList;\r\n\r\n        this._frameGraphTask.shadowGenerators = [];\r\n\r\n        const shadowGeneratorsConnectedPoint = this.shadowGenerators.connectedPoint;\r\n        if (shadowGeneratorsConnectedPoint) {\r\n            if (shadowGeneratorsConnectedPoint.type === NodeRenderGraphBlockConnectionPointTypes.ResourceContainer) {\r\n                const container = shadowGeneratorsConnectedPoint.ownerBlock as NodeRenderGraphResourceContainerBlock;\r\n                for (const input of container.inputs) {\r\n                    if (input.connectedPoint && input.connectedPoint.value !== undefined && NodeRenderGraphConnectionPoint.IsShadowGenerator(input.connectedPoint.value)) {\r\n                        this._frameGraphTask.shadowGenerators.push(input.connectedPoint.value as FrameGraphShadowGeneratorTask);\r\n                    }\r\n                }\r\n            } else if (NodeRenderGraphConnectionPoint.IsShadowGenerator(shadowGeneratorsConnectedPoint.value)) {\r\n                this._frameGraphTask.shadowGenerators[0] = shadowGeneratorsConnectedPoint.value as FrameGraphShadowGeneratorTask;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected override _dumpPropertiesCode() {\r\n        const codes: string[] = [];\r\n        codes.push(`${this._codeVariableName}.isMainObjectRenderer = ${this.isMainObjectRenderer};`);\r\n        codes.push(`${this._codeVariableName}.depthTest = ${this.depthTest};`);\r\n        codes.push(`${this._codeVariableName}.depthWrite = ${this.depthWrite};`);\r\n        codes.push(`${this._codeVariableName}.renderMeshes = ${this.renderMeshes};`);\r\n        codes.push(`${this._codeVariableName}.renderDepthOnlyMeshes = ${this.renderDepthOnlyMeshes};`);\r\n        codes.push(`${this._codeVariableName}.renderOpaqueMeshes = ${this.renderOpaqueMeshes};`);\r\n        codes.push(`${this._codeVariableName}.renderAlphaTestMeshes = ${this.renderAlphaTestMeshes};`);\r\n        codes.push(`${this._codeVariableName}.renderTransparentMeshes = ${this.renderTransparentMeshes};`);\r\n        codes.push(`${this._codeVariableName}.useOITForTransparentMeshes = ${this.useOITForTransparentMeshes};`);\r\n        codes.push(`${this._codeVariableName}.oitPassCount = ${this.oitPassCount};`);\r\n        codes.push(`${this._codeVariableName}.renderParticles = ${this.renderParticles};`);\r\n        codes.push(`${this._codeVariableName}.renderSprites = ${this.renderSprites};`);\r\n        codes.push(`${this._codeVariableName}.forceLayerMaskCheck = ${this.forceLayerMaskCheck};`);\r\n        codes.push(`${this._codeVariableName}.enableBoundingBoxRendering = ${this.enableBoundingBoxRendering};`);\r\n        codes.push(`${this._codeVariableName}.enableOutlineRendering = ${this.enableOutlineRendering};`);\r\n        codes.push(`${this._codeVariableName}.disableShadows = ${this.disableShadows};`);\r\n        codes.push(`${this._codeVariableName}.renderInLinearSpace = ${this.renderInLinearSpace};`);\r\n        codes.push(`${this._codeVariableName}.resolveMSAAColors = ${this.resolveMSAAColors};`);\r\n        codes.push(`${this._codeVariableName}.resolveMSAADepth = ${this.resolveMSAADepth};`);\r\n        return super._dumpPropertiesCode() + codes.join(\"\\n\");\r\n    }\r\n\r\n    public override serialize(): any {\r\n        const serializationObject = super.serialize();\r\n        serializationObject.isMainObjectRenderer = this.isMainObjectRenderer;\r\n        serializationObject.depthTest = this.depthTest;\r\n        serializationObject.depthWrite = this.depthWrite;\r\n        serializationObject.renderMeshes = this.renderMeshes;\r\n        serializationObject.renderDepthOnlyMeshes = this.renderDepthOnlyMeshes;\r\n        serializationObject.renderOpaqueMeshes = this.renderOpaqueMeshes;\r\n        serializationObject.renderAlphaTestMeshes = this.renderAlphaTestMeshes;\r\n        serializationObject.renderTransparentMeshes = this.renderTransparentMeshes;\r\n        serializationObject.useOITForTransparentMeshes = this.useOITForTransparentMeshes;\r\n        serializationObject.oitPassCount = this.oitPassCount;\r\n        serializationObject.renderParticles = this.renderParticles;\r\n        serializationObject.renderSprites = this.renderSprites;\r\n        serializationObject.forceLayerMaskCheck = this.forceLayerMaskCheck;\r\n        serializationObject.enableBoundingBoxRendering = this.enableBoundingBoxRendering;\r\n        serializationObject.enableOutlineRendering = this.enableOutlineRendering;\r\n        serializationObject.disableShadows = this.disableShadows;\r\n        serializationObject.renderInLinearSpace = this.renderInLinearSpace;\r\n        serializationObject.resolveMSAAColors = this.resolveMSAAColors;\r\n        serializationObject.resolveMSAADepth = this.resolveMSAADepth;\r\n        return serializationObject;\r\n    }\r\n\r\n    public override _deserialize(serializationObject: any) {\r\n        super._deserialize(serializationObject);\r\n        this.isMainObjectRenderer = !!serializationObject.isMainObjectRenderer;\r\n        this.depthTest = serializationObject.depthTest;\r\n        this.depthWrite = serializationObject.depthWrite;\r\n        this.renderMeshes = serializationObject.renderMeshes ?? true;\r\n        this.renderDepthOnlyMeshes = serializationObject.renderDepthOnlyMeshes ?? true;\r\n        this.renderOpaqueMeshes = serializationObject.renderOpaqueMeshes ?? true;\r\n        this.renderAlphaTestMeshes = serializationObject.renderAlphaTestMeshes ?? true;\r\n        this.renderTransparentMeshes = serializationObject.renderTransparentMeshes ?? true;\r\n        this.useOITForTransparentMeshes = serializationObject.useOITForTransparentMeshes ?? false;\r\n        this.oitPassCount = serializationObject.oitPassCount ?? 5;\r\n        this.renderParticles = serializationObject.renderParticles ?? true;\r\n        this.renderSprites = serializationObject.renderSprites ?? true;\r\n        this.forceLayerMaskCheck = serializationObject.forceLayerMaskCheck ?? true;\r\n        this.enableBoundingBoxRendering = serializationObject.enableBoundingBoxRendering ?? true;\r\n        this.enableOutlineRendering = serializationObject.enableOutlineRendering ?? true;\r\n        this.disableShadows = serializationObject.disableShadows;\r\n        this.renderInLinearSpace = !!serializationObject.renderInLinearSpace;\r\n        this.resolveMSAAColors = serializationObject.resolveMSAAColors ?? true;\r\n        this.resolveMSAADepth = serializationObject.resolveMSAADepth ?? false;\r\n    }\r\n}\r\n", "import { RegisterClass } from \"../../../../Misc/typeStore\";\r\nimport { NodeRenderGraphBaseObjectRendererBlock } from \"./baseObjectRendererBlock\";\r\n\r\n/**\r\n * Block that render objects to a render target\r\n */\r\nexport class NodeRenderGraphObjectRendererBlock extends NodeRenderGraphBaseObjectRendererBlock {\r\n    /**\r\n     * Gets the current class name\r\n     * @returns the class name\r\n     */\r\n    public override getClassName() {\r\n        return \"NodeRenderGraphObjectRendererBlock\";\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.NodeRenderGraphObjectRendererBlock\", NodeRenderGraphObjectRendererBlock);\r\n", "import type { Nullable, NodeRenderGraphConnectionPoint, Observable } from \"core/index\";\r\nimport { Logger } from \"../../Misc/logger\";\r\n\r\n/**\r\n * Class used to store node based render graph build state\r\n */\r\nexport class NodeRenderGraphBuildState {\r\n    /** Gets or sets the build identifier */\r\n    public buildId: number;\r\n\r\n    /** Gets or sets a boolean indicating that verbose mode is on */\r\n    public verbose = false;\r\n\r\n    /**\r\n     * Gets or sets the list of non connected mandatory inputs\r\n     * @internal\r\n     */\r\n    public _notConnectedNonOptionalInputs: NodeRenderGraphConnectionPoint[] = [];\r\n\r\n    /**\r\n     * Emits console errors and exceptions if there is a failing check\r\n     * @param errorObservable defines an Observable to send the error message\r\n     * @returns true if all checks pass\r\n     */\r\n    public emitErrors(errorObservable: Nullable<Observable<string>> = null): boolean {\r\n        let errorMessage = \"\";\r\n        for (const notConnectedInput of this._notConnectedNonOptionalInputs) {\r\n            errorMessage += `input \"${notConnectedInput.name}\" from block \"${\r\n                notConnectedInput.ownerBlock.name\r\n            }\"[${notConnectedInput.ownerBlock.getClassName()}] is not connected and is not optional.\\n`;\r\n        }\r\n        if (errorMessage) {\r\n            if (errorObservable) {\r\n                errorObservable.notifyObservers(errorMessage);\r\n            }\r\n            Logger.Error(\"Build of node render graph failed:\\n\" + errorMessage);\r\n\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n}\r\n", "import type { Scene, Camera, FrameGraph, FrameGraphObjectList } from \"core/index\";\r\nimport { FrameGraphTask } from \"../../frameGraphTask\";\r\n\r\n/**\r\n * Task used to cull objects that are not visible.\r\n */\r\nexport class FrameGraphCullObjectsTask extends FrameGraphTask {\r\n    /**\r\n     * The object list to cull.\r\n     */\r\n    public objectList: FrameGraphObjectList;\r\n\r\n    /**\r\n     * The camera to use for culling.\r\n     */\r\n    public camera: Camera;\r\n\r\n    /**\r\n     * The output object list containing the culled objects.\r\n     */\r\n    public readonly outputObjectList: FrameGraphObjectList;\r\n\r\n    private readonly _scene: Scene;\r\n\r\n    /**\r\n     * Creates a new cull objects task.\r\n     * @param name The name of the task.\r\n     * @param frameGraph The frame graph the task belongs to.\r\n     * @param scene The scene to cull objects from.\r\n     */\r\n    constructor(name: string, frameGraph: FrameGraph, scene: Scene) {\r\n        super(name, frameGraph);\r\n        this._scene = scene;\r\n        this.outputObjectList = {\r\n            meshes: null,\r\n            particleSystems: null,\r\n        };\r\n    }\r\n\r\n    public override getClassName(): string {\r\n        return \"FrameGraphCullObjectsTask\";\r\n    }\r\n\r\n    public record() {\r\n        if (this.objectList === undefined || this.camera === undefined) {\r\n            throw new Error(`FrameGraphCullObjectsTask ${this.name}: objectList and camera are required`);\r\n        }\r\n\r\n        // Initial output values\r\n        this.outputObjectList.meshes = this.objectList.meshes;\r\n        this.outputObjectList.particleSystems = this.objectList.particleSystems;\r\n\r\n        const pass = this._frameGraph.addObjectListPass(this.name);\r\n\r\n        pass.setObjectList(this.outputObjectList);\r\n        pass.setExecuteFunc((_context) => {\r\n            // No culling on particle systems\r\n            this.outputObjectList.particleSystems = this.objectList.particleSystems;\r\n\r\n            if (this._scene._activeMeshesFrozen) {\r\n                // If active meshes are frozen, we don't need culling: we keep the last list created before freezing\r\n                return;\r\n            }\r\n\r\n            this.outputObjectList.meshes = [];\r\n\r\n            this.camera._updateFrustumPlanes();\r\n\r\n            const frustumPlanes = this.camera._frustumPlanes;\r\n\r\n            const meshes = this.objectList.meshes || this._scene.meshes;\r\n            for (let i = 0; i < meshes.length; i++) {\r\n                const mesh = meshes[i];\r\n                if (mesh.isBlocked || !mesh.isReady() || !mesh.isEnabled() || mesh.scaling.hasAZeroComponent) {\r\n                    continue;\r\n                }\r\n\r\n                if (\r\n                    mesh.isVisible &&\r\n                    mesh.visibility > 0 &&\r\n                    (mesh.layerMask & this.camera.layerMask) !== 0 &&\r\n                    (this._scene.skipFrustumClipping || mesh.alwaysSelectAsActiveMesh || mesh.isInFrustum(frustumPlanes))\r\n                ) {\r\n                    this.outputObjectList.meshes.push(mesh);\r\n                }\r\n            }\r\n        });\r\n\r\n        const passDisabled = this._frameGraph.addObjectListPass(this.name + \"_disabled\", true);\r\n\r\n        passDisabled.setObjectList(this.outputObjectList);\r\n        passDisabled.setExecuteFunc((_context) => {\r\n            this.outputObjectList.meshes = this.objectList.meshes;\r\n            this.outputObjectList.particleSystems = this.objectList.particleSystems;\r\n        });\r\n    }\r\n}\r\n", "import type { NodeRenderGraphConnectionPoint, Scene, NodeRenderGraphBuildState, FrameGraph } from \"core/index\";\r\nimport { NodeRenderGraphBlock } from \"../nodeRenderGraphBlock\";\r\nimport { RegisterClass } from \"../../../Misc/typeStore\";\r\nimport { NodeRenderGraphBlockConnectionPointTypes } from \"../Types/nodeRenderGraphTypes\";\r\nimport { FrameGraphCullObjectsTask } from \"../../Tasks/Misc/cullObjectsTask\";\r\nimport type { Camera } from \"../../../Cameras/camera\";\r\nimport type { FrameGraphObjectList } from \"core/FrameGraph/frameGraphObjectList\";\r\n\r\n/**\r\n * Block that culls a list of objects\r\n */\r\nexport class NodeRenderGraphCullObjectsBlock extends NodeRenderGraphBlock {\r\n    protected override _frameGraphTask: FrameGraphCullObjectsTask;\r\n\r\n    /**\r\n     * Gets the frame graph task associated with this block\r\n     */\r\n    public override get task() {\r\n        return this._frameGraphTask;\r\n    }\r\n\r\n    /**\r\n     * Create a new NodeRenderGraphCullObjectsBlock\r\n     * @param name defines the block name\r\n     * @param frameGraph defines the hosting frame graph\r\n     * @param scene defines the hosting scene\r\n     */\r\n    public constructor(name: string, frameGraph: FrameGraph, scene: Scene) {\r\n        super(name, frameGraph, scene);\r\n\r\n        this.registerInput(\"camera\", NodeRenderGraphBlockConnectionPointTypes.Camera);\r\n        this.registerInput(\"objects\", NodeRenderGraphBlockConnectionPointTypes.ObjectList);\r\n        this._addDependenciesInput();\r\n\r\n        this.registerOutput(\"output\", NodeRenderGraphBlockConnectionPointTypes.ObjectList);\r\n\r\n        this._frameGraphTask = new FrameGraphCullObjectsTask(this.name, frameGraph, scene);\r\n    }\r\n\r\n    /**\r\n     * Gets the current class name\r\n     * @returns the class name\r\n     */\r\n    public override getClassName() {\r\n        return \"NodeRenderGraphCullObjectsBlock\";\r\n    }\r\n\r\n    /**\r\n     * Gets the camera input component\r\n     */\r\n    public get camera(): NodeRenderGraphConnectionPoint {\r\n        return this._inputs[0];\r\n    }\r\n\r\n    /**\r\n     * Gets the objects input component\r\n     */\r\n    public get objects(): NodeRenderGraphConnectionPoint {\r\n        return this._inputs[1];\r\n    }\r\n\r\n    /**\r\n     * Gets the output component\r\n     */\r\n    public get output(): NodeRenderGraphConnectionPoint {\r\n        return this._outputs[0];\r\n    }\r\n\r\n    protected override _buildBlock(state: NodeRenderGraphBuildState) {\r\n        super._buildBlock(state);\r\n\r\n        this.output.value = this._frameGraphTask.outputObjectList;\r\n\r\n        this._frameGraphTask.camera = this.camera.connectedPoint?.value as Camera;\r\n        this._frameGraphTask.objectList = this.objects.connectedPoint?.value as FrameGraphObjectList;\r\n    }\r\n\r\n    protected override _dumpPropertiesCode() {\r\n        const codes: string[] = [];\r\n        return super._dumpPropertiesCode() + codes.join(\"\\n\");\r\n    }\r\n\r\n    public override serialize(): any {\r\n        const serializationObject = super.serialize();\r\n        return serializationObject;\r\n    }\r\n\r\n    public override _deserialize(serializationObject: any) {\r\n        super._deserialize(serializationObject);\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.NodeRenderGraphCullObjectsBlock\", NodeRenderGraphCullObjectsBlock);\r\n", "import type {\r\n    Observer,\r\n    Nullable,\r\n    NodeRenderGraphBlock,\r\n    NodeRenderGraphTeleportOutBlock,\r\n    NodeRenderGraphTeleportInBlock,\r\n    AbstractEngine,\r\n    INodeRenderGraphCreateOptions,\r\n    INodeRenderGraphEditorOptions,\r\n    Scene,\r\n    WritableObject,\r\n    IShadowLight,\r\n    INodeRenderGraphCustomBlockDescription,\r\n    Immutable,\r\n} from \"core/index\";\r\nimport { Observable } from \"../../Misc/observable\";\r\nimport { NodeRenderGraphOutputBlock } from \"./Blocks/outputBlock\";\r\nimport { FrameGraph } from \"../frameGraph\";\r\nimport { GetClass } from \"../../Misc/typeStore\";\r\nimport { serialize } from \"../../Misc/decorators\";\r\nimport { SerializationHelper } from \"../../Misc/decorators.serialization\";\r\nimport { Constants } from \"../../Engines/constants\";\r\nimport { WebRequest } from \"../../Misc/webRequest\";\r\nimport { NodeRenderGraphInputBlock } from \"./Blocks/inputBlock\";\r\nimport { Tools } from \"../../Misc/tools\";\r\nimport { Engine } from \"../../Engines/engine\";\r\nimport { NodeRenderGraphBlockConnectionPointTypes } from \"./Types/nodeRenderGraphTypes\";\r\nimport { NodeRenderGraphClearBlock } from \"./Blocks/Textures/clearBlock\";\r\nimport { NodeRenderGraphBaseObjectRendererBlock } from \"./Blocks/Rendering/baseObjectRendererBlock\";\r\nimport { NodeRenderGraphObjectRendererBlock } from \"./Blocks/Rendering/objectRendererBlock\";\r\nimport { NodeRenderGraphBuildState } from \"./nodeRenderGraphBuildState\";\r\nimport { NodeRenderGraphCullObjectsBlock } from \"./Blocks/cullObjectsBlock\";\r\n\r\n// declare NODERENDERGRAPHEDITOR namespace for compilation issue\r\n// eslint-disable-next-line @typescript-eslint/naming-convention\r\ndeclare let NODERENDERGRAPHEDITOR: any;\r\n// eslint-disable-next-line @typescript-eslint/naming-convention\r\ndeclare let BABYLON: any;\r\n\r\n/**\r\n * Defines a node render graph\r\n */\r\nexport class NodeRenderGraph {\r\n    private static _BuildIdGenerator: number = 0;\r\n\r\n    private _buildId: number = NodeRenderGraph._BuildIdGenerator++;\r\n\r\n    /** Define the Url to load node editor script */\r\n    public static EditorURL = `${Tools._DefaultCdnUrl}/v${Engine.Version}/NodeRenderGraph/babylon.nodeRenderGraph.js`;\r\n\r\n    /** Define the Url to load snippets */\r\n    public static SnippetUrl = Constants.SnippetUrl;\r\n\r\n    /** Description of custom blocks to use in the node render graph editor */\r\n    public static CustomBlockDescriptions: INodeRenderGraphCustomBlockDescription[] = [];\r\n\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    private BJSNODERENDERGRAPHEDITOR = this._getGlobalNodeRenderGraphEditor();\r\n\r\n    /** @returns the inspector from bundle or global */\r\n    private _getGlobalNodeRenderGraphEditor(): any {\r\n        // UMD Global name detection from Webpack Bundle UMD Name.\r\n        if (typeof NODERENDERGRAPHEDITOR !== \"undefined\") {\r\n            return NODERENDERGRAPHEDITOR;\r\n        }\r\n\r\n        // In case of module let's check the global emitted from the editor entry point.\r\n        if (typeof BABYLON !== \"undefined\" && typeof BABYLON.NodeRenderGraphEditor !== \"undefined\") {\r\n            return BABYLON;\r\n        }\r\n\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * Gets or sets data used by visual editor\r\n     * @see https://nrge.babylonjs.com\r\n     */\r\n    public editorData: any = null;\r\n\r\n    /**\r\n     * Gets an array of blocks that needs to be serialized even if they are not yet connected\r\n     */\r\n    public attachedBlocks: NodeRenderGraphBlock[] = [];\r\n\r\n    /**\r\n     * Observable raised before the node render graph is built\r\n     */\r\n    public onBeforeBuildObservable = new Observable<FrameGraph>();\r\n\r\n    /**\r\n     * Observable raised after the node render graph is built\r\n     * Note that this is the same observable as the one in the underlying FrameGraph!\r\n     */\r\n    public get onBuildObservable() {\r\n        return this._frameGraph.onBuildObservable;\r\n    }\r\n\r\n    /**\r\n     * Observable raised when an error is detected\r\n     */\r\n    public onBuildErrorObservable = new Observable<string>();\r\n\r\n    /** Gets or sets the RenderGraphOutputBlock used to gather the final node render graph data */\r\n    public outputBlock: Nullable<NodeRenderGraphOutputBlock> = null;\r\n\r\n    /**\r\n     * Snippet ID if the graph was created from the snippet server\r\n     */\r\n    public snippetId: string;\r\n\r\n    /**\r\n     * The name of the node render graph\r\n     */\r\n    @serialize()\r\n    public name: string;\r\n\r\n    /**\r\n     * A free comment about the graph\r\n     */\r\n    @serialize(\"comment\")\r\n    public comment: string;\r\n\r\n    private readonly _engine: AbstractEngine;\r\n    private readonly _scene: Scene;\r\n    private readonly _resizeObserver: Nullable<Observer<AbstractEngine>> = null;\r\n    private readonly _frameGraph: FrameGraph;\r\n    private readonly _options: INodeRenderGraphCreateOptions;\r\n\r\n    /**\r\n     * Gets the frame graph used by this node render graph\r\n     */\r\n    public get frameGraph() {\r\n        return this._frameGraph;\r\n    }\r\n\r\n    /**\r\n     * Gets the scene used by this node render graph\r\n     * @returns the scene used by this node render graph\r\n     */\r\n    public getScene() {\r\n        return this._scene;\r\n    }\r\n\r\n    /**\r\n     * Gets the options used to create this node render graph\r\n     */\r\n    public get options(): Immutable<INodeRenderGraphCreateOptions> {\r\n        return this._options;\r\n    }\r\n\r\n    /**\r\n     * Creates a new node render graph\r\n     * @param name defines the name of the node render graph\r\n     * @param scene defines the scene to use to execute the graph\r\n     * @param options defines the options to use when creating the graph\r\n     */\r\n    public constructor(name: string, scene: Scene, options?: INodeRenderGraphCreateOptions) {\r\n        this.name = name;\r\n        this._scene = scene;\r\n        this._engine = scene.getEngine();\r\n\r\n        options = {\r\n            debugTextures: false,\r\n            autoConfigure: false,\r\n            verbose: false,\r\n            rebuildGraphOnEngineResize: true,\r\n            autoFillExternalInputs: true,\r\n            ...options,\r\n        };\r\n\r\n        this._options = options;\r\n\r\n        this._frameGraph = new FrameGraph(this._scene, options.debugTextures, this);\r\n        this._frameGraph.name = name;\r\n\r\n        if (options.rebuildGraphOnEngineResize) {\r\n            this._resizeObserver = this._engine.onResizeObservable.add(async () => {\r\n                await this.buildAsync(false, true, false);\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Gets the current class name (\"NodeRenderGraph\")\r\n     * @returns the class name\r\n     */\r\n    public getClassName(): string {\r\n        return \"NodeRenderGraph\";\r\n    }\r\n\r\n    /**\r\n     * Gets a block by its name\r\n     * @param name defines the name of the block to retrieve\r\n     * @returns the required block or null if not found\r\n     */\r\n    public getBlockByName<T extends NodeRenderGraphBlock>(name: string): Nullable<T> {\r\n        let result: Nullable<T> = null;\r\n        for (const block of this.attachedBlocks) {\r\n            if (block.name === name) {\r\n                if (!result) {\r\n                    result = block as T;\r\n                } else {\r\n                    Tools.Warn(\"More than one block was found with the name `\" + name + \"`\");\r\n                    return result;\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Get a block using a predicate\r\n     * @param predicate defines the predicate used to find the good candidate\r\n     * @returns the required block or null if not found\r\n     */\r\n    public getBlockByPredicate<T extends NodeRenderGraphBlock>(predicate: (block: NodeRenderGraphBlock) => boolean): Nullable<T> {\r\n        for (const block of this.attachedBlocks) {\r\n            if (predicate(block)) {\r\n                return block as T;\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Get all blocks that match a predicate\r\n     * @param predicate defines the predicate used to find the good candidate(s)\r\n     * @returns the list of blocks found\r\n     */\r\n    public getBlocksByPredicate<T extends NodeRenderGraphBlock>(predicate: (block: NodeRenderGraphBlock) => boolean): T[] {\r\n        const blocks: T[] = [];\r\n        for (const block of this.attachedBlocks) {\r\n            if (predicate(block)) {\r\n                blocks.push(block as T);\r\n            }\r\n        }\r\n\r\n        return blocks;\r\n    }\r\n\r\n    /**\r\n     * Gets the list of input blocks attached to this material\r\n     * @returns an array of InputBlocks\r\n     */\r\n    public getInputBlocks() {\r\n        const blocks: NodeRenderGraphInputBlock[] = [];\r\n        for (const block of this.attachedBlocks) {\r\n            if (block.isInput) {\r\n                blocks.push(block as NodeRenderGraphInputBlock);\r\n            }\r\n        }\r\n\r\n        return blocks;\r\n    }\r\n\r\n    /**\r\n     * Launch the node render graph editor\r\n     * @param config Define the configuration of the editor\r\n     * @returns a promise fulfilled when the node editor is visible\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    public async edit(config?: INodeRenderGraphEditorOptions): Promise<void> {\r\n        return await new Promise((resolve) => {\r\n            this.BJSNODERENDERGRAPHEDITOR = this.BJSNODERENDERGRAPHEDITOR || this._getGlobalNodeRenderGraphEditor();\r\n            if (typeof this.BJSNODERENDERGRAPHEDITOR == \"undefined\") {\r\n                const editorUrl = config && config.editorURL ? config.editorURL : NodeRenderGraph.EditorURL;\r\n\r\n                // Load editor and add it to the DOM\r\n                Tools.LoadBabylonScript(editorUrl, () => {\r\n                    this.BJSNODERENDERGRAPHEDITOR = this.BJSNODERENDERGRAPHEDITOR || this._getGlobalNodeRenderGraphEditor();\r\n                    this._createNodeEditor(config?.nodeRenderGraphEditorConfig);\r\n                    resolve();\r\n                });\r\n            } else {\r\n                // Otherwise creates the editor\r\n                this._createNodeEditor(config?.nodeRenderGraphEditorConfig);\r\n                resolve();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Creates the node editor window.\r\n     * @param additionalConfig Additional configuration for the FGE\r\n     */\r\n    private _createNodeEditor(additionalConfig?: any) {\r\n        const nodeEditorConfig: any = {\r\n            nodeRenderGraph: this,\r\n            customBlockDescriptions: NodeRenderGraph.CustomBlockDescriptions,\r\n            ...additionalConfig,\r\n        };\r\n        this.BJSNODERENDERGRAPHEDITOR.NodeRenderGraphEditor.Show(nodeEditorConfig);\r\n    }\r\n\r\n    /**\r\n     * Build the final list of blocks that will be executed by the \"execute\" method.\r\n     * It also builds the underlying frame graph unless specified otherwise.\r\n     * @param dontBuildFrameGraph If the underlying frame graph should not be built (default: false)\r\n     * @param waitForReadiness If the method should wait for the frame graph to be ready before resolving (default: true). Note that this parameter has no effect if \"dontBuildFrameGraph\" is true.\r\n     * @param setAsSceneFrameGraph If the built frame graph must be set as the scene's frame graph (default: true)\r\n     */\r\n    public async buildAsync(dontBuildFrameGraph = false, waitForReadiness = true, setAsSceneFrameGraph = true): Promise<void> {\r\n        if (!this.outputBlock) {\r\n            throw new Error(\"You must define the outputBlock property before building the node render graph\");\r\n        }\r\n\r\n        if (setAsSceneFrameGraph) {\r\n            this._scene.frameGraph = this._frameGraph;\r\n        }\r\n\r\n        this._initializeBlock(this.outputBlock);\r\n\r\n        this._frameGraph.clear();\r\n\r\n        const state = new NodeRenderGraphBuildState();\r\n\r\n        state.buildId = this._buildId;\r\n        state.verbose = this._options.verbose!;\r\n\r\n        if (this._options.autoFillExternalInputs) {\r\n            this._autoFillExternalInputs();\r\n        }\r\n\r\n        this.onBeforeBuildObservable.notifyObservers(this._frameGraph);\r\n\r\n        // Make sure that one of the object renderer is flagged as the main object renderer\r\n        const objectRendererBlocks = this.getBlocksByPredicate<NodeRenderGraphBaseObjectRendererBlock>((block) => block instanceof NodeRenderGraphBaseObjectRendererBlock);\r\n        if (objectRendererBlocks.length > 0 && !objectRendererBlocks.find((block) => block.isMainObjectRenderer)) {\r\n            objectRendererBlocks[0].isMainObjectRenderer = true;\r\n        }\r\n\r\n        try {\r\n            this.outputBlock.build(state);\r\n\r\n            if (!dontBuildFrameGraph) {\r\n                await this._frameGraph.buildAsync(waitForReadiness);\r\n            }\r\n        } finally {\r\n            this._buildId = NodeRenderGraph._BuildIdGenerator++;\r\n\r\n            state.emitErrors(this.onBuildErrorObservable);\r\n        }\r\n    }\r\n\r\n    private _autoFillExternalInputs() {\r\n        const allInputs = this.getInputBlocks();\r\n\r\n        const shadowLights: IShadowLight[] = [];\r\n        for (const light of this._scene.lights) {\r\n            if ((light as IShadowLight).setShadowProjectionMatrix !== undefined) {\r\n                shadowLights.push(light as IShadowLight);\r\n            }\r\n        }\r\n\r\n        let cameraIndex = 0;\r\n        let lightIndex = 0;\r\n        for (const input of allInputs) {\r\n            if (!input.isExternal) {\r\n                continue;\r\n            }\r\n            if (!input.isAnAncestorOfType(\"NodeRenderGraphOutputBlock\")) {\r\n                continue;\r\n            }\r\n            if ((input.type & NodeRenderGraphBlockConnectionPointTypes.TextureAllButBackBuffer) !== 0) {\r\n                // nothing to do\r\n            } else if (input.isCamera()) {\r\n                const camera = this._scene.cameras[cameraIndex++] || this._scene.cameras[0];\r\n                if (!this._scene.cameraToUseForPointers) {\r\n                    this._scene.cameraToUseForPointers = camera;\r\n                }\r\n\r\n                input.value = camera;\r\n            } else if (input.isObjectList()) {\r\n                input.value = { meshes: this._scene.meshes, particleSystems: this._scene.particleSystems };\r\n            } else if (input.isShadowLight()) {\r\n                if (lightIndex < shadowLights.length) {\r\n                    input.value = shadowLights[lightIndex++];\r\n                    lightIndex = lightIndex % shadowLights.length;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns a promise that resolves when the node render graph is ready to be executed\r\n     * This method must be called after the graph has been built (NodeRenderGraph.build called)!\r\n     * @param timeStep Time step in ms between retries (default is 16)\r\n     * @param maxTimeout Maximum time in ms to wait for the graph to be ready (default is 10000)\r\n     * @returns The promise that resolves when the graph is ready\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/promise-function-async, no-restricted-syntax\r\n    public async whenReadyAsync(timeStep = 16, maxTimeout = 10000): Promise<void> {\r\n        this._frameGraph.pausedExecution = true;\r\n        await this._frameGraph.whenReadyAsync(timeStep, maxTimeout);\r\n        this._frameGraph.pausedExecution = false;\r\n    }\r\n\r\n    /**\r\n     * Execute the graph (the graph must have been built before!)\r\n     */\r\n    public execute() {\r\n        this._frameGraph.execute();\r\n    }\r\n\r\n    private _initializeBlock(node: NodeRenderGraphBlock) {\r\n        node.initialize();\r\n        if (this._options.autoConfigure) {\r\n            node.autoConfigure();\r\n        }\r\n\r\n        if (this.attachedBlocks.indexOf(node) === -1) {\r\n            this.attachedBlocks.push(node);\r\n        }\r\n\r\n        for (const input of node.inputs) {\r\n            const connectedPoint = input.connectedPoint;\r\n            if (connectedPoint) {\r\n                const block = connectedPoint.ownerBlock;\r\n                if (block !== node) {\r\n                    this._initializeBlock(block);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clear the current graph\r\n     */\r\n    public clear() {\r\n        this.outputBlock = null;\r\n        this.attachedBlocks.length = 0;\r\n    }\r\n\r\n    /**\r\n     * Remove a block from the current graph\r\n     * @param block defines the block to remove\r\n     */\r\n    public removeBlock(block: NodeRenderGraphBlock) {\r\n        const attachedBlockIndex = this.attachedBlocks.indexOf(block);\r\n        if (attachedBlockIndex > -1) {\r\n            this.attachedBlocks.splice(attachedBlockIndex, 1);\r\n        }\r\n\r\n        if (block === this.outputBlock) {\r\n            this.outputBlock = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clear the current graph and load a new one from a serialization object\r\n     * @param source defines the JSON representation of the graph\r\n     * @param merge defines whether or not the source must be merged or replace the current content\r\n     */\r\n    public parseSerializedObject(source: any, merge = false) {\r\n        if (!merge) {\r\n            this.clear();\r\n        }\r\n\r\n        const map: { [key: number]: NodeRenderGraphBlock } = {};\r\n\r\n        // Create blocks\r\n        for (const parsedBlock of source.blocks) {\r\n            const blockType: typeof NodeRenderGraphBlock = GetClass(parsedBlock.customType);\r\n            if (blockType) {\r\n                const additionalConstructionParameters = parsedBlock.additionalConstructionParameters;\r\n                const block: NodeRenderGraphBlock = additionalConstructionParameters\r\n                    ? new blockType(\"\", this._frameGraph, this._scene, ...additionalConstructionParameters)\r\n                    : new blockType(\"\", this._frameGraph, this._scene);\r\n                block._deserialize(parsedBlock);\r\n                map[parsedBlock.id] = block;\r\n\r\n                this.attachedBlocks.push(block);\r\n            }\r\n        }\r\n\r\n        // Reconnect teleportation\r\n        for (const block of this.attachedBlocks) {\r\n            if (block.isTeleportOut) {\r\n                const teleportOut = block as NodeRenderGraphTeleportOutBlock;\r\n                const id = teleportOut._tempEntryPointUniqueId;\r\n                if (id) {\r\n                    const source = map[id] as NodeRenderGraphTeleportInBlock;\r\n                    if (source) {\r\n                        source.attachToEndpoint(teleportOut);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Connections - Starts with input blocks only (except if in \"merge\" mode where we scan all blocks)\r\n        for (let blockIndex = 0; blockIndex < source.blocks.length; blockIndex++) {\r\n            const parsedBlock = source.blocks[blockIndex];\r\n            const block = map[parsedBlock.id];\r\n\r\n            if (!block) {\r\n                continue;\r\n            }\r\n\r\n            if (block.inputs.length && parsedBlock.inputs.some((i: any) => i.targetConnectionName) && !merge) {\r\n                continue;\r\n            }\r\n            this._restoreConnections(block, source, map);\r\n        }\r\n\r\n        // Outputs\r\n        if (source.outputNodeId) {\r\n            this.outputBlock = map[source.outputNodeId] as NodeRenderGraphOutputBlock;\r\n        }\r\n\r\n        // UI related info\r\n        if (source.locations || (source.editorData && source.editorData.locations)) {\r\n            const locations: {\r\n                blockId: number;\r\n                x: number;\r\n                y: number;\r\n                isCollapsed: boolean;\r\n            }[] = source.locations || source.editorData.locations;\r\n\r\n            for (const location of locations) {\r\n                if (map[location.blockId]) {\r\n                    location.blockId = map[location.blockId].uniqueId;\r\n                }\r\n            }\r\n\r\n            if (merge && this.editorData && this.editorData.locations) {\r\n                locations.concat(this.editorData.locations);\r\n            }\r\n\r\n            if (source.locations) {\r\n                this.editorData = {\r\n                    locations: locations,\r\n                };\r\n            } else {\r\n                this.editorData = source.editorData;\r\n                this.editorData.locations = locations;\r\n            }\r\n\r\n            const blockMap: { [key: number]: number } = {};\r\n\r\n            for (const key in map) {\r\n                blockMap[key] = map[key].uniqueId;\r\n            }\r\n\r\n            this.editorData.map = blockMap;\r\n        }\r\n\r\n        this.comment = source.comment;\r\n    }\r\n\r\n    private _restoreConnections(block: NodeRenderGraphBlock, source: any, map: { [key: number]: NodeRenderGraphBlock }) {\r\n        for (const outputPoint of block.outputs) {\r\n            for (const candidate of source.blocks) {\r\n                const target = map[candidate.id];\r\n\r\n                if (!target) {\r\n                    continue;\r\n                }\r\n\r\n                for (const input of candidate.inputs) {\r\n                    if (map[input.targetBlockId] === block && input.targetConnectionName === outputPoint.name) {\r\n                        const inputPoint = target.getInputByName(input.inputName);\r\n                        if (!inputPoint || inputPoint.isConnected) {\r\n                            continue;\r\n                        }\r\n\r\n                        outputPoint.connectTo(inputPoint, true);\r\n                        this._restoreConnections(target, source, map);\r\n                        continue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Generate a string containing the code declaration required to create an equivalent of this node render graph\r\n     * @returns a string\r\n     */\r\n    public generateCode() {\r\n        let alreadyDumped: NodeRenderGraphBlock[] = [];\r\n        const blocks: NodeRenderGraphBlock[] = [];\r\n        const uniqueNames: string[] = [\"const\", \"var\", \"let\"];\r\n        // Gets active blocks\r\n        if (this.outputBlock) {\r\n            this._gatherBlocks(this.outputBlock, blocks);\r\n        }\r\n\r\n        // Generate\r\n        const options = JSON.stringify(this._options);\r\n        let codeString = `let nodeRenderGraph = new BABYLON.NodeRenderGraph(\"${this.name || \"render graph\"}\", scene, ${options});\\n`;\r\n        for (const node of blocks) {\r\n            if (node.isInput && alreadyDumped.indexOf(node) === -1) {\r\n                codeString += node._dumpCode(uniqueNames, alreadyDumped) + \"\\n\";\r\n            }\r\n        }\r\n\r\n        if (this.outputBlock) {\r\n            // Connections\r\n            alreadyDumped = [];\r\n            codeString += \"// Connections\\n\";\r\n            codeString += this.outputBlock._dumpCodeForOutputConnections(alreadyDumped);\r\n\r\n            // Output nodes\r\n            codeString += \"// Output nodes\\n\";\r\n            codeString += `nodeRenderGraph.outputBlock = ${this.outputBlock._codeVariableName};\\n`;\r\n            codeString += `nodeRenderGraph.build();\\n`;\r\n        }\r\n\r\n        return codeString;\r\n    }\r\n\r\n    private _gatherBlocks(rootNode: NodeRenderGraphBlock, list: NodeRenderGraphBlock[]) {\r\n        if (list.indexOf(rootNode) !== -1) {\r\n            return;\r\n        }\r\n        list.push(rootNode);\r\n\r\n        for (const input of rootNode.inputs) {\r\n            const connectedPoint = input.connectedPoint;\r\n            if (connectedPoint) {\r\n                const block = connectedPoint.ownerBlock;\r\n                if (block !== rootNode) {\r\n                    this._gatherBlocks(block, list);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Teleportation\r\n        if (rootNode.isTeleportOut) {\r\n            const block = rootNode as NodeRenderGraphTeleportOutBlock;\r\n            if (block.entryPoint) {\r\n                this._gatherBlocks(block.entryPoint, list);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clear the current graph and set it to a default state\r\n     */\r\n    public setToDefault() {\r\n        this.clear();\r\n\r\n        this.editorData = null;\r\n\r\n        // Source textures\r\n        const colorTexture = new NodeRenderGraphInputBlock(\"Color Texture\", this._frameGraph, this._scene, NodeRenderGraphBlockConnectionPointTypes.Texture);\r\n        colorTexture.creationOptions.options.samples = 4;\r\n\r\n        const depthTexture = new NodeRenderGraphInputBlock(\"Depth Texture\", this._frameGraph, this._scene, NodeRenderGraphBlockConnectionPointTypes.TextureDepthStencilAttachment);\r\n        depthTexture.creationOptions.options.samples = 4;\r\n\r\n        // Clear texture\r\n        const clear = new NodeRenderGraphClearBlock(\"Clear\", this._frameGraph, this._scene);\r\n        clear.clearDepth = true;\r\n        clear.clearStencil = true;\r\n\r\n        colorTexture.output.connectTo(clear.target);\r\n        depthTexture.output.connectTo(clear.depth);\r\n\r\n        // Object list and culling\r\n        const camera = new NodeRenderGraphInputBlock(\"Camera\", this._frameGraph, this._scene, NodeRenderGraphBlockConnectionPointTypes.Camera);\r\n        const objectList = new NodeRenderGraphInputBlock(\"Object List\", this._frameGraph, this._scene, NodeRenderGraphBlockConnectionPointTypes.ObjectList);\r\n        const cull = new NodeRenderGraphCullObjectsBlock(\"Cull\", this._frameGraph, this._scene);\r\n\r\n        camera.output.connectTo(cull.camera);\r\n        objectList.output.connectTo(cull.objects);\r\n\r\n        // Render objects\r\n        const mainRendering = new NodeRenderGraphObjectRendererBlock(\"Main Rendering\", this._frameGraph, this._scene);\r\n\r\n        camera.output.connectTo(mainRendering.camera);\r\n        cull.output.connectTo(mainRendering.objects);\r\n        clear.output.connectTo(mainRendering.target);\r\n        clear.outputDepth.connectTo(mainRendering.depth);\r\n\r\n        // Final output\r\n        const output = new NodeRenderGraphOutputBlock(\"Output\", this._frameGraph, this._scene);\r\n        mainRendering.output.connectTo(output.texture);\r\n\r\n        this.outputBlock = output;\r\n    }\r\n\r\n    /**\r\n     * Makes a duplicate of the current node render graph.\r\n     * Note that you should call buildAsync() on the returned graph to make it usable.\r\n     * @param name defines the name to use for the new node render graph\r\n     * @returns the new node render graph\r\n     */\r\n    public clone(name: string): NodeRenderGraph {\r\n        const serializationObject = this.serialize();\r\n\r\n        const clone = SerializationHelper.Clone(() => new NodeRenderGraph(name, this._scene), this);\r\n        clone.name = name;\r\n\r\n        clone.parseSerializedObject(serializationObject);\r\n        clone._buildId = this._buildId;\r\n\r\n        return clone;\r\n    }\r\n\r\n    /**\r\n     * Serializes this node render graph in a JSON representation\r\n     * @param selectedBlocks defines the list of blocks to save (if null the whole node render graph will be saved)\r\n     * @returns the serialized node render graph object\r\n     */\r\n    public serialize(selectedBlocks?: NodeRenderGraphBlock[]): any {\r\n        const serializationObject = selectedBlocks ? {} : SerializationHelper.Serialize(this);\r\n        serializationObject.editorData = JSON.parse(JSON.stringify(this.editorData)); // Copy\r\n\r\n        let blocks: NodeRenderGraphBlock[] = [];\r\n\r\n        if (selectedBlocks) {\r\n            blocks = selectedBlocks;\r\n        } else {\r\n            serializationObject.customType = \"BABYLON.NodeRenderGraph\";\r\n            if (this.outputBlock) {\r\n                serializationObject.outputNodeId = this.outputBlock.uniqueId;\r\n            }\r\n        }\r\n\r\n        // Blocks\r\n        serializationObject.blocks = [];\r\n\r\n        for (const block of blocks) {\r\n            serializationObject.blocks.push(block.serialize());\r\n        }\r\n\r\n        if (!selectedBlocks) {\r\n            for (const block of this.attachedBlocks) {\r\n                if (blocks.indexOf(block) !== -1) {\r\n                    continue;\r\n                }\r\n                serializationObject.blocks.push(block.serialize());\r\n            }\r\n        }\r\n\r\n        return serializationObject;\r\n    }\r\n\r\n    /**\r\n     * Disposes the resources\r\n     */\r\n    public dispose(): void {\r\n        for (const block of this.attachedBlocks) {\r\n            block.dispose();\r\n        }\r\n\r\n        this._frameGraph.dispose();\r\n        (this._frameGraph as WritableObject<FrameGraph>) = undefined as any;\r\n\r\n        this._engine.onResizeObservable.remove(this._resizeObserver);\r\n        (this._resizeObserver as WritableObject<Nullable<Observer<AbstractEngine>>>) = null;\r\n\r\n        this.attachedBlocks.length = 0;\r\n        this.onBuildErrorObservable.clear();\r\n    }\r\n\r\n    /**\r\n     * Creates a new node render graph set to default basic configuration\r\n     * @param name defines the name of the node render graph\r\n     * @param scene defines the scene to use\r\n     * @param nodeRenderGraphOptions defines options to use when creating the node render graph\r\n     * @returns a new NodeRenderGraph\r\n     */\r\n    public static async CreateDefaultAsync(name: string, scene: Scene, nodeRenderGraphOptions?: INodeRenderGraphCreateOptions): Promise<NodeRenderGraph> {\r\n        const renderGraph = new NodeRenderGraph(name, scene, nodeRenderGraphOptions);\r\n\r\n        renderGraph.setToDefault();\r\n        await renderGraph.buildAsync(false, true, false);\r\n\r\n        return renderGraph;\r\n    }\r\n\r\n    /**\r\n     * Creates a node render graph from parsed graph data\r\n     * @param source defines the JSON representation of the node render graph\r\n     * @param scene defines the scene to use\r\n     * @param nodeRenderGraphOptions defines options to use when creating the node render\r\n     * @param skipBuild defines whether to skip building the node render graph (default is true)\r\n     * @returns a new node render graph\r\n     */\r\n    public static Parse(source: any, scene: Scene, nodeRenderGraphOptions?: INodeRenderGraphCreateOptions, skipBuild: boolean = true): NodeRenderGraph {\r\n        const renderGraph = SerializationHelper.Parse(() => new NodeRenderGraph(source.name, scene, nodeRenderGraphOptions), source, null);\r\n\r\n        renderGraph.parseSerializedObject(source);\r\n        if (!skipBuild) {\r\n            void renderGraph.buildAsync();\r\n        }\r\n\r\n        return renderGraph;\r\n    }\r\n\r\n    /**\r\n     * Creates a node render graph from a snippet saved by the node render graph editor\r\n     * @param snippetId defines the snippet to load\r\n     * @param scene defines the scene to use\r\n     * @param nodeRenderGraphOptions defines options to use when creating the node render graph\r\n     * @param nodeRenderGraph defines a node render graph to update (instead of creating a new one)\r\n     * @param skipBuild defines whether to skip building the node render graph (default is true)\r\n     * @returns a promise that will resolve to the new node render graph\r\n     */\r\n    // eslint-disable-next-line @typescript-eslint/promise-function-async, no-restricted-syntax\r\n    public static ParseFromSnippetAsync(\r\n        snippetId: string,\r\n        scene: Scene,\r\n        nodeRenderGraphOptions?: INodeRenderGraphCreateOptions,\r\n        nodeRenderGraph?: NodeRenderGraph,\r\n        skipBuild: boolean = true\r\n    ): Promise<NodeRenderGraph> {\r\n        if (snippetId === \"_BLANK\") {\r\n            return NodeRenderGraph.CreateDefaultAsync(\"blank\", scene, nodeRenderGraphOptions);\r\n        }\r\n\r\n        return new Promise((resolve, reject) => {\r\n            const request = new WebRequest();\r\n            request.addEventListener(\"readystatechange\", async () => {\r\n                if (request.readyState == 4) {\r\n                    if (request.status == 200) {\r\n                        const snippet = JSON.parse(JSON.parse(request.responseText).jsonPayload);\r\n                        const serializationObject = JSON.parse(snippet.nodeRenderGraph);\r\n\r\n                        if (!nodeRenderGraph) {\r\n                            nodeRenderGraph = SerializationHelper.Parse(() => new NodeRenderGraph(snippetId, scene, nodeRenderGraphOptions), serializationObject, null);\r\n                        }\r\n\r\n                        nodeRenderGraph.parseSerializedObject(serializationObject);\r\n                        nodeRenderGraph.snippetId = snippetId;\r\n\r\n                        try {\r\n                            if (!skipBuild) {\r\n                                await nodeRenderGraph.buildAsync();\r\n                            }\r\n                            resolve(nodeRenderGraph);\r\n                        } catch (err) {\r\n                            // eslint-disable-next-line @typescript-eslint/prefer-promise-reject-errors\r\n                            reject(err);\r\n                        }\r\n                    } else {\r\n                        // eslint-disable-next-line @typescript-eslint/prefer-promise-reject-errors\r\n                        reject(\"Unable to load the snippet \" + snippetId);\r\n                    }\r\n                }\r\n            });\r\n\r\n            request.open(\"GET\", this.SnippetUrl + \"/\" + snippetId.replace(/#/g, \"/\"));\r\n            request.send();\r\n        });\r\n    }\r\n}\r\n", "import { serialize, serializeAsColor3, expandToProperty, serializeAsTexture } from \"../../Misc/decorators\";\r\nimport { GetEnvironmentBRDFTexture } from \"../../Misc/brdfTextureTools\";\r\nimport type { Nullable } from \"../../types\";\r\nimport type { Scene } from \"../../scene\";\r\nimport { Color3 } from \"../../Maths/math.color\";\r\nimport type { BaseTexture } from \"../../Materials/Textures/baseTexture\";\r\nimport { PBRBaseMaterial } from \"./pbrBaseMaterial\";\r\nimport { RegisterClass } from \"../../Misc/typeStore\";\r\nimport { Material } from \"../material\";\r\nimport { SerializationHelper } from \"../../Misc/decorators.serialization\";\r\n\r\n/**\r\n * The Physically based material of BJS.\r\n *\r\n * This offers the main features of a standard PBR material.\r\n * For more information, please refer to the documentation :\r\n * https://doc.babylonjs.com/features/featuresDeepDive/materials/using/introToPBR\r\n */\r\nexport class PBRMaterial extends PBRBaseMaterial {\r\n    /**\r\n     * PBRMaterialTransparencyMode: No transparency mode, Alpha channel is not use.\r\n     */\r\n    public static override readonly PBRMATERIAL_OPAQUE = PBRBaseMaterial.PBRMATERIAL_OPAQUE;\r\n\r\n    /**\r\n     * PBRMaterialTransparencyMode: Alpha Test mode, pixel are discarded below a certain threshold defined by the alpha cutoff value.\r\n     */\r\n    public static override readonly PBRMATERIAL_ALPHATEST = PBRBaseMaterial.PBRMATERIAL_ALPHATEST;\r\n\r\n    /**\r\n     * PBRMaterialTransparencyMode: Pixels are blended (according to the alpha mode) with the already drawn pixels in the current frame buffer.\r\n     */\r\n    public static override readonly PBRMATERIAL_ALPHABLEND = PBRBaseMaterial.PBRMATERIAL_ALPHABLEND;\r\n\r\n    /**\r\n     * PBRMaterialTransparencyMode: Pixels are blended (according to the alpha mode) with the already drawn pixels in the current frame buffer.\r\n     * They are also discarded below the alpha cutoff threshold to improve performances.\r\n     */\r\n    public static override readonly PBRMATERIAL_ALPHATESTANDBLEND = PBRBaseMaterial.PBRMATERIAL_ALPHATESTANDBLEND;\r\n\r\n    /**\r\n     * Defines the default value of how much AO map is occluding the analytical lights\r\n     * (point spot...).\r\n     */\r\n    public static override DEFAULT_AO_ON_ANALYTICAL_LIGHTS = PBRBaseMaterial.DEFAULT_AO_ON_ANALYTICAL_LIGHTS;\r\n\r\n    /**\r\n     * Intensity of the direct lights e.g. the four lights available in your scene.\r\n     * This impacts both the direct diffuse and specular highlights.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public directIntensity: number = 1.0;\r\n\r\n    /**\r\n     * Intensity of the emissive part of the material.\r\n     * This helps controlling the emissive effect without modifying the emissive color.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public emissiveIntensity: number = 1.0;\r\n\r\n    /**\r\n     * Intensity of the environment e.g. how much the environment will light the object\r\n     * either through harmonics for rough material or through the reflection for shiny ones.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public environmentIntensity: number = 1.0;\r\n\r\n    /**\r\n     * This is a special control allowing the reduction of the specular highlights coming from the\r\n     * four lights of the scene. Those highlights may not be needed in full environment lighting.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public specularIntensity: number = 1.0;\r\n\r\n    /**\r\n     * Debug Control allowing disabling the bump map on this material.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public disableBumpMap: boolean = false;\r\n\r\n    /**\r\n     * AKA Diffuse Texture in standard nomenclature.\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public albedoTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * OpenPBR Base Weight texture (multiplier to the diffuse and metal lobes).\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public baseWeightTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * OpenPBR Base Diffuse Roughness texture (roughness of the diffuse lobe).\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public baseDiffuseRoughnessTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * AKA Occlusion Texture in other nomenclature.\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public ambientTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * AKA Occlusion Texture Intensity in other nomenclature.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public ambientTextureStrength: number = 1.0;\r\n\r\n    /**\r\n     * Defines how much the AO map is occluding the analytical lights (point spot...).\r\n     * 1 means it completely occludes it\r\n     * 0 mean it has no impact\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public ambientTextureImpactOnAnalyticalLights: number = PBRMaterial.DEFAULT_AO_ON_ANALYTICAL_LIGHTS;\r\n\r\n    /**\r\n     * Stores the alpha values in a texture. Use luminance if texture.getAlphaFromRGB is true.\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesAndMiscDirty\")\r\n    public opacityTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * Stores the reflection values in a texture.\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public reflectionTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * Stores the emissive values in a texture.\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public emissiveTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * AKA Specular texture in other nomenclature.\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public reflectivityTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * Used to switch from specular/glossiness to metallic/roughness workflow.\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public metallicTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * Specifies the metallic scalar of the metallic/roughness workflow.\r\n     * Can also be used to scale the metalness values of the metallic texture.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public metallic: Nullable<number>;\r\n\r\n    /**\r\n     * Specifies the roughness scalar of the metallic/roughness workflow.\r\n     * Can also be used to scale the roughness values of the metallic texture.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public roughness: Nullable<number>;\r\n\r\n    /**\r\n     * In metallic workflow, specifies an F0 factor to help configuring the material F0.\r\n     * By default the indexOfrefraction is used to compute F0;\r\n     *\r\n     * This is used as a factor against the default reflectance at normal incidence to tweak it.\r\n     *\r\n     * F0 = defaultF0 * metallicF0Factor * metallicReflectanceColor;\r\n     * F90 = metallicReflectanceColor;\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public metallicF0Factor = 1;\r\n\r\n    /**\r\n     * In metallic workflow, specifies an F0 color.\r\n     * By default the F90 is always 1;\r\n     *\r\n     * Please note that this factor is also used as a factor against the default reflectance at normal incidence.\r\n     *\r\n     * F0 = defaultF0_from_IOR * metallicF0Factor * metallicReflectanceColor\r\n     * F90 = metallicF0Factor;\r\n     */\r\n    @serializeAsColor3()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public metallicReflectanceColor = Color3.White();\r\n\r\n    /**\r\n     * Specifies that only the A channel from metallicReflectanceTexture should be used.\r\n     * If false, both RGB and A channels will be used\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useOnlyMetallicFromMetallicReflectanceTexture = false;\r\n\r\n    /**\r\n     * Defines to store metallicReflectanceColor in RGB and metallicF0Factor in A\r\n     * This is multiplied against the scalar values defined in the material.\r\n     * If useOnlyMetallicFromMetallicReflectanceTexture is true, don't use the RGB channels, only A\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public metallicReflectanceTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * Defines to store reflectanceColor in RGB\r\n     * This is multiplied against the scalar values defined in the material.\r\n     * If both reflectanceTexture and metallicReflectanceTexture textures are provided and useOnlyMetallicFromMetallicReflectanceTexture\r\n     * is false, metallicReflectanceTexture takes priority and reflectanceTexture is not used\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public reflectanceTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * Used to enable roughness/glossiness fetch from a separate channel depending on the current mode.\r\n     * Gray Scale represents roughness in metallic mode and glossiness in specular mode.\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public microSurfaceTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * Stores surface normal data used to displace a mesh in a texture.\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public bumpTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * Stores the pre-calculated light information of a mesh in a texture.\r\n     */\r\n    @serializeAsTexture()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\", null)\r\n    public lightmapTexture: Nullable<BaseTexture>;\r\n\r\n    /**\r\n     * Stores the refracted light information in a texture.\r\n     */\r\n    public get refractionTexture(): Nullable<BaseTexture> {\r\n        return this.subSurface.refractionTexture;\r\n    }\r\n    public set refractionTexture(value: Nullable<BaseTexture>) {\r\n        this.subSurface.refractionTexture = value;\r\n        if (value) {\r\n            this.subSurface.isRefractionEnabled = true;\r\n        } else if (!this.subSurface.linkRefractionWithTransparency) {\r\n            this.subSurface.isRefractionEnabled = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * The color of a material in ambient lighting.\r\n     */\r\n    @serializeAsColor3(\"ambient\")\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public ambientColor = new Color3(0, 0, 0);\r\n\r\n    /**\r\n     * AKA Diffuse Color in other nomenclature.\r\n     */\r\n    @serializeAsColor3(\"albedo\")\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public albedoColor = new Color3(1, 1, 1);\r\n\r\n    /**\r\n     * OpenPBR Base Weight (multiplier to the diffuse and metal lobes).\r\n     */\r\n    @serialize(\"baseWeight\")\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public baseWeight = 1;\r\n\r\n    /**\r\n     * OpenPBR Base Diffuse Roughness (roughness of the diffuse lobe).\r\n     */\r\n    @serialize(\"baseDiffuseRoughness\")\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public baseDiffuseRoughness: Nullable<number>;\r\n\r\n    /**\r\n     * AKA Specular Color in other nomenclature.\r\n     */\r\n    @serializeAsColor3(\"reflectivity\")\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public reflectivityColor = new Color3(1, 1, 1);\r\n\r\n    /**\r\n     * The color reflected from the material.\r\n     */\r\n    @serializeAsColor3(\"reflection\")\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public reflectionColor = new Color3(1.0, 1.0, 1.0);\r\n\r\n    /**\r\n     * The color emitted from the material.\r\n     */\r\n    @serializeAsColor3(\"emissive\")\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public emissiveColor = new Color3(0, 0, 0);\r\n\r\n    /**\r\n     * AKA Glossiness in other nomenclature.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public microSurface = 1.0;\r\n\r\n    /**\r\n     * Index of refraction of the material base layer.\r\n     * https://en.wikipedia.org/wiki/List_of_refractive_indices\r\n     *\r\n     * This does not only impact refraction but also the Base F0 of Dielectric Materials.\r\n     *\r\n     * From dielectric fresnel rules: F0 = square((iorT - iorI) / (iorT + iorI))\r\n     */\r\n    public get indexOfRefraction(): number {\r\n        return this.subSurface.indexOfRefraction;\r\n    }\r\n    public set indexOfRefraction(value: number) {\r\n        this.subSurface.indexOfRefraction = value;\r\n    }\r\n\r\n    /**\r\n     * Controls if refraction needs to be inverted on Y. This could be useful for procedural texture.\r\n     */\r\n    public get invertRefractionY(): boolean {\r\n        return this.subSurface.invertRefractionY;\r\n    }\r\n    public set invertRefractionY(value: boolean) {\r\n        this.subSurface.invertRefractionY = value;\r\n    }\r\n\r\n    /**\r\n     * This parameters will make the material used its opacity to control how much it is refracting against not.\r\n     * Materials half opaque for instance using refraction could benefit from this control.\r\n     */\r\n    public get linkRefractionWithTransparency(): boolean {\r\n        return this.subSurface.linkRefractionWithTransparency;\r\n    }\r\n    public set linkRefractionWithTransparency(value: boolean) {\r\n        this.subSurface.linkRefractionWithTransparency = value;\r\n        if (value) {\r\n            this.subSurface.isRefractionEnabled = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * If true, the light map contains occlusion information instead of lighting info.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useLightmapAsShadowmap = false;\r\n\r\n    /**\r\n     * Specifies that the alpha is coming form the albedo channel alpha channel for alpha blending.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesAndMiscDirty\")\r\n    public useAlphaFromAlbedoTexture = false;\r\n\r\n    /**\r\n     * Enforces alpha test in opaque or blend mode in order to improve the performances of some situations.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesAndMiscDirty\")\r\n    public forceAlphaTest = false;\r\n\r\n    /**\r\n     * Defines the alpha limits in alpha test mode.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesAndMiscDirty\")\r\n    public alphaCutOff = 0.4;\r\n\r\n    /**\r\n     * Specifies that the material will keep the specular highlights over a transparent surface (only the most luminous ones).\r\n     * A car glass is a good example of that. When sun reflects on it you can not see what is behind.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useSpecularOverAlpha = true;\r\n\r\n    /**\r\n     * Specifies if the reflectivity texture contains the glossiness information in its alpha channel.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useMicroSurfaceFromReflectivityMapAlpha = false;\r\n\r\n    /**\r\n     * Specifies if the metallic texture contains the roughness information in its alpha channel.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useRoughnessFromMetallicTextureAlpha = true;\r\n\r\n    /**\r\n     * Specifies if the metallic texture contains the roughness information in its green channel.\r\n     * Needs useRoughnessFromMetallicTextureAlpha to be false.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useRoughnessFromMetallicTextureGreen = false;\r\n\r\n    /**\r\n     * Specifies if the metallic texture contains the metallness information in its blue channel.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useMetallnessFromMetallicTextureBlue = false;\r\n\r\n    /**\r\n     * Specifies if the metallic texture contains the ambient occlusion information in its red channel.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useAmbientOcclusionFromMetallicTextureRed = false;\r\n\r\n    /**\r\n     * Specifies if the ambient texture contains the ambient occlusion information in its red channel only.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useAmbientInGrayScale = false;\r\n\r\n    /**\r\n     * In case the reflectivity map does not contain the microsurface information in its alpha channel,\r\n     * The material will try to infer what glossiness each pixel should be.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useAutoMicroSurfaceFromReflectivityMap = false;\r\n\r\n    /**\r\n     * BJS is using an hardcoded light falloff based on a manually sets up range.\r\n     * In PBR, one way to represents the falloff is to use the inverse squared root algorithm.\r\n     * This parameter can help you switch back to the BJS mode in order to create scenes using both materials.\r\n     */\r\n    @serialize()\r\n    public get usePhysicalLightFalloff(): boolean {\r\n        return this._lightFalloff === PBRBaseMaterial.LIGHTFALLOFF_PHYSICAL;\r\n    }\r\n\r\n    /**\r\n     * BJS is using an hardcoded light falloff based on a manually sets up range.\r\n     * In PBR, one way to represents the falloff is to use the inverse squared root algorithm.\r\n     * This parameter can help you switch back to the BJS mode in order to create scenes using both materials.\r\n     */\r\n    public set usePhysicalLightFalloff(value: boolean) {\r\n        if (value !== this.usePhysicalLightFalloff) {\r\n            // Ensure the effect will be rebuilt.\r\n            this._markAllSubMeshesAsTexturesDirty();\r\n\r\n            if (value) {\r\n                this._lightFalloff = PBRBaseMaterial.LIGHTFALLOFF_PHYSICAL;\r\n            } else {\r\n                this._lightFalloff = PBRBaseMaterial.LIGHTFALLOFF_STANDARD;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * In order to support the falloff compatibility with gltf, a special mode has been added\r\n     * to reproduce the gltf light falloff.\r\n     */\r\n    @serialize()\r\n    public get useGLTFLightFalloff(): boolean {\r\n        return this._lightFalloff === PBRBaseMaterial.LIGHTFALLOFF_GLTF;\r\n    }\r\n\r\n    /**\r\n     * In order to support the falloff compatibility with gltf, a special mode has been added\r\n     * to reproduce the gltf light falloff.\r\n     */\r\n    public set useGLTFLightFalloff(value: boolean) {\r\n        if (value !== this.useGLTFLightFalloff) {\r\n            // Ensure the effect will be rebuilt.\r\n            this._markAllSubMeshesAsTexturesDirty();\r\n\r\n            if (value) {\r\n                this._lightFalloff = PBRBaseMaterial.LIGHTFALLOFF_GLTF;\r\n            } else {\r\n                this._lightFalloff = PBRBaseMaterial.LIGHTFALLOFF_STANDARD;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Specifies that the material will keeps the reflection highlights over a transparent surface (only the most luminous ones).\r\n     * A car glass is a good example of that. When the street lights reflects on it you can not see what is behind.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useRadianceOverAlpha = true;\r\n\r\n    /**\r\n     * Allows using an object space normal map (instead of tangent space).\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useObjectSpaceNormalMap = false;\r\n\r\n    /**\r\n     * Allows using the bump map in parallax mode.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useParallax = false;\r\n\r\n    /**\r\n     * Allows using the bump map in parallax occlusion mode.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useParallaxOcclusion = false;\r\n\r\n    /**\r\n     * Controls the scale bias of the parallax mode.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public parallaxScaleBias = 0.05;\r\n\r\n    /**\r\n     * If sets to true, disables all the lights affecting the material.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsLightsDirty\")\r\n    public disableLighting = false;\r\n\r\n    /**\r\n     * Force the shader to compute irradiance in the fragment shader in order to take bump in account.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public forceIrradianceInFragment = false;\r\n\r\n    /**\r\n     * Number of Simultaneous lights allowed on the material.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsLightsDirty\")\r\n    public maxSimultaneousLights = 4;\r\n\r\n    /**\r\n     * If sets to true, x component of normal map value will invert (x = 1.0 - x).\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public invertNormalMapX = false;\r\n\r\n    /**\r\n     * If sets to true, y component of normal map value will invert (y = 1.0 - y).\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public invertNormalMapY = false;\r\n\r\n    /**\r\n     * If sets to true and backfaceCulling is false, normals will be flipped on the backside.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public twoSidedLighting = false;\r\n\r\n    /**\r\n     * A fresnel is applied to the alpha of the model to ensure grazing angles edges are not alpha tested.\r\n     * And/Or occlude the blended part. (alpha is converted to gamma to compute the fresnel)\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useAlphaFresnel = false;\r\n\r\n    /**\r\n     * A fresnel is applied to the alpha of the model to ensure grazing angles edges are not alpha tested.\r\n     * And/Or occlude the blended part. (alpha stays linear to compute the fresnel)\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useLinearAlphaFresnel = false;\r\n\r\n    /**\r\n     * Let user defines the brdf lookup texture used for IBL.\r\n     * A default 8bit version is embedded but you could point at :\r\n     * * Default texture: https://assets.babylonjs.com/environments/correlatedMSBRDF_RGBD.png\r\n     * * Default 16bit pixel depth texture: https://assets.babylonjs.com/environments/correlatedMSBRDF.dds\r\n     * * LEGACY Default None correlated https://assets.babylonjs.com/environments/uncorrelatedBRDF_RGBD.png\r\n     * * LEGACY Default None correlated 16bit pixel depth https://assets.babylonjs.com/environments/uncorrelatedBRDF.dds\r\n     */\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public environmentBRDFTexture: Nullable<BaseTexture> = null;\r\n\r\n    /**\r\n     * Force normal to face away from face.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public forceNormalForward = false;\r\n\r\n    /**\r\n     * Enables specular anti aliasing in the PBR shader.\r\n     * It will both interacts on the Geometry for analytical and IBL lighting.\r\n     * It also prefilter the roughness map based on the bump values.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public enableSpecularAntiAliasing = false;\r\n\r\n    /**\r\n     * This parameters will enable/disable Horizon occlusion to prevent normal maps to look shiny when the normal\r\n     * makes the reflect vector face the model (under horizon).\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useHorizonOcclusion = true;\r\n\r\n    /**\r\n     * This parameters will enable/disable radiance occlusion by preventing the radiance to lit\r\n     * too much the area relying on ambient texture to define their ambient occlusion.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsTexturesDirty\")\r\n    public useRadianceOcclusion = true;\r\n\r\n    /**\r\n     * If set to true, no lighting calculations will be applied.\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsMiscDirty\")\r\n    public unlit = false;\r\n\r\n    /**\r\n     * If sets to true, the decal map will be applied after the detail map. Else, it is applied before (default: false)\r\n     */\r\n    @serialize()\r\n    @expandToProperty(\"_markAllSubMeshesAsMiscDirty\")\r\n    public applyDecalMapAfterDetailMap = false;\r\n\r\n    /**\r\n     * Instantiates a new PBRMaterial instance.\r\n     *\r\n     * @param name The material name\r\n     * @param scene The scene the material will be use in.\r\n     * @param forceGLSL Use the GLSL code generation for the shader (even on WebGPU). Default is false\r\n     */\r\n    constructor(name: string, scene?: Scene, forceGLSL = false) {\r\n        super(name, scene, forceGLSL);\r\n\r\n        this._environmentBRDFTexture = GetEnvironmentBRDFTexture(this.getScene());\r\n    }\r\n\r\n    /**\r\n     * @returns the name of this material class.\r\n     */\r\n    public override getClassName(): string {\r\n        return \"PBRMaterial\";\r\n    }\r\n\r\n    /**\r\n     * Makes a duplicate of the current material.\r\n     * @param name - name to use for the new material.\r\n     * @param cloneTexturesOnlyOnce - if a texture is used in more than one channel (e.g diffuse and opacity), only clone it once and reuse it on the other channels. Default false.\r\n     * @param rootUrl defines the root URL to use to load textures\r\n     * @returns cloned material instance\r\n     */\r\n    public override clone(name: string, cloneTexturesOnlyOnce: boolean = true, rootUrl = \"\"): PBRMaterial {\r\n        const clone = SerializationHelper.Clone(() => new PBRMaterial(name, this.getScene()), this, { cloneTexturesOnlyOnce });\r\n\r\n        clone.id = name;\r\n        clone.name = name;\r\n\r\n        this.stencil.copyTo(clone.stencil);\r\n\r\n        this._clonePlugins(clone, rootUrl);\r\n\r\n        return clone;\r\n    }\r\n\r\n    /**\r\n     * Serializes this PBR Material.\r\n     * @returns - An object with the serialized material.\r\n     */\r\n    public override serialize(): any {\r\n        const serializationObject = super.serialize();\r\n        serializationObject.customType = \"BABYLON.PBRMaterial\";\r\n\r\n        return serializationObject;\r\n    }\r\n\r\n    // Statics\r\n    /**\r\n     * Parses a PBR Material from a serialized object.\r\n     * @param source - Serialized object.\r\n     * @param scene - BJS scene instance.\r\n     * @param rootUrl - url for the scene object\r\n     * @returns - PBRMaterial\r\n     */\r\n    public static override Parse(source: any, scene: Scene, rootUrl: string): PBRMaterial {\r\n        const material = SerializationHelper.Parse(() => new PBRMaterial(source.name, scene), source, scene, rootUrl);\r\n\r\n        if (source.stencil) {\r\n            material.stencil.parse(source.stencil, scene, rootUrl);\r\n        }\r\n\r\n        Material._ParsePlugins(source, material, scene, rootUrl);\r\n\r\n        // The code block below ensures backward compatibility with serialized materials before plugins are automatically serialized.\r\n        if (source.clearCoat) {\r\n            material.clearCoat.parse(source.clearCoat, scene, rootUrl);\r\n        }\r\n        if (source.anisotropy) {\r\n            material.anisotropy.parse(source.anisotropy, scene, rootUrl);\r\n        }\r\n        if (source.brdf) {\r\n            material.brdf.parse(source.brdf, scene, rootUrl);\r\n        }\r\n        if (source.sheen) {\r\n            material.sheen.parse(source.sheen, scene, rootUrl);\r\n        }\r\n        if (source.subSurface) {\r\n            material.subSurface.parse(source.subSurface, scene, rootUrl);\r\n        }\r\n        if (source.iridescence) {\r\n            material.iridescence.parse(source.iridescence, scene, rootUrl);\r\n        }\r\n\r\n        return material;\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.PBRMaterial\", PBRMaterial);\r\n", "import type { IColor3Like, IColor4Like, IMatrixLike, IVector3Like, IVector4Like } from \"../Maths/math.like\";\r\nimport type { Effect } from \"./effect\";\r\nimport type { UniformBuffer } from \"./uniformBuffer\";\r\n\r\n/** @internal */\r\nexport class UniformBufferEffectCommonAccessor {\r\n    public setMatrix3x3: (name: string, matrix: Float32Array) => void;\r\n\r\n    public setMatrix2x2: (name: string, matrix: Float32Array) => void;\r\n\r\n    public setFloat: (name: string, x: number) => void;\r\n\r\n    public setFloat2: (name: string, x: number, y: number, suffix?: string) => void;\r\n\r\n    public setFloat3: (name: string, x: number, y: number, z: number, suffix?: string) => void;\r\n\r\n    public setFloat4: (name: string, x: number, y: number, z: number, w: number, suffix?: string) => void;\r\n\r\n    public setFloatArray: (name: string, array: Float32Array) => void;\r\n\r\n    public setArray: (name: string, array: number[]) => void;\r\n\r\n    public setIntArray: (name: string, array: Int32Array) => void;\r\n\r\n    public setMatrix: (name: string, mat: IMatrixLike) => void;\r\n\r\n    public setMatrices: (name: string, mat: Float32Array) => void;\r\n\r\n    public setVector3: (name: string, vector: IVector3Like) => void;\r\n\r\n    public setVector4: (name: string, vector: IVector4Like) => void;\r\n\r\n    public setColor3: (name: string, color: IColor3Like, suffix?: string) => void;\r\n\r\n    public setColor4: (name: string, color: IColor3Like, alpha: number, suffix?: string) => void;\r\n\r\n    public setDirectColor4: (name: string, color: IColor4Like) => void;\r\n\r\n    public setInt: (name: string, x: number, suffix?: string) => void;\r\n\r\n    public setInt2: (name: string, x: number, y: number, suffix?: string) => void;\r\n\r\n    public setInt3: (name: string, x: number, y: number, z: number, suffix?: string) => void;\r\n\r\n    public setInt4: (name: string, x: number, y: number, z: number, w: number, suffix?: string) => void;\r\n\r\n    private _isUbo(uboOrEffect: UniformBuffer | Effect): uboOrEffect is UniformBuffer {\r\n        return (uboOrEffect as UniformBuffer).addUniform !== undefined;\r\n    }\r\n\r\n    constructor(uboOrEffect: UniformBuffer | Effect) {\r\n        if (this._isUbo(uboOrEffect)) {\r\n            this.setMatrix3x3 = uboOrEffect.updateMatrix3x3.bind(uboOrEffect);\r\n            this.setMatrix2x2 = uboOrEffect.updateMatrix2x2.bind(uboOrEffect);\r\n            this.setFloat = uboOrEffect.updateFloat.bind(uboOrEffect);\r\n            this.setFloat2 = uboOrEffect.updateFloat2.bind(uboOrEffect);\r\n            this.setFloat3 = uboOrEffect.updateFloat3.bind(uboOrEffect);\r\n            this.setFloat4 = uboOrEffect.updateFloat4.bind(uboOrEffect);\r\n            this.setFloatArray = uboOrEffect.updateFloatArray.bind(uboOrEffect);\r\n            this.setArray = uboOrEffect.updateArray.bind(uboOrEffect);\r\n            this.setIntArray = uboOrEffect.updateIntArray.bind(uboOrEffect);\r\n            this.setMatrix = uboOrEffect.updateMatrix.bind(uboOrEffect);\r\n            this.setMatrices = uboOrEffect.updateMatrices.bind(uboOrEffect);\r\n            this.setVector3 = uboOrEffect.updateVector3.bind(uboOrEffect);\r\n            this.setVector4 = uboOrEffect.updateVector4.bind(uboOrEffect);\r\n            this.setColor3 = uboOrEffect.updateColor3.bind(uboOrEffect);\r\n            this.setColor4 = uboOrEffect.updateColor4.bind(uboOrEffect);\r\n            this.setDirectColor4 = uboOrEffect.updateDirectColor4.bind(uboOrEffect);\r\n            this.setInt = uboOrEffect.updateInt.bind(uboOrEffect);\r\n            this.setInt2 = uboOrEffect.updateInt2.bind(uboOrEffect);\r\n            this.setInt3 = uboOrEffect.updateInt3.bind(uboOrEffect);\r\n            this.setInt4 = uboOrEffect.updateInt4.bind(uboOrEffect);\r\n        } else {\r\n            this.setMatrix3x3 = uboOrEffect.setMatrix3x3.bind(uboOrEffect);\r\n            this.setMatrix2x2 = uboOrEffect.setMatrix2x2.bind(uboOrEffect);\r\n            this.setFloat = uboOrEffect.setFloat.bind(uboOrEffect);\r\n            this.setFloat2 = uboOrEffect.setFloat2.bind(uboOrEffect);\r\n            this.setFloat3 = uboOrEffect.setFloat3.bind(uboOrEffect);\r\n            this.setFloat4 = uboOrEffect.setFloat4.bind(uboOrEffect);\r\n            this.setFloatArray = uboOrEffect.setFloatArray.bind(uboOrEffect);\r\n            this.setArray = uboOrEffect.setArray.bind(uboOrEffect);\r\n            this.setIntArray = uboOrEffect.setIntArray.bind(uboOrEffect);\r\n            this.setMatrix = uboOrEffect.setMatrix.bind(uboOrEffect);\r\n            this.setMatrices = uboOrEffect.setMatrices.bind(uboOrEffect);\r\n            this.setVector3 = uboOrEffect.setVector3.bind(uboOrEffect);\r\n            this.setVector4 = uboOrEffect.setVector4.bind(uboOrEffect);\r\n            this.setColor3 = uboOrEffect.setColor3.bind(uboOrEffect);\r\n            this.setColor4 = uboOrEffect.setColor4.bind(uboOrEffect);\r\n            this.setDirectColor4 = uboOrEffect.setDirectColor4.bind(uboOrEffect);\r\n            this.setInt = uboOrEffect.setInt.bind(uboOrEffect);\r\n            this.setInt2 = uboOrEffect.setInt2.bind(uboOrEffect);\r\n            this.setInt3 = uboOrEffect.setInt3.bind(uboOrEffect);\r\n            this.setInt4 = uboOrEffect.setInt4.bind(uboOrEffect);\r\n        }\r\n    }\r\n}\r\n", "// Do not edit.\nimport { ShaderStore } from \"../Engines/shaderStore\";\n\nconst name = \"gpuUpdateParticlesPixelShader\";\nconst shader = `#version 300 es\nvoid main() {discard;}\n`;\n// Sideeffect\nif (!ShaderStore.ShadersStore[name]) {\n    ShaderStore.ShadersStore[name] = shader;\n}\n/** @internal */\nexport const gpuUpdateParticlesPixelShader = { name, shader };\n", "// Do not edit.\nimport { ShaderStore } from \"../Engines/shaderStore\";\n\nconst name = \"gpuUpdateParticlesVertexShader\";\nconst shader = `#version 300 es\n#define PI 3.14159\nuniform float currentCount;uniform float timeDelta;uniform float stopFactor;\n#ifndef LOCAL\nuniform mat4 emitterWM;\n#endif\nuniform vec2 lifeTime;uniform vec2 emitPower;uniform vec2 sizeRange;uniform vec4 scaleRange;\n#ifdef FLOWMAP\nuniform mat4 flowMapProjection;uniform float flowMapStrength;uniform sampler2D flowMapSampler;\n#endif\n#ifndef COLORGRADIENTS\nuniform vec4 color1;uniform vec4 color2;\n#endif\nuniform vec3 gravity;uniform sampler2D randomSampler;uniform sampler2D randomSampler2;uniform vec4 angleRange;\n#ifdef BOXEMITTER\nuniform vec3 direction1;uniform vec3 direction2;uniform vec3 minEmitBox;uniform vec3 maxEmitBox;\n#endif\n#ifdef POINTEMITTER\nuniform vec3 direction1;uniform vec3 direction2;\n#endif\n#ifdef HEMISPHERICEMITTER\nuniform float radius;uniform float radiusRange;uniform float directionRandomizer;\n#endif\n#ifdef SPHEREEMITTER\nuniform float radius;uniform float radiusRange;\n#ifdef DIRECTEDSPHEREEMITTER\nuniform vec3 direction1;uniform vec3 direction2;\n#else\nuniform float directionRandomizer;\n#endif\n#endif\n#ifdef CYLINDEREMITTER\nuniform float radius;uniform float height;uniform float radiusRange;\n#ifdef DIRECTEDCYLINDEREMITTER\nuniform vec3 direction1;uniform vec3 direction2;\n#else\nuniform float directionRandomizer;\n#endif\n#endif\n#ifdef CONEEMITTER\nuniform vec2 radius;uniform float coneAngle;uniform vec2 height;\n#ifdef DIRECTEDCONEEMITTER\nuniform vec3 direction1;uniform vec3 direction2;\n#else\nuniform float directionRandomizer;\n#endif\n#endif\nin vec3 position;\n#ifdef CUSTOMEMITTER\nin vec3 initialPosition;\n#endif\nin float age;in float life;in vec4 seed;in vec3 size;\n#ifndef COLORGRADIENTS\nin vec4 color;\n#endif\nin vec3 direction;\n#ifndef BILLBOARD\nin vec3 initialDirection;\n#endif\n#ifdef ANGULARSPEEDGRADIENTS\nin float angle;\n#else\nin vec2 angle;\n#endif\n#ifdef ANIMATESHEET\nin float cellIndex;\n#ifdef ANIMATESHEETRANDOMSTART\nin float cellStartOffset;\n#endif\n#endif\n#ifdef NOISE\nin vec3 noiseCoordinates1;in vec3 noiseCoordinates2;\n#endif\nout vec3 outPosition;\n#ifdef CUSTOMEMITTER\nout vec3 outInitialPosition;\n#endif\nout float outAge;out float outLife;out vec4 outSeed;out vec3 outSize;\n#ifndef COLORGRADIENTS\nout vec4 outColor;\n#endif\nout vec3 outDirection;\n#ifndef BILLBOARD\nout vec3 outInitialDirection;\n#endif\n#ifdef ANGULARSPEEDGRADIENTS\nout float outAngle;\n#else\nout vec2 outAngle;\n#endif\n#ifdef ANIMATESHEET\nout float outCellIndex;\n#ifdef ANIMATESHEETRANDOMSTART\nout float outCellStartOffset;\n#endif\n#endif\n#ifdef NOISE\nout vec3 outNoiseCoordinates1;out vec3 outNoiseCoordinates2;\n#endif\n#ifdef SIZEGRADIENTS\nuniform sampler2D sizeGradientSampler;\n#endif \n#ifdef ANGULARSPEEDGRADIENTS\nuniform sampler2D angularSpeedGradientSampler;\n#endif \n#ifdef VELOCITYGRADIENTS\nuniform sampler2D velocityGradientSampler;\n#endif\n#ifdef LIMITVELOCITYGRADIENTS\nuniform sampler2D limitVelocityGradientSampler;uniform float limitVelocityDamping;\n#endif\n#ifdef DRAGGRADIENTS\nuniform sampler2D dragGradientSampler;\n#endif\n#ifdef NOISE\nuniform vec3 noiseStrength;uniform sampler2D noiseSampler;\n#endif\n#ifdef ANIMATESHEET\nuniform vec4 cellInfos;\n#endif\nvec3 getRandomVec3(float offset) {return texture(randomSampler2,vec2(float(gl_VertexID)*offset/currentCount,0)).rgb;}\nvec4 getRandomVec4(float offset) {return texture(randomSampler,vec2(float(gl_VertexID)*offset/currentCount,0));}\nvoid main() {float newAge=age+timeDelta; \nif (newAge>=life && stopFactor != 0.) {vec3 newPosition;vec3 newDirection;vec4 randoms=getRandomVec4(seed.x);outLife=lifeTime.x+(lifeTime.y-lifeTime.x)*randoms.r;outAge=newAge-life;outSeed=seed;\n#ifdef SIZEGRADIENTS \noutSize.x=texture(sizeGradientSampler,vec2(0,0)).r;\n#else\noutSize.x=sizeRange.x+(sizeRange.y-sizeRange.x)*randoms.g;\n#endif\noutSize.y=scaleRange.x+(scaleRange.y-scaleRange.x)*randoms.b;outSize.z=scaleRange.z+(scaleRange.w-scaleRange.z)*randoms.a; \n#ifndef COLORGRADIENTS\noutColor=color1+(color2-color1)*randoms.b;\n#endif\n#ifndef ANGULARSPEEDGRADIENTS \noutAngle.y=angleRange.x+(angleRange.y-angleRange.x)*randoms.a;outAngle.x=angleRange.z+(angleRange.w-angleRange.z)*randoms.r;\n#else\noutAngle=angleRange.z+(angleRange.w-angleRange.z)*randoms.r;\n#endif \n#ifdef POINTEMITTER\nvec3 randoms2=getRandomVec3(seed.y);vec3 randoms3=getRandomVec3(seed.z);newPosition=vec3(0,0,0);newDirection=direction1+(direction2-direction1)*randoms3;\n#elif defined(BOXEMITTER)\nvec3 randoms2=getRandomVec3(seed.y);vec3 randoms3=getRandomVec3(seed.z);newPosition=minEmitBox+(maxEmitBox-minEmitBox)*randoms2;newDirection=direction1+(direction2-direction1)*randoms3; \n#elif defined(HEMISPHERICEMITTER)\nvec3 randoms2=getRandomVec3(seed.y);vec3 randoms3=getRandomVec3(seed.z);float phi=2.0*PI*randoms2.x;float theta=acos(2.0*randoms2.y-1.0);float randX=cos(phi)*sin(theta);float randY=cos(theta);float randZ=sin(phi)*sin(theta);newPosition=(radius-(radius*radiusRange*randoms2.z))*vec3(randX,abs(randY),randZ);newDirection=newPosition+directionRandomizer*randoms3; \n#elif defined(SPHEREEMITTER)\nvec3 randoms2=getRandomVec3(seed.y);vec3 randoms3=getRandomVec3(seed.z);float phi=2.0*PI*randoms2.x;float theta=acos(2.0*randoms2.y-1.0);float randX=cos(phi)*sin(theta);float randY=cos(theta);float randZ=sin(phi)*sin(theta);newPosition=(radius-(radius*radiusRange*randoms2.z))*vec3(randX,randY,randZ);\n#ifdef DIRECTEDSPHEREEMITTER\nnewDirection=normalize(direction1+(direction2-direction1)*randoms3);\n#else\nnewDirection=normalize(newPosition+directionRandomizer*randoms3);\n#endif\n#elif defined(CYLINDEREMITTER)\nvec3 randoms2=getRandomVec3(seed.y);vec3 randoms3=getRandomVec3(seed.z);float yPos=(randoms2.x-0.5)*height;float angle=randoms2.y*PI*2.;float inverseRadiusRangeSquared=((1.-radiusRange)*(1.-radiusRange));float positionRadius=radius*sqrt(inverseRadiusRangeSquared+(randoms2.z*(1.-inverseRadiusRangeSquared)));float xPos=positionRadius*cos(angle);float zPos=positionRadius*sin(angle);newPosition=vec3(xPos,yPos,zPos);\n#ifdef DIRECTEDCYLINDEREMITTER\nnewDirection=direction1+(direction2-direction1)*randoms3;\n#else\nangle=angle+((randoms3.x-0.5)*PI)*directionRandomizer;newDirection=vec3(cos(angle),(randoms3.y-0.5)*directionRandomizer,sin(angle));newDirection=normalize(newDirection);\n#endif\n#elif defined(CONEEMITTER)\nvec3 randoms2=getRandomVec3(seed.y);float s=2.0*PI*randoms2.x;\n#ifdef CONEEMITTERSPAWNPOINT\nfloat h=0.0001;\n#else\nfloat h=randoms2.y*height.y;h=1.-h*h; \n#endif\nfloat lRadius=radius.x-radius.x*randoms2.z*radius.y;lRadius=lRadius*h;float randX=lRadius*sin(s);float randZ=lRadius*cos(s);float randY=h *height.x;newPosition=vec3(randX,randY,randZ); \nvec3 randoms3=getRandomVec3(seed.z);\n#ifdef DIRECTEDCONEEMITTER\nnewDirection=direction1+(direction2-direction1)*randoms3;\n#else\nif (abs(cos(coneAngle))==1.0) {newDirection=vec3(0.,1.0,0.);} else {newDirection=normalize(newPosition+directionRandomizer*randoms3); }\n#endif\n#elif defined(CUSTOMEMITTER)\nnewPosition=initialPosition;outInitialPosition=initialPosition;\n#else \nnewPosition=vec3(0.,0.,0.);newDirection=2.0*(getRandomVec3(seed.w)-vec3(0.5,0.5,0.5));\n#endif\nfloat power=emitPower.x+(emitPower.y-emitPower.x)*randoms.a;\n#ifdef LOCAL\noutPosition=newPosition;\n#else\noutPosition=(emitterWM*vec4(newPosition,1.)).xyz;\n#endif\n#ifdef CUSTOMEMITTER\noutDirection=direction;\n#ifndef BILLBOARD \noutInitialDirection=direction;\n#endif\n#else\n#ifdef LOCAL\nvec3 initial=newDirection;\n#else \nvec3 initial=(emitterWM*vec4(newDirection,0.)).xyz;\n#endif\noutDirection=initial*power;\n#ifndef BILLBOARD \noutInitialDirection=initial;\n#endif\n#endif\n#ifdef ANIMATESHEET \noutCellIndex=cellInfos.x;\n#ifdef ANIMATESHEETRANDOMSTART\noutCellStartOffset=randoms.a*outLife;\n#endif \n#endif\n#ifdef NOISE\noutNoiseCoordinates1=noiseCoordinates1;outNoiseCoordinates2=noiseCoordinates2;\n#endif\n} else {float directionScale=timeDelta;outAge=newAge;float ageGradient=newAge/life;\n#ifdef VELOCITYGRADIENTS\ndirectionScale*=texture(velocityGradientSampler,vec2(ageGradient,0)).r;\n#endif\n#ifdef DRAGGRADIENTS\ndirectionScale*=1.0-texture(dragGradientSampler,vec2(ageGradient,0)).r;\n#endif\n#if defined(CUSTOMEMITTER)\noutPosition=position+(direction-position)*ageGradient; \noutInitialPosition=initialPosition;\n#else\noutPosition=position+direction*directionScale;\n#endif\noutLife=life;outSeed=seed;\n#ifndef COLORGRADIENTS \noutColor=color;\n#endif\n#ifdef SIZEGRADIENTS\noutSize.x=texture(sizeGradientSampler,vec2(ageGradient,0)).r;outSize.yz=size.yz;\n#else\noutSize=size;\n#endif \n#ifndef BILLBOARD \noutInitialDirection=initialDirection;\n#endif\n#ifdef CUSTOMEMITTER\noutDirection=direction;\n#else\nvec3 updatedDirection=direction+gravity*timeDelta;\n#ifdef FLOWMAP\nvec4 clipSpace=(flowMapProjection*vec4(position,1.));vec3 ndcSpace=clipSpace.xyz/clipSpace.w;vec2 flowMapUV=ndcSpace.xy*0.5+0.5;vec4 flowMapValue=texture(flowMapSampler,flowMapUV);vec3 flowMapDirection=(flowMapValue.xyz*2.0-1.0)*flowMapValue.w;updatedDirection+=flowMapDirection*timeDelta*flowMapStrength;\n#endif\n#ifdef LIMITVELOCITYGRADIENTS\nfloat limitVelocity=texture(limitVelocityGradientSampler,vec2(ageGradient,0)).r;float currentVelocity=length(updatedDirection);if (currentVelocity>limitVelocity) {updatedDirection=updatedDirection*limitVelocityDamping;}\n#endif\noutDirection=updatedDirection;\n#ifdef NOISE\nfloat fetchedR=texture(noiseSampler,vec2(noiseCoordinates1.x,noiseCoordinates1.y)*vec2(0.5)+vec2(0.5)).r;float fetchedG=texture(noiseSampler,vec2(noiseCoordinates1.z,noiseCoordinates2.x)*vec2(0.5)+vec2(0.5)).r;float fetchedB=texture(noiseSampler,vec2(noiseCoordinates2.y,noiseCoordinates2.z)*vec2(0.5)+vec2(0.5)).r;vec3 force=vec3(2.*fetchedR-1.,2.*fetchedG-1.,2.*fetchedB-1.)*noiseStrength;outDirection=outDirection+force*timeDelta;outNoiseCoordinates1=noiseCoordinates1;outNoiseCoordinates2=noiseCoordinates2;\n#endif \n#endif \n#ifdef ANGULARSPEEDGRADIENTS\nfloat angularSpeed=texture(angularSpeedGradientSampler,vec2(ageGradient,0)).r;outAngle=angle+angularSpeed*timeDelta;\n#else\noutAngle=vec2(angle.x+angle.y*timeDelta,angle.y);\n#endif\n#ifdef ANIMATESHEET \nfloat offsetAge=outAge;float dist=cellInfos.y-cellInfos.x;\n#ifdef ANIMATESHEETRANDOMSTART\noutCellStartOffset=cellStartOffset;offsetAge+=cellStartOffset;\n#else\nfloat cellStartOffset=0.;\n#endif \nfloat ratio=0.;if (cellInfos.w==1.0) {ratio=clamp(mod(cellStartOffset+cellInfos.z*offsetAge,life)/life,0.,1.0);}\nelse {ratio=clamp(cellStartOffset+cellInfos.z*offsetAge/life,0.,1.0);}\noutCellIndex=float(int(cellInfos.x+ratio*dist));\n#endif\n}}`;\n// Sideeffect\nif (!ShaderStore.ShadersStore[name]) {\n    ShaderStore.ShadersStore[name] = shader;\n}\n/** @internal */\nexport const gpuUpdateParticlesVertexShader = { name, shader };\n", "import type { VertexBuffer, Buffer } from \"../Buffers/buffer\";\r\nimport type { ThinEngine } from \"../Engines/thinEngine\";\r\nimport type { Effect, IEffectCreationOptions } from \"../Materials/effect\";\r\nimport type { IGPUParticleSystemPlatform } from \"./IGPUParticleSystemPlatform\";\r\n\r\nimport { CustomParticleEmitter } from \"./EmitterTypes/customParticleEmitter\";\r\nimport type { GPUParticleSystem } from \"./gpuParticleSystem\";\r\nimport type { DataArray, Nullable } from \"../types\";\r\nimport type { DataBuffer } from \"../Buffers/dataBuffer\";\r\nimport { UniformBufferEffectCommonAccessor } from \"../Materials/uniformBufferEffectCommonAccessor\";\r\nimport { Constants } from \"../Engines/constants\";\r\nimport { RegisterClass } from \"../Misc/typeStore\";\r\n\r\nimport \"../Shaders/gpuUpdateParticles.fragment\";\r\nimport \"../Shaders/gpuUpdateParticles.vertex\";\r\n\r\nimport type { Engine } from \"../Engines/engine\";\r\n\r\n/** @internal */\r\nexport class WebGL2ParticleSystem implements IGPUParticleSystemPlatform {\r\n    private _parent: GPUParticleSystem;\r\n    private _engine: ThinEngine;\r\n    private _updateEffect: Effect;\r\n    private _updateEffectOptions: IEffectCreationOptions;\r\n    private _renderVAO: WebGLVertexArrayObject[] = [];\r\n    private _updateVAO: WebGLVertexArrayObject[] = [];\r\n    private _renderVertexBuffers: { [key: string]: VertexBuffer };\r\n\r\n    /** @internal */\r\n    public readonly alignDataInBuffer = false;\r\n\r\n    /** @internal */\r\n    constructor(parent: GPUParticleSystem, engine: ThinEngine) {\r\n        this._parent = parent;\r\n        this._engine = engine;\r\n\r\n        this._updateEffectOptions = {\r\n            attributes: [\r\n                \"position\",\r\n                \"initialPosition\",\r\n                \"age\",\r\n                \"life\",\r\n                \"seed\",\r\n                \"size\",\r\n                \"color\",\r\n                \"direction\",\r\n                \"initialDirection\",\r\n                \"angle\",\r\n                \"cellIndex\",\r\n                \"cellStartOffset\",\r\n                \"noiseCoordinates1\",\r\n                \"noiseCoordinates2\",\r\n            ],\r\n            uniformsNames: [\r\n                \"currentCount\",\r\n                \"timeDelta\",\r\n                \"emitterWM\",\r\n                \"lifeTime\",\r\n                \"color1\",\r\n                \"color2\",\r\n                \"sizeRange\",\r\n                \"scaleRange\",\r\n                \"gravity\",\r\n                \"emitPower\",\r\n                \"direction1\",\r\n                \"direction2\",\r\n                \"minEmitBox\",\r\n                \"maxEmitBox\",\r\n                \"radius\",\r\n                \"directionRandomizer\",\r\n                \"height\",\r\n                \"coneAngle\",\r\n                \"stopFactor\",\r\n                \"angleRange\",\r\n                \"radiusRange\",\r\n                \"cellInfos\",\r\n                \"noiseStrength\",\r\n                \"limitVelocityDamping\",\r\n                \"flowMapProjection\",\r\n                \"flowMapStrength\",\r\n            ],\r\n            uniformBuffersNames: [],\r\n            samplers: [\r\n                \"randomSampler\",\r\n                \"randomSampler2\",\r\n                \"sizeGradientSampler\",\r\n                \"angularSpeedGradientSampler\",\r\n                \"velocityGradientSampler\",\r\n                \"limitVelocityGradientSampler\",\r\n                \"noiseSampler\",\r\n                \"dragGradientSampler\",\r\n                \"flowMapSampler\",\r\n            ],\r\n            defines: \"\",\r\n            fallbacks: null,\r\n            onCompiled: null,\r\n            onError: null,\r\n            indexParameters: null,\r\n            maxSimultaneousLights: 0,\r\n            transformFeedbackVaryings: [],\r\n        };\r\n    }\r\n\r\n    /** @internal */\r\n    public contextLost(): void {\r\n        this._updateEffect = undefined as any;\r\n        this._renderVAO.length = 0;\r\n        this._updateVAO.length = 0;\r\n    }\r\n\r\n    /** @internal */\r\n    public isUpdateBufferCreated(): boolean {\r\n        return !!this._updateEffect;\r\n    }\r\n\r\n    /** @internal */\r\n    public isUpdateBufferReady(): boolean {\r\n        return this._updateEffect?.isReady() ?? false;\r\n    }\r\n\r\n    /** @internal */\r\n    public createUpdateBuffer(defines: string): UniformBufferEffectCommonAccessor {\r\n        this._updateEffectOptions.transformFeedbackVaryings = [\"outPosition\"];\r\n        this._updateEffectOptions.transformFeedbackVaryings.push(\"outAge\");\r\n        this._updateEffectOptions.transformFeedbackVaryings.push(\"outSize\");\r\n        this._updateEffectOptions.transformFeedbackVaryings.push(\"outLife\");\r\n        this._updateEffectOptions.transformFeedbackVaryings.push(\"outSeed\");\r\n        this._updateEffectOptions.transformFeedbackVaryings.push(\"outDirection\");\r\n\r\n        if (this._parent.particleEmitterType instanceof CustomParticleEmitter) {\r\n            this._updateEffectOptions.transformFeedbackVaryings.push(\"outInitialPosition\");\r\n        }\r\n\r\n        if (!this._parent._colorGradientsTexture) {\r\n            this._updateEffectOptions.transformFeedbackVaryings.push(\"outColor\");\r\n        }\r\n\r\n        if (!this._parent._isBillboardBased) {\r\n            this._updateEffectOptions.transformFeedbackVaryings.push(\"outInitialDirection\");\r\n        }\r\n\r\n        if (this._parent.noiseTexture) {\r\n            this._updateEffectOptions.transformFeedbackVaryings.push(\"outNoiseCoordinates1\");\r\n            this._updateEffectOptions.transformFeedbackVaryings.push(\"outNoiseCoordinates2\");\r\n        }\r\n\r\n        this._updateEffectOptions.transformFeedbackVaryings.push(\"outAngle\");\r\n\r\n        if (this._parent.isAnimationSheetEnabled) {\r\n            this._updateEffectOptions.transformFeedbackVaryings.push(\"outCellIndex\");\r\n            if (this._parent.spriteRandomStartCell) {\r\n                this._updateEffectOptions.transformFeedbackVaryings.push(\"outCellStartOffset\");\r\n            }\r\n        }\r\n\r\n        this._updateEffectOptions.defines = defines;\r\n        this._updateEffect = this._engine.createEffect(\"gpuUpdateParticles\", this._updateEffectOptions, this._engine);\r\n\r\n        return new UniformBufferEffectCommonAccessor(this._updateEffect);\r\n    }\r\n\r\n    /** @internal */\r\n    public createVertexBuffers(updateBuffer: Buffer, renderVertexBuffers: { [key: string]: VertexBuffer }): void {\r\n        this._updateVAO.push(this._createUpdateVAO(updateBuffer));\r\n\r\n        this._renderVAO.push(this._engine.recordVertexArrayObject(renderVertexBuffers, null, this._parent._getWrapper(this._parent.blendMode).effect!));\r\n        this._engine.bindArrayBuffer(null);\r\n\r\n        this._renderVertexBuffers = renderVertexBuffers;\r\n    }\r\n\r\n    /** @internal */\r\n    public createParticleBuffer(data: number[]): DataArray | DataBuffer {\r\n        return data;\r\n    }\r\n\r\n    /** @internal */\r\n    public bindDrawBuffers(index: number, effect: Effect, indexBuffer: Nullable<DataBuffer>): void {\r\n        if (indexBuffer) {\r\n            this._engine.bindBuffers(this._renderVertexBuffers, indexBuffer, effect);\r\n        } else {\r\n            this._engine.bindVertexArrayObject(this._renderVAO[index], null);\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    public preUpdateParticleBuffer(): void {\r\n        const engine = this._engine as Engine;\r\n\r\n        this._engine.enableEffect(this._updateEffect);\r\n\r\n        if (!engine.setState) {\r\n            throw new Error(\"GPU particles cannot work without a full Engine. ThinEngine is not supported\");\r\n        }\r\n    }\r\n\r\n    /** @internal */\r\n    public updateParticleBuffer(index: number, targetBuffer: Buffer, currentActiveCount: number): void {\r\n        this._updateEffect.setTexture(\"randomSampler\", this._parent._randomTexture);\r\n        this._updateEffect.setTexture(\"randomSampler2\", this._parent._randomTexture2);\r\n\r\n        if (this._parent._flowMap) {\r\n            this._updateEffect.setTexture(\"flowMapSampler\", this._parent._flowMap);\r\n        }\r\n\r\n        if (this._parent._sizeGradientsTexture) {\r\n            this._updateEffect.setTexture(\"sizeGradientSampler\", this._parent._sizeGradientsTexture);\r\n        }\r\n\r\n        if (this._parent._angularSpeedGradientsTexture) {\r\n            this._updateEffect.setTexture(\"angularSpeedGradientSampler\", this._parent._angularSpeedGradientsTexture);\r\n        }\r\n\r\n        if (this._parent._velocityGradientsTexture) {\r\n            this._updateEffect.setTexture(\"velocityGradientSampler\", this._parent._velocityGradientsTexture);\r\n        }\r\n\r\n        if (this._parent._limitVelocityGradientsTexture) {\r\n            this._updateEffect.setTexture(\"limitVelocityGradientSampler\", this._parent._limitVelocityGradientsTexture);\r\n        }\r\n\r\n        if (this._parent._dragGradientsTexture) {\r\n            this._updateEffect.setTexture(\"dragGradientSampler\", this._parent._dragGradientsTexture);\r\n        }\r\n\r\n        if (this._parent.noiseTexture) {\r\n            this._updateEffect.setTexture(\"noiseSampler\", this._parent.noiseTexture);\r\n        }\r\n\r\n        // Bind source VAO\r\n        this._engine.bindVertexArrayObject(this._updateVAO[index], null);\r\n\r\n        // Update\r\n        const engine = this._engine as Engine;\r\n\r\n        engine.bindTransformFeedbackBuffer(targetBuffer.getBuffer());\r\n        engine.setRasterizerState(false);\r\n        engine.beginTransformFeedback(true);\r\n        engine.drawArraysType(Constants.MATERIAL_PointListDrawMode, 0, currentActiveCount);\r\n        engine.endTransformFeedback();\r\n        engine.setRasterizerState(true);\r\n        engine.bindTransformFeedbackBuffer(null);\r\n    }\r\n\r\n    /** @internal */\r\n    public releaseBuffers(): void {}\r\n\r\n    /** @internal */\r\n    public releaseVertexBuffers(): void {\r\n        for (let index = 0; index < this._updateVAO.length; index++) {\r\n            this._engine.releaseVertexArrayObject(this._updateVAO[index]);\r\n        }\r\n        this._updateVAO.length = 0;\r\n\r\n        for (let index = 0; index < this._renderVAO.length; index++) {\r\n            this._engine.releaseVertexArrayObject(this._renderVAO[index]);\r\n        }\r\n        this._renderVAO.length = 0;\r\n    }\r\n\r\n    private _createUpdateVAO(source: Buffer): WebGLVertexArrayObject {\r\n        const updateVertexBuffers: { [key: string]: VertexBuffer } = {};\r\n        updateVertexBuffers[\"position\"] = source.createVertexBuffer(\"position\", 0, 3);\r\n\r\n        let offset = 3;\r\n        updateVertexBuffers[\"age\"] = source.createVertexBuffer(\"age\", offset, 1);\r\n        offset += 1;\r\n        updateVertexBuffers[\"size\"] = source.createVertexBuffer(\"size\", offset, 3);\r\n        offset += 3;\r\n        updateVertexBuffers[\"life\"] = source.createVertexBuffer(\"life\", offset, 1);\r\n        offset += 1;\r\n        updateVertexBuffers[\"seed\"] = source.createVertexBuffer(\"seed\", offset, 4);\r\n        offset += 4;\r\n        updateVertexBuffers[\"direction\"] = source.createVertexBuffer(\"direction\", offset, 3);\r\n        offset += 3;\r\n\r\n        if (this._parent.particleEmitterType instanceof CustomParticleEmitter) {\r\n            updateVertexBuffers[\"initialPosition\"] = source.createVertexBuffer(\"initialPosition\", offset, 3);\r\n            offset += 3;\r\n        }\r\n\r\n        if (!this._parent._colorGradientsTexture) {\r\n            updateVertexBuffers[\"color\"] = source.createVertexBuffer(\"color\", offset, 4);\r\n            offset += 4;\r\n        }\r\n\r\n        if (!this._parent._isBillboardBased) {\r\n            updateVertexBuffers[\"initialDirection\"] = source.createVertexBuffer(\"initialDirection\", offset, 3);\r\n            offset += 3;\r\n        }\r\n\r\n        if (this._parent.noiseTexture) {\r\n            updateVertexBuffers[\"noiseCoordinates1\"] = source.createVertexBuffer(\"noiseCoordinates1\", offset, 3);\r\n            offset += 3;\r\n            updateVertexBuffers[\"noiseCoordinates2\"] = source.createVertexBuffer(\"noiseCoordinates2\", offset, 3);\r\n            offset += 3;\r\n        }\r\n\r\n        if (this._parent._angularSpeedGradientsTexture) {\r\n            updateVertexBuffers[\"angle\"] = source.createVertexBuffer(\"angle\", offset, 1);\r\n            offset += 1;\r\n        } else {\r\n            updateVertexBuffers[\"angle\"] = source.createVertexBuffer(\"angle\", offset, 2);\r\n            offset += 2;\r\n        }\r\n\r\n        if (this._parent._isAnimationSheetEnabled) {\r\n            updateVertexBuffers[\"cellIndex\"] = source.createVertexBuffer(\"cellIndex\", offset, 1);\r\n            offset += 1;\r\n            if (this._parent.spriteRandomStartCell) {\r\n                updateVertexBuffers[\"cellStartOffset\"] = source.createVertexBuffer(\"cellStartOffset\", offset, 1);\r\n                offset += 1;\r\n            }\r\n        }\r\n\r\n        const vao = this._engine.recordVertexArrayObject(updateVertexBuffers, null, this._updateEffect);\r\n        this._engine.bindArrayBuffer(null);\r\n\r\n        return vao;\r\n    }\r\n}\r\n\r\nRegisterClass(\"BABYLON.WebGL2ParticleSystem\", WebGL2ParticleSystem);\r\n"],
  "mappings": "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",
  "names": ["e", "name", "name", "Xbox360Button", "Xbox360Dpad", "DualShockButton", "DualShockDpad", "name", "NodeRenderGraphBlockConnectionPointTypes", "NodeRenderGraphConnectionPointCompatibilityStates", "NodeRenderGraphConnectionPointDirection", "name", "name", "name", "name", "name", "name", "name", "name", "name", "name", "name", "source", "name", "name", "shader"]
}
